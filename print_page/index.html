
<!doctype html>
<html lang="ca" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.6">
    
    
      
        <title>Print Site - DWES</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.802231af.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      


    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#" class="md-skip">
          Salta el contingut
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="DWES" class="md-header__button md-logo" aria-label="DWES" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DWES
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Cerca" placeholder="Cerca" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DWES" class="md-nav__button md-logo" aria-label="DWES" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    DWES
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Inici
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../01-intro/" class="md-nav__link">
        1.- Introducció a la programació Web
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../02-phpbasics/" class="md-nav__link">
        2.- El llenguatge PHP
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        3.- PHP Orientat a Objectes
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="3.- PHP Orientat a Objectes" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          3.- PHP Orientat a Objectes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../03-phpoo/0301-phpoo-basic/" class="md-nav__link">
        PHP OO Bàsic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../03-phpoo/0399-activities/" class="md-nav__link">
        Activitats
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><h1 id="index-desenvolupament-web-en-entorn-servidor">Desenvolupament Web en Entorn Servidor</h1></section><section class="print-page" id="01-intro"><h1 id="01-intro-introduccio-a-la-programacio-web">Introducció a la programació web</h1>
<div class="admonition important">
<p class="admonition-title">Objectius</p>
<ul>
<li>Seleccionar les arquitectures i tecnologies de programació web en
entorn servidor, analitzant-ne les capacitats i característiques
pròpies.</li>
<li>Introduir els principals llenguatges i frameworks per al
desenvolupament en l'entorn servidor.</li>
<li>Caracteritzar i diferenciar els models d'execució de codi en el
servidor i en el client web.</li>
<li>Identificar les principals tecnologies associades.</li>
<li>Instal·lar i configurar l'entorn de treball que emprarem per al
desenvolupament web.</li>
<li>Visualitzar mitjançant el navegador una pàgina web html amb codi PHP
encastat.</li>
</ul>
</div>
<h2 id="01-intro-arquitectura-duna-aplicacio-web">Arquitectura d'una aplicació web</h2>
<p>A diferència de les aplicacions d'escriptori, que utilitzen els recursos d'un únic ordinador
les aplicacions web són distribuïdes,  intervenen com a mínin dos equipos diferents: el client i el servidor.</p>
<p>La comunicació és du a terme mitjançant un protocol, en el nostre cas el protocol HTTP, base 
de la WWW.</p>
<h3 id="01-intro-elements-navegador-servidor-protocol-http-i-html">Elements: navegador, servidor, protocol HTTP i HTML</h3>
<p>El protocol de transferència d'hipertext (HTTP) és un protocol
client-servidor molt senzill que articula els intercanvis d'informació
entre els clients web (navegadors) i els servidors HTTP.</p>
<p><strong>HTTP es basa en operacions senzilles de sol·licitud/resposta.</strong> Quan
un client estableix una connexió amb un servidor i envia un missatge amb
les dades de la sol·licitud, el servidor respon amb un missatge similar
que conté l'estat de l'operació i el seu resultat de la sol·licitud.
Totes les operacions poden adjuntar un objecte o recurs sobre el qual
actuen; cada objecte web (document HTML, arxiu multimèdia o aplicació
CGI) és conegut pel seu localitzador uniforme de recursos (URL, <em>Uniform
Resource Locator</em>). Els recursos poden ser arxius, el resultat de
l'execució d'un programa, una consulta a una base de dades, la
traducció automàtica d'un document, etc.</p>
<p><strong>HTTP és un protocol sense estat</strong>, és a dir, no guarda cap informació
sobre connexions anteriors. El desenvolupament d'aplicacions web
freqüentment necessita mantenir estat. Per això s'utilitzen les galetes
(<em>cookies</em>), és a dir, la informació que un servidor pot emmagatzemar en
el sistema client. Això permet que les aplicacions web institueixin la
noció de "sessió", i, alhora, permet rastrejar usuaris, ja que les
galetes es poden emmagatzemar en el client durant un temps indeterminat.</p>
<p>Amb la intenció de conèixer amb més profunditat el protocol HTTP podem
avaluar en què consisteix una transacció HTTP.</p>
<p>Cada vegada que un client fa una petició a un servidor, s'executen un
seguit d'accions:</p>
<ol>
<li>Un usuari accedeix a una adreça d'Internet (URL) seleccionant un
    enllaç d'un document HTML o introduint-la directament a la barra de
    navegació d'un navegador web des de la perspectiva del client web.
    El client web descodifica l'adreça d'Internet (URL) separant-ne les
    diferents parts. És així com s'identifiquen el protocol d'accés,
    el node expressat amb el nom de domini o la seua adreça IP, el
    possible port opcional (el valor per defecte és el 80) i l'objecte
    del servidor requerit.</li>
<li>S'obre una connexió TCP/IP amb el servidor cridant el port TCP
    corresponent. Es fa la petició. En conseqüència, s'envien l'ordre
    necessària (GET, POST, HEAD, etc.), l'adreça de l'objecte requerit
    (el contingut de l'adreça d'Internet del servidor), la versió del
    protocol HTTP utilitzada (en la major part de les ocasions és
    HTTP/1.0) i un conjunt variable d'informació que inclou dades sobre
    les capacitats del navegador web, dades opcionals per al servidor,
    etc.</li>
<li>El servidor localitza el recurs sol·licitat i torna la resposta al
    client.</li>
<li>Aquesta resposta consisteix en un codi d'estat i el tipus de dada
    amb extensions multipropòsit de correu d'Internet (MIME,
    Multipurpose Internet Mail Extension) de la informació de tornada,
    seguit de la mateixa informació.</li>
<li>El client formata i mostra el recurs rebut.</li>
<li>Es tanca la connexió TCP.</li>
</ol>
<p>Aquest procés es repeteix en cada accés que es faça al servidor HTTP.
Per exemple, si es recull un document HTML que conté quatre imatges, el
procés de transició mostrat amb anterioritat es repeteix cinc vegades,
és a dir, una pel document HTML i quatre per les imatges.</p>
<p><img alt="Etapes d'una transacció
HTTP" src="../assets/HTTP_Steps.png" title="Etapes d'una transacció HTTP" /></p>
<p>Si el recurs sol·licitat és un programa (CGI, ASP.NET, PHP, etc.) el
servidor HTTP redirigirà la petició a la llibreria o intèrpret adequat
que executarà el programa i tornarà el control al servidor web.</p>
<h4 id="01-intro-format-de-les-url">Format de les URL</h4>
<p>La sintaxi general de les URL consisteix en una seqüència jeràrquica de
5 components:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>URI = scheme:[//authority]path[?query][#fragment]
</code></pre></div>
<p>on el component authoriry es deivideix en tres subcomponents:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>authority = [userinfo@]host[:port]
</code></pre></div>
<p><img alt="URL
Syntax" src="../assets/1068px-URI_syntax_diagram.svg.png" title="Sintaxi de les URL" /></p>
<h3 id="01-intro-el-model-clientservidor">El model client/servidor</h3>
<p>El model client-servidor és aquell on tots els clients estan connectats
a un servidor on es centralitzen els diferents recursos. Aquests
recursos estan a disposició dels clients cada cop que els sol·liciten.
Això fa que totes les gestions que es realitzen es concentren en el
servidor, que disposa dels requeriments dels clients amb prioritat, els
arxius que són d'ús públic i els restringits, els arxius de només
lectura, els que poden ser modificats, etc.</p>
<p>En el model client/servidor, el dispositiu que sol·licita informació es
denomina client i el dispositiu que respon la sol·licitud es denomina
servidor. Els processos de client i servidor es consideren una part de
la capa d'aplicació. El client comença l'intercanvi sol·licitant les
dades al servidor, que respon enviant un o més blocs de dades al client.
Els protocols de capa d'aplicació descriuen el format de les
sol·licituds i respostes entre clients i servidor. A més de la
transferència real de dades, aquest intercanvi pot requerir informació
addicional, com l'autentificació de l'usuari i la identificació d'un
arxiu de dades per transferir.</p>
<p>Encara que les dades generalment es descriuen com un flux del servidor
al client, algunes dades sempre flueixen del client al servidor. El flux
de dades pot ser el mateix en les dues direccions o fins i tot ser major
en la direcció que va del client al servidor. Per exemple, un client pot
transferir un arxiu al servidor amb finalitats d'emmagatzemament. La
transferència de dades d'un client a un servidor es coneix com a pujada
i la de les dades d'un servidor a un client, baixada.</p>
<h2 id="01-intro-pagines-web-estatiques-i-dinamiques">Pàgines web estàtiques i dinàmiques</h2>
<h3 id="01-intro-pagines-web-estatiques">Pàgines web estàtiques</h3>
<p>Les pàgines web estàtiques són aquelles on el seu contingut no varia per
la qual cosa mostraran la mateixa informació cada vegada que es
carreguen. Són les pàgines creades en el llenguatge HTML.</p>
<p>Només canvien si el programador web les modifica.</p>
<h3 id="01-intro-pagines-web-dinamiques">Pàgines web dinàmiques</h3>
<p>Les pàgines web dinàmiques són pàgines el contingut de les quals varia a
partir d'informació continguda en una BBDD.</p>
<p>El contingut mostrat pot canviar segons l'usuari connectat, el
navegador que s'utiltze o accions anteriors dels usuaris, etc.</p>
<p>Aquest tipus de pàgines s'han de realitzar mitjançat un llenguatge de
programació.</p>
<h3 id="01-intro-execucio-de-codi-en-el-client-i-en-el-servidor">Execució de codi en el client i en el servidor</h3>
<p>En el següent gràfic es mostra un escenari on podem trobar codi que
s'executa en el servidor (PHP) i en el client (javascript).</p>
<p><img alt="" src="../assets/figure_2_client_side_scripting.png" /># 2. Tecnologies per a programació web del costat del servidor </p>
<h3 id="01-intro-model-de-desenvolupament-en-3-capes">Model de desenvolupament en 3 capes.</h3>
<p>Des d'un punt de vista de desenvolupament una aproximació més detallada
al model client-servidor és el que es coneix com a <strong>model en 3 capes</strong>.
És un model on es mostra més en detall com es distribueix el programari
que participa en qualsevol desenvolupament web. Segueix estant present
l'arquitectura client-servidor (tot es basa en ella) però apareixen més
detalls com el programari utilitzat en cada un dels dos actors i com
interactuen les diferents tecnologies o aplicacions.</p>
<p>Per comprendre millor que és el model de desenvolupament de 3 capes
podem tirar un ull al següent esquema on es mostra cadascuna d'aquestes
capes i que s'encarrega cadascuna d'elles:</p>
<p><img alt="**Model de desenvolupament de 3
capes**" src="../assets/3_capas.png" title="Model de desenvolupament de 3 capes" /></p>
<ul>
<li><strong>Capa de presentació:</strong> És la capa on l'aplicació es mostra a
    l'usuari. Bàsicament és la GUI (<em>Graphical User Interface,
    interfície gràfica d'usuari</em>). En el cas d'una aplicació web seria
    el codi HTML que es carrega directament al navegador web. En
    qualsevol cas, s'executa directament en l'equip del client.</li>
<li><strong>Capa de negoci:</strong> És la capa intermèdia on es porta a terme tota
    la lògica de l'aplicació. Sempre s'executarà en el costat
    servidor. Aquesta capa, després de realitzar tots els càlculs i / o
    operacions sobre les dades, genera el codi HTML que serà presentat a
    l'usuari en la capa següent.</li>
<li><strong>Capa de dades:</strong> És la capa que emmagatzema les dades. Bàsicament,
    en condicions normals, fa referència al propi SGBD que és
    l'encarregat d'emmagatzemar les dades. Depenent de l'arquitectura
    de l'aplicació, aquesta capa i la de negoci es poden trobar
    físicament en el mateix equip, encara que també és possible que
    s'hagin de separar per qüestions de rendiment. La capa de dades
    serveix totes la informació necessària a la capa de negoci per dur a
    terme les seves operacions.</li>
</ul>
<p>Si ens imaginem una botiga online, la capa de dades emmagatzema tota la
informació en una base de dades (usuaris, comandes, articles,
ofertes,...), La capa de negoci ha d'accedir a aquesta informació i,
després processar una comanda, per exemple, ha de presentar el resultat
final a l'usuari en el navegador, que és la capa de presentació.</p>
<p>I si ens centrem en un cas concret amb programari i tecnologies ja
definits, un model de 3 capes podria ser el següent:</p>
<p><img alt="**Modelo de desarrollo de 3 capas (desarrollo web con
PHP)**" src="../assets/3_capas2.jpg" title=": Modelo de desarrollo de 3 capas (desarrollo web con PHP)" /></p>
<ul>
<li>Navegador web: En aquest cas, Mozilla Firefox, Internet Explorer o
    Google Chrome podrien ser qualsevol de les aplicacions que ocuparien
    aquesta capa</li>
<li>Apache + PHP / IIS + ASP: Un servidor web acompanyat del seu
    corresponent llenguatge de programació web permeten desenvolupar la
    part que ocupa la capa de negoci. També podríem col·locar la
    combinació Apache Tomcat + Servlets</li>
<li>MySQL / PostgreSQL: Finalment a la capa de dades podem posar
    qualsevol SGBD, com poden ser MySQL o PostgreSQL.</li>
</ul>
<p>L'avantatge principal d'aquest model és que el desenvolupament es pot
dur a terme en diversos nivells i, en cas que sobrevinga algun canvi,
només afectarà el nivell requerit sense haver de revisar entre el codi
font d'altres mòduls, atès que s'haurà reduït el acoblament informàtic
fins a una interfície de pas de missatges.
:::</p>
<h3 id="01-intro-front-end-back-end-full-stack">Front-end, Back-end, Full stack</h3>
<p>També tenint en compte en quin costat se situen les tecnologies i per a
què s'utilitzen aquestes, actualment es parla molt de 3 perfils
diferenciats en l'àmbit del desenvolupament web:</p>
<ul>
<li><strong>Front-end:</strong> És la part del desenvolupament que s'encarrega del
    disseny i maquetació de l'aplicació web utilitzant tecnologies com
    HTML, CSS i Javascript (i els seus frameworks). En aquest cas s'ha
    de preocupar també de la correcta presentació en qualsevol tipus de
    dispositiu i fins i tot del posicionament en cercadors</li>
<li><strong>Back-end:</strong> És la part del desenvolupament que s'encarrega del
    costat servidor utilitzant tecnologies com PHP, JSP i Python. També
    s'encarrega de l'administració del servidor d'aplicacions i la
    base de dades.</li>
<li><strong>Full stack:</strong> En un perfil que engloba els dos anteriors. En
    aquest cas el desenvolupador potser no és un expert de cap
    tecnologia concreta però té amplis coneixements de tot el conjunt i
    és capaç de col·laborar en qualsevol de les parts.</li>
</ul>
<p><img alt="" src="../assets/fullstack.jpg" /></p>
<h2 id="01-intro-servidors-web-i-servidors-daplicacions">Servidors web i servidors d'aplicacions</h2>
<p>Així com les aplicacions d'escriptori s'executen directament sobre el
sistema operatiu, les aplicacions web necessiten d'una
eina addicional que permeti desplegar-les per a la seva posada en marxa.
Parlem de <a href="https://en.wikipedia.org/wiki/Comparison_of_web_server_software">servidors
web</a> i
<a href="https://en.wikipedia.org/wiki/Application_server">servidors
d'aplicacions</a>,
respectivament.</p>
<h3 id="01-intro-que-es-un-servidor-web">Què és un servidor web?</h3>
<p>Un servidor web és una aplicació que rep una petició HTTP (normalment a
través d'un navegador web) i retorna la pàgina web sol·licitada
(escrita en llenguatge HTML i podent contenir codi Javascript
encastat) perquè aquesta sigua interpretada i visualitzada pel
navegador de qui va realitzar la sol·licitud (l'usuari).</p>
<h3 id="01-intro-que-es-un-servidor-daplicacions">Què és un servidor d'aplicacions?</h3>
<p>Un servidor d'aplicacions és un servidor que permet l'execució d'aplicacions web.</p>
<h3 id="01-intro-exemples">Exemples</h3>
<h4 id="01-intro-apache">Apache</h4>
<p>Apache és un dels servidors web més coneguts. És programari lliure i
multiplataforma, encara que aproximadament el 90% dels servidors Apache
s'executen actualment en entorns Linux ja que és el servidor preferit
per a aquesta plataforma.</p>
<p>És molt modular el que permet incorporar característiques un cop
instal·lat i posat en marxa. Això li fa també molt flexible i pot donar
servei a webs escrites en els llenguatges de programació web més estesos
(com PHP, Python, ASP,...) A través del mòdul corresponent.</p>
<h4 id="01-intro-apache-tomcat">Apache Tomcat</h4>
<p>Apache Tomcat és un servidor d'aplicacions que funciona com a
contenidor de Servlets de Java. Actualment és capaç d'implementar
diverses especificacions de Java EE com Servlets i JSP (Java Server
Pages) i més proporciona un servidor web pur perquè es faça servir en
combinació amb l'entorn Java.</p>
<h4 id="01-intro-wsgi-web-server-gateway-interface">WSGI (<em>Web Server Gateway Interface</em>)</h4>
<p>WSGI és una interfície que defineix com es comunica un servidor web amb
aplicacions web o frameworks escrits en Python.</p>
<h2 id="01-intro-llenguatges">Llenguatges</h2>
<h3 id="01-intro-php">PHP</h3>
<p>PHP (PHP Hypertext Preprocessor) és un llenguatge de programació de
costat servidor dissenyat principalment per al desenvolupament web.</p>
<p>PHP s'utilitza com a llenguatge de script embegut en pàgines HTML i
funciona, normalment, com un mòdul del servidor web (per exemple, a
Apache). El servidor web combina els resultats d'executar els scripts
PHP amb l'HTML al qual va encastat i genera la pàgina web resultant per
al navegador.</p>
<p>Actualment PHP funciona pràcticament amb qualsevol servidor web i en
qualsevol Sistema Operatiu existents, i gairebé amb qualsevol SGBD en
cas que necessitem utilitzar una base de dades. Tot i això, el més
habitual és veure-ho formant el que es coneix com una arquitectura LAMP
(Linux, Apache, MySQL i PHP), és a dir, funcionant sobre un sistema
operatiu Linux, executant-com un mòdul del servidor web Apache i
utilitzant a MySQL com SGBD per emmagatzemar la informació en cas que es
requereixi una base de dades.</p>
<p><img alt="**Arquitectura LAMP Arquitectura LAMP**" src="../assets/lamp.jpg" /></p>
<p>El llenguatge PHP va ser dissenyat per Rasmus Lerdorf i ara es manté per
una comunitat de desenvolupadors, a més és de codi obert.</p>
<p>A continuació, un fragment d'una pàgina web dinàmica escrita amb PHP on
es pot apreciar com s'incrusta el codi juntament amb l'HTML de la
pàgina:</p>
<h3 id="01-intro-jsp-servlets">JSP / Servlets</h3>
<p>JavaServer Pages (també conegut com JSP) és una tecnologia creada per a
la creació de pàgines web dinàmiques del costat servidor. Igual que PHP,
el seu codi s'escriu encastat juntament amb l'HTML de la pàgina web i
és el servidor d'aplicacions, en aquest cas, qui ha de processar-per
generar la pàgina web resultant, en HTML.</p>
<p>D'altra banda, Java Servlets és una tecnologia que també es pot
utilitzar per crear contingut web dinàmic però que a més estén la seva
funcionalitat a la possibilitat de connectar aquestes webs dinàmiques
amb un altre contingut accessible a través d'Internet. De vegades
s'utilitza juntament amb JSP per crear aplicacions web més complexes.</p>
<p>Totes dues són tecnologies desenvolupades per Sun Microsystems i
propietat ara d'Oracle, després d'adquirir aquesta última a la primera
fa ja alguns anys.</p>
<p><img alt="**Arquitectura habitual JSP /
Servlets**" src="assets/jsp.gif" title="Arquitectura habitual JSP / Servlets" /></p>
<h3 id="01-intro-python">Python</h3>
<p>El llenguatge Python va ser dissenyat per Guido van Rossum i ara es
manté gràcies a una comunitat de desenvolupadors, i és codi obert.</p>
<p><img alt="Python" src="../assets/django_apache.png" /></p>
<p>Exemple de codi escrit amb Python. En aquest cas utilitzant el framework
Django per al desenvolupament d'aplicacions web:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="no">Mis</span> <span class="n">películas</span><span class="o">&lt;</span><span class="sr">/h1&gt; &lt;a href=&quot;#&quot;&gt;+&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">lista_peliculas</span> <span class="sx">%}</span>
<span class="linenos" data-linenos=" 3 "></span><span class="sx">  &lt;ul&gt;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="sx">    {% for pelicula in lista_peliculas %}</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;{% url &#39;pelicula&#39; pelicula.id %}&quot;</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">pelicula</span><span class="o">.</span><span class="n">titulo</span> <span class="p">}}</span><span class="o">&lt;</span><span class="sr">/a&gt;&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span>   <span class="sx">%}</span>
<span class="linenos" data-linenos=" 7 "></span><span class="sx">    &lt;/ul&gt;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="sx">    {% else %}</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="no">No</span> <span class="n">hay</span> <span class="n">películas</span> <span class="n">disponibles</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
<span class="linenos" data-linenos="10 "></span><span class="sr">    {% endif %}</span>
</code></pre></div>
<p>Separada del controlador:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>    <span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span>    <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
<span class="linenos" data-linenos="4 "></span>
<span class="linenos" data-linenos="5 "></span>    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos" data-linenos="6 "></span>    <span class="n">lista_peliculas</span> <span class="o">=</span> <span class="n">Pelicula</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="linenos" data-linenos="7 "></span>    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lista_peliculas&#39;</span><span class="p">:</span> <span class="n">lista_peliculas</span><span class="p">}</span>
<span class="linenos" data-linenos="8 "></span>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;mispeliculas/index.html&#39;</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</code></pre></div>
<h3 id="01-intro-aspnet">ASP.NET</h3>
<p>ASP.NET és una tecnologia, creada per Microsoft, per al desenvolupament
de lloc web dinàmics, aplicacions i serveis web. És la tecnologia
successora del que abans es coneixia com ASP, l'antiga tecnologia de
Microsoft per a la creació de pàgines web dinàmiques.</p>
<p>Com que funciona sobre la plataforma .NET de Microsoft, permet que es
pugui desenvolupar en qualsevol dels llenguatges de programació
d'aquesta plataforma, Visual Basic .NET o C#.</p>
<p>El més habitual és veure-ho funcionar juntament amb el lloc web de
Microsoft, IIS (Internet Information Server).</p>
<p><img alt="ASP.NET" src="../assets/asp_iis.png" /></p>
<p>A continuació, un exemple de pàgina web dinàmica amb ASP.NET
(desenvolupada en llenguatge C #) programant l'acció que passa en
prémer un botó (apareix el text d'un formulari a la part final del
web):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>protected void Button1_Click(object sender, EventArgs e)
<span class="linenos" data-linenos="2 "></span>{
<span class="linenos" data-linenos="3 "></span>    string buf = TextBox1.Text;
<span class="linenos" data-linenos="4 "></span>    changed_text.InnerHtml = buf.ToUpper();
<span class="linenos" data-linenos="5 "></span>}
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="err">&lt;</span>%@ Page Language=&quot;C#&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;Default.aspx.cs&quot;
<span class="linenos" data-linenos=" 2 "></span>    Inherits=&quot;firstexample._Default&quot; %&gt;
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="cp">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; </span>
<span class="linenos" data-linenos=" 5 "></span><span class="cp">    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="p">&lt;</span><span class="nt">html</span> <span class="na">xmlns</span><span class="o">=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span> <span class="p">&gt;</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="p">&lt;</span><span class="nt">head</span> <span class="na">runat</span><span class="o">=</span><span class="s">&quot;server&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="10 "></span>        <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="11 "></span>            Untitled Page
<span class="linenos" data-linenos="12 "></span>        <span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="13 "></span>    <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span>    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="16 "></span>        <span class="p">&lt;</span><span class="nt">form</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;form1&quot;</span> <span class="na">runat</span><span class="o">=</span><span class="s">&quot;server&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="17 "></span>        <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="18 "></span>            <span class="p">&lt;</span><span class="nt">asp:TextBox</span> <span class="na">ID</span><span class="o">=</span><span class="s">&quot;TextBox1&quot;</span> <span class="na">runat</span><span class="o">=</span><span class="s">&quot;server&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width:224px&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="19 "></span>            <span class="p">&lt;/</span><span class="nt">asp:TextBox</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="20 "></span>
<span class="linenos" data-linenos="21 "></span>            <span class="p">&lt;</span><span class="nt">asp:Button</span> <span class="na">ID</span><span class="o">=</span><span class="s">&quot;Button1&quot;</span> <span class="na">runat</span><span class="o">=</span><span class="s">&quot;server&quot;</span> <span class="na">Text</span><span class="o">=</span><span class="s">&quot;Enter...&quot;</span> 
<span class="linenos" data-linenos="22 "></span>                <span class="na">style</span><span class="o">=</span><span class="s">&quot;width:85px&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;Button1_Click&quot;</span> <span class="p">/&gt;</span>
<span class="linenos" data-linenos="23 "></span>            <span class="p">&lt;</span><span class="nt">hr</span> <span class="p">/&gt;</span>
<span class="linenos" data-linenos="24 "></span>
<span class="linenos" data-linenos="25 "></span>            <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span> Results: <span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="26 "></span>            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">runat</span><span class="o">=</span><span class="s">&quot;server&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;changed_text&quot;</span> <span class="p">/&gt;</span>
<span class="linenos" data-linenos="27 "></span>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="28 "></span>
<span class="linenos" data-linenos="29 "></span>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="30 "></span>    <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="31 "></span>    <span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<h2 id="01-intro-preparant-lentorn-de-desenvolupament">Preparant l'entorn de desenvolupament</h2>
<p>Per a poder provar els nostres llocs web necessitarem instal·lar una
sèrie d'eines com són: el servidor web Apache, el mòdul PHP per a
aquest servidor, el SGBD MySql, un front-end per al SGBD (PHPMyAdmin),
etc.</p>
<p>Per simplificar les coses optarem per instal·lar-ho mitjançant XAMPP, un
paquet de programari lliure que conté el servidor HTTP Apache, la base
de dades de MySQL i eines necessàries per utilitzar el PHP i el
llenguatge de programació Perl.</p>
<div class="admonition todo">
<p class="admonition-title">Pràctica 1: Instal·lació de XAMPP</p>
<ol>
<li>Descarreguem el paquet XAMPP per a la nostra màquina
(https://www.apachefriends.org/).    </li>
<li>Li donem permisos d'execució a l'arxiu descarregat:
<code>sudo chmod +x xampp-linux-x64-7.3.9-0-installer.run</code></li>
<li>Executem l'assistent d'instal·lació
<code>sudo ./xampp-linux-x64-7.3.9-0-installer.run</code></li>
<li>En l'assistent d'instal·lació, deixarem les opcions per defecte
(excepte la qual ens parla de bitnami que la desmarcarem).</li>
<li>Una vegada finalitzada la instal·lació, el nostre XAMPP es trobarà
en el directori <code>/opt/lampp</code></li>
<li>Ara ja podem arrancar els serveis amb el següent comando:
<code>sudo /opt/lampp/lampp start</code></li>
<li>Quan els arranquem, si obrim el navegador i ens anem a la url
http://localhost, ens hauria d'aparèixer la pàgina de benvinguda de
XAMPP.</li>
<li>Per a parar els serveis podem fer açò:
<code>sudo /opt/lampp/xampp stop</code></li>
<li>En qualsevol cas, és molt més còmode treballar amb el panell de
control de XAMPP que podrem executar amb la següent ordre:
<code>sudo /opt/lampp/manager-linux-x64.run</code></li>
<li>Veurem que s'inicia l'aplicació que ens permet controlar els
serveis de XAMPP.</li>
</ol>
</div>
<p><img alt="[*Panell de control de
XAMPP*]{.title}" src="../assets/Captura_de_pantalla_a_2019-09-13_21-03-02.png" title="Panell de control de XAMPP" /></p>
<h2 id="01-intro-eines-de-desevolupament">Eines de desevolupament</h2>
<p>Per a programar en llenguatges encastats com PHP, ASP o Phython és
suficient amb un editor de text pla. No obstant sempre és recomanable
treballar en un entorn integrat de desenvolupament o IDE (acrònim en
anglès de <em>Integrated development environment</em>). Un IDE és una eina
informàtica per al desenvolupament de programari de manera còmoda i
ràpida. Així doncs és un entorn de desenvolupament que agrupa diferents
funcions en un sol programa, habitualment: editor de codi, compilador,
depurador i un programa de disseny d'interfície gràfica.</p>
<p>El principal avantatge és que facilita la tasca del programador mentre
que l'inconvenient més important és que pot provocar mals hàbits a
l'hora de programar o provocar errors que a priori començant de zero no
es produirien.</p>
<p>Alguns dels IDE més emprats per al desenvolupament web són:</p>
<ul>
<li>Eclipse</li>
<li>Netbeans</li>
<li>Atom</li>
<li>Sublime</li>
<li>PHPStorm</li>
<li>Brackets</li>
</ul>
<p>Durant les activitats anteriors has preparat el teu propi entorn de
desenvolupament sobre una màquina virtual (o una real) tal com s'ha
explicat en les anotacions. Després, has de crear un projecte php
utilitzant PHPStorm i visualitzar la pàgina principal a través del teu
servidor XAMPP.</p>
<p>Al llarg del curs, crearem els nostres projectes utilitzant l'IDE PHPStorm.</p>
<p>Aquesta eina és de pagament, però podem utilitzar-la de forma gratuïta per a projectes OpenSource i amb finalitats educatives. En aqueixos
casos caldrà sol·licitar la llicència corresponent al fabricant del programari. Una vegada obtinguda la llicència educativa pel professor,
serà renovable anualment i podran utilitzar-la tots els alumnes del curs. És una eina molt completa que ens permetrà la integració amb
moltes de les funcionalitats que emprarem. </p>
<h3 id="01-intro-installar-phpstorm">Instal·lar PHPStorm</h3>
<p>Per a instal·lar l'IDE PHPStorm seguirem els següents passos:</p>
<ol>
<li>Executarem
    sudo snap install phpstorm --classic</li>
<li>Ens demanarà si volem importar dades d'una instal·lació anterior,
    al que contestarem, òbviament, que no.</li>
<li>Ens demanarà que acceptem la política de privadesa.</li>
<li>En executar l'aplicació per primera vegada ens demanarà les dades
    de llicència. Cada alumne s'haurà de registrar utilitzant l'enllaç
    que us passarà el professor en classe. en prémer l'enllaç ens
    redirigirà a la pàgina web de jetbrains perquè ens registrem. Una
    vegada registrats, podrem accedir a l'aplicació amb el nostre
    compte o amb el codi d'activació que ens proporcionen.</li>
<li>Finalment, indicarem la configuració inicial.</li>
</ol>
<h4 id="01-intro-integrant-lexecutable-de-php">Integrant l'executable de PHP</h4>
<p>PHPStorm disposa d'ajuda intel·ligent (IntelliJ IDEA). Perquè aquesta
ajuda es corresponga amb la versió de php que tenim en el nostre XAMPP
haurem de registrar l'executable de PHP de XAMPP en el nostre PHPStorm.</p>
<p>Per a açò seguirem els següents passos:</p>
<ol>
<li>En la pantalla d'inici anem a <code>Configure – Settings</code>.</li>
<li>En la llista de categories de l'esquerra anem a
    <code>Language &amp; Frameworks - PHP</code>.</li>
<li>Necessitem indicar quin és el nostre intèrpret. ja que la llista
    està buida anem a configurar un de la següent forma:<ol>
<li>Fem clic en el botó ... de la llista d'intèrprets</li>
<li>Premem el botó + de la cantonada superior esquerra per a
    afegir-ne un.</li>
<li>Li posem el nom PHP de XAMPP.</li>
<li>Indiquem instal·lat on nostre està XAMPP: <code>/opt/lampp/bin/php</code></li>
<li>Immediatament ens indicarà la versió de l'intèrpret que tenim
    instal·lat</li>
<li>Premem OK i seleccionem el nou interprete en la llista
    d'intèrprets.</li>
<li>Finalment, seleccionem en l'opció PHP <em>language level</em> aquell
    que es corresponga amb l'intèrpret que acabem de configurar.</li>
<li>Ara el nostre PHPStorm farà ús del PHP de XAMPP i utilitzarà la
    versió de PHP que tenim instal·lada quan ens oferisca les
    ajudes.</li>
<li>Primer projecte amb PHPStorm Per a començar a treballar amb
    PHPStorm anem a crear el nostre primer projecte PHP buit.
    Tingueu en compte que el projecte heu de crear-ho en el
    directori <code>/opt/lampp/htdocs</code> i que necessitem tenir permisos
    d'escriptura en aquest directori.</li>
</ol>
</li>
</ol>
<p><strong>Compte!</strong> Pot ser que ho hàgem instal·lat com <code>root</code>, mentre que quan
executem PHPStorm ho fem amb l'usuari <code>dwes</code>, per tant, l'usuari
<code>dwes</code> necessita poder escriure en aquest directori.</p>
<p>Per a assegurar-nos que tenim permisos, anirem amb una finestra de
terminal al directori <code>/opt/lampp</code> i executarem la següent ordre:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>ls –la htdocs
</code></pre></div>
<p>Aquesta ordre ens dirà qui és el propietari de la carpeta i quins
permisos té.</p>
<p>En el cas que el propietari siga root executarem la seguent ordre:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>sudo chown -hR dwes htdocs/
</code></pre></div>
<p>Açò canviarà el propietari a l'usuari <code>dwes</code>, amb el que tindrem permís
d'escriptura en aquest directori des de PHPStorm.</p>
<p>Treballarem tenint els projectes en la mateixa carpeta.</p>
<div class="admonition todo">
<p class="admonition-title">Pràctica 2. Instal·lació de PHPStorm</p>
<p>Seguint les instruccions anteriors instal·la i configura PHP Storm.</p>
</div>
<h3 id="01-intro-creacio-de-projectes-i-comprovacio-de-la-installacio-de-php">Creació de projectes i comprovació de la instal·lació de PHP</h3>
<p>Seguirem els passos que s'indiquen a continuació:</p>
<ol>
<li>Arrancar XAMPP</li>
<li>Iniciar el mòdul Apache</li>
<li>Executar PHPStorm</li>
<li>Crear un projecte buit amb <code>Create New &gt; Project PHP Empty Project</code></li>
<li>Posar al projecte el nom <code>practica1</code> i situar-lo en el directori
    <code>/opt/lampp/htdocs</code> . Amb açò es crea un directori de nom <code>practica1</code> dintre de <code>/opt/lampp/htdocs</code>.</li>
</ol>
<p><img alt="" src="../assets/projecte.png" /></p>
<ol>
<li>
<p>En la finestra de l'esquerra (explorador de projectes) apareix el projecte creat. Dins d'ell crearem un nou fitxer PHP prement botó dret
      sobre el nom i seleccionant <code>New &gt; PHP File</code> . Li posem de nom <code>index.php</code> .</p>
</li>
<li>
<p>En el fitxer creat introduïm les següents línies de codi:
    <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>   <span class="o">&lt;!</span><span class="nx">doctype</span> <span class="nx">html</span><span class="o">&gt;</span>
<span class="linenos" data-linenos=" 2 "></span>        <span class="o">&lt;</span><span class="nx">html</span> <span class="nx">lang</span><span class="o">=</span><span class="s2">&quot;es&quot;</span><span class="o">&gt;</span>
<span class="linenos" data-linenos=" 3 "></span>            <span class="o">&lt;</span><span class="nx">head</span><span class="o">&gt;</span>
<span class="linenos" data-linenos=" 4 "></span>                <span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">charset</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="o">&gt;</span>
<span class="linenos" data-linenos=" 5 "></span>                <span class="o">&lt;</span><span class="nx">title</span><span class="o">&gt;</span><span class="nx">Desenvolupament</span> <span class="nx">web</span> <span class="nx">en</span> <span class="nx">entorn</span> <span class="nx">servidor</span><span class="o">&lt;/</span><span class="nx">title</span><span class="o">&gt;</span>
<span class="linenos" data-linenos=" 6 "></span>                <span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;description&quot;</span> <span class="nx">content</span><span class="o">=</span><span class="s2">&quot;PHP, PHPStorm&quot;</span><span class="o">&gt;</span>
<span class="linenos" data-linenos=" 7 "></span>                <span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;author&quot;</span> <span class="nx">content</span><span class="o">=</span><span class="s2">&quot;Homer Simpson&quot;</span><span class="o">&gt;</span>
<span class="linenos" data-linenos=" 8 "></span>            <span class="o">&lt;/</span><span class="nx">head</span><span class="o">&gt;</span>
<span class="linenos" data-linenos=" 9 "></span>            <span class="o">&lt;</span><span class="nx">body</span><span class="o">&gt;</span>
<span class="linenos" data-linenos="10 "></span>            <span class="o">&lt;?</span><span class="nx">php</span>
<span class="linenos" data-linenos="11 "></span>                <span class="nb">phpinfo</span><span class="p">();</span>
<span class="linenos" data-linenos="12 "></span>            <span class="cp">?&gt;</span><span class="x"></span>
<span class="linenos" data-linenos="13 "></span><span class="x">        &lt;/body&gt;</span>
<span class="linenos" data-linenos="14 "></span><span class="x">        &lt;/html&gt;</span>
</code></pre></div></p>
<ol>
<li>Canviem l'autor del document al nostre nom.</li>
<li>Obrim el navegador i teclegem en la barra d'adreces la url:
<a href="http://localhost/practica1">http://localhost/practica1</a></li>
<li>Apareixerà una pàgina similar a la de la següent imatge:
<img alt="" src="../assets/phpinfo.png" /></li>
</ol>
</li>
</ol>
<div class="admonition todo">
<p class="admonition-title">Pràctica 3: Prova d'Apache i PHP</p>
<p>L'objectiu d'aquesta pràctica és aprendre el maneig bàsic de l'entorn de desenvolupament PHPStorm creant una primera pàgina PHP que alhora servirà per a comprovar la correcta instal·lació de XAMPP.</p>
<p>Seguint les instruccions anterior crea projecte i prova'l.</p>
</div>
<h2 id="01-intro-eines-per-a-la-depuracio-de-codi">Eines per a la depuració de codi</h2>
<p>En els entorns de desevolupament és necessari disposar de ferramentes que ens
permenten depurar les nostres aplicacions. Ja siga per arreglar errors com per 
millorar l'execució del codi.</p>
<p>Els entorns de desevolupament d'aplicacions d'escriptori solen disposar dels seus 
propis sistemes de depuració, en el cas dels llenguatges d'entorn servidor alguns ecosistemes
  com el de .Net de Microsoft l'inclouen. Per a PHP hi ha diverses ferramentes com  XDebug o DBG.</p>
<h3 id="01-intro-installacio-dxdebug-30">Instal·lació d'XDEBUG 3.0</h3>
<div class="admonition warning">
<p class="admonition-title">XDebug 3.0</p>
<p>Recentment s'ha publicat XDebug 3.0, versió que cobreix aquest document. Si busqueu informació, tingau en compte en quina versió treballeu.</p>
</div>
<p>A continuació, explicarem com instal·lar el mòdul XDebug 3 en un entorn basat en XAMPP. Abans de res comprovarem que no el tenim
instal·lat, per a això seguirem els següents passos:</p>
<ol>
<li>
<p>Obrim la pàgina de benvinguda de XAMPP escrivint al navegador la URL
<a href="http://localhost">http://localhost</a>.</p>
</li>
<li>
<p>A la part superior de la pàgina tenim una sèrie d'enllaços, entre
els que es troba un que diu <code>phpinfo</code>. Feu clic en aquest enllaç.</p>
</li>
<li>
<p>Se'ns mostrarà la pàgina de configuració del nostre mòdul php. Anem
a seleccionar tots els continguts d'aquesta pàgina i els anem a copiar.</p>
</li>
<li>
<p>Obrirem al navegador la següent URL: <a href="http://xdebug.org/wizard.php">http://xdebug.org/wizard.php</a>.</p>
</li>
<li>
<p>En aquesta pàgina podrem comprovar quins mòduls tenim instal·lats en
nostre mòdul PHP. Per a això, enganxarem els continguts que hem copiat
prèviament a la caixa de text que apareix i premerem <code>Analyse
mi phpinfo() output</code>.</p>
</li>
<li>
<p>Ens apareixeran un resultats semblants a aquests:</p>
</li>
</ol>
<p><img alt="XDebug" src="../assets/Screenshot_2019-09-14_Xdebug_Support__Tailored_Installation_Instructions.png" /></p>
<p>Com es pot observar, l'extensió XDebug no està instal·lada. </p>
<p>Una altra informació important que ens dóna és que el nostre fitxer de
configuració del PHP el podem trobar en <code>/opt/lampp/etc/php.ini</code> i les
extensions les tenim en
<code>/opt/lampp/lib/php/extensions/no-debug-non-zts-20180731</code></p>
<p><em>És important que recordem aquestes dades.</em></p>
<p>Per instal·lar l'extensió XDebug seguirem les instruccions que ens
indica la pàgina anterior però compte perquè cal fer algunes
modificacions:</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Els caràcters <code>#</code> representen valors que depenen de cada instal·lació, així que cal tindre-ho en compte en executar-ho.</p>
</div>
<ol>
<li>Descarregueu <a href="https://xdebug.org/download">la darrera versió d'Xdebug</a></li>
<li>Instal·leu els requisits previs per a la compilació d'extensions
    PHP.\
    Instal·leu-lo amb el sistema Ubuntu amb:
    <code>apt-get install php-dev autoconf automake</code></li>
<li>Desempaqueteu el fitxer descarregat amb <code>tar -xvzf xdebug-#.#.#.tgz</code></li>
<li>Executar: <code>cd xdebug-#.#.#</code></li>
<li>
<p>Executar: <code>/opt/lampp/bin/phpize</code> (hem canviat la ruta perquè
    execute el phpize de XAMPP).</p>
<p>Com a part de la seva eixida hauria de mostrar:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Configuring for:
<span class="linenos" data-linenos="2 "></span>...
<span class="linenos" data-linenos="3 "></span>Zend Module Api No: ########
<span class="linenos" data-linenos="4 "></span>Zend Extension Api No: #########
</code></pre></div>
<p>Si no és així, estàs utilitzant phpize incorrecta. Seguiu aquesta
entrada de FAQ i passeu al pas següent.</p>
</li>
<li>
<p>Executar: <code>./configure --with-php-config=/opt/lampp/bin/php-config</code>
    (hem afegit la ruta del php-config de XAMPP).</p>
</li>
<li>Compilem les fonts: <code>make</code></li>
<li>Executar:
    <code>sudo cp modules/xdebug.so /opt/lampp/lib/php/extensions/no-debug-non-zts-########</code></li>
<li>
<p>Edita <code>/opt/lampp/etc/php.ini</code> i afegeix les següents línies al
    final</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>[xdebug]
<span class="linenos" data-linenos="2 "></span>zend_extension=xdebug
</code></pre></div>
</li>
<li>
<p>Reinicieu el servidor web</p>
</li>
</ol>
<p>Repeteix els passos del 1 al 5 inicials per comprovar que XDebug sí està
instal·lat.</p>
<p><img alt="" src="../assets/Screenshot_2019-09-14_Xdebug_Support__Tailored_Installation_Instructions%281%29.png" /></p>
<p>Després caldrà configurar PHPStorm per a connectar-lo a XDebug <a href="https://www.jetbrains.com/help/phpstorm/configuring-xdebug.html#integrationWithProduct">Integració amb PHPStorm</a> i instal·lar una extensió de Firefox <a href="https://addons.mozilla.org/ca/firefox/addon/xdebug-helper-for-firefox/?src=search">Xdebug Helper</a> o Chrome.</p>
<div class="admonition todo">
<p class="admonition-title">Pràctica 4. Instal·laciò d'XDebug</p>
<p>Seguint les instruccions anteriors instal·la i configura XDEBUG i connecta'l a PHP Storm.  </p>
</div></section><section class="print-page" id="02-phpbasics"><h1 id="02-phpbasics-el-llenguatge-php">El llenguatge PHP</h1>
<div class="admonition important">
<p class="admonition-title">Objectius</p>
<ul>
<li>Conèixer la sintaxi bàsica de PHP i les noves característiques de PHP 7.</li>
<li>Entendre com s'integren PHP i HTML.</li>
<li>Descriure els tipus de dades existents en PHP.</li>
<li>Fer servir les estructures de control bàsiques.</li>
<li>Aprendre a utilitzar els arrays associatius.</li>
<li>Conèixer els mecanismes de pas de paràmetres a un script.</li>
<li>Processar i validar formularis</li>
<li>Incloure fixters</li>
</ul>
</div>
<h2 id="02-phpbasics-introduccio">Introducció</h2>
<ul>
<li>Acrònim de <em>Personal Home Page</em></li>
<li>Llenguatge de propòsit general, encara que el seu fort és el desenvolupament web.</li>
<li>Sintaxi similar a C / Java</li>
<li>El codi s'executa en el servidor (en Apache mitjançant <em>mod_php</em>)</li>
<li>El client rep el resultat generat després d'interpretar el codi al servidor.</li>
<li>El codi s'emmagatzema en arxiu amb extensió <code>.php.</code></li>
</ul>
<p>L'última versió és la 8.0, de novembre de 2020 (i en breu tindrem la versió 8.1). La versió 7.0 va sortir al desembre de 2015. A més de nombroses noves funcionalitats que anirem veient durant el curs, té més de dues vegades millor rendiment que PHP5. </p>
<div class="admonition important">
<p class="admonition-title">PHP 7.4</p>
<p>Nosaltres farem ús de la versió 7.4 de PHP</p>
</div>
<p>La seva documentació és extensa i està traduïda: https://www.php.net/manual/es/. </p>
<h2 id="02-phpbasics-funcionament-i-estructura-basica">Funcionament i estructura bàsica</h2>
<h3 id="02-phpbasics-el-nostre-primer-codi-php">El nostre primer codi PHP</h3>
<ul>
<li>El codi PHP sempre va entre els simbolos <code>&lt;?php</code> i <code>?&gt;</code>.</li>
<li>Les instruccions PHP acaben sempre amb <code>;</code>.</li>
<li>Per a generar codi HTML des de PHP podem utilitzar el mètode <code>echo</code> passant-li el text del codi que volem generar.</li>
<li>El codi pot anar entre les etiquetes d'HTML.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="2 "></span><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="3 "></span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="4 "></span>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="s2">&quot;Hola món&quot;</span> <span class="cp">?&gt;</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="5 "></span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</code></pre></div>
<ul>
<li>També podem utilitzar l'etiqueta <strong>&lt;?=</strong> fa el echo al mateix temps.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="2 "></span><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="3 "></span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="4 "></span>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="cp">&lt;?</span><span class="o">=</span> <span class="s2">&quot;Hola món&quot;</span> <span class="cp">?&gt;</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="5 "></span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="02-phpbasics-comentaris">Comentaris</h3>
<ul>
<li>De bloc entre <code>/*</code> i <code>*/</code>.</li>
<li>De linea, començant per <code>//</code> o per <code>#</code>.</li>
</ul>
<h3 id="02-phpbasics-codi-incrustat">Codi incrustat</h3>
<p>El documents que contenen codi PHP s'han d'anomenar amb l'extensió <strong>.php</strong></p>
<h3 id="02-phpbasics-variables-i-tipus-de-dades">Variables i tipus de dades</h3>
<p>Una de les característiques de php és que és un llenguatge <strong>no fortament tipat</strong>. 
De fet no cal declarar la variable ni indicar el tipus de dades si la declare. 
Encara que si volem codi de qualitat ho hauriem de fer.</p>
<h4 id="02-phpbasics-declaracio">Declaració</h4>
<ul>
<li>Els noms de les variables sempre comencen per <code>$</code> </li>
<li>Després del $ els noms de les variables han d'anar seguits per una lletra o el caràcter <code>_</code> i poden contenir també números. </li>
<li>No és necessari declarar una variable ni especificar-li un tipus (sencer, cadena,...) concret.</li>
</ul>
<p>Per crear una variable que continga el text a generar i mostrar-la:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="cp">&lt;?php</span> 
<span class="linenos" data-linenos=" 6 "></span>        <span class="nv">$salutacio</span> <span class="o">=</span> <span class="s2">&quot;Hola món&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>        <span class="k">echo</span> <span class="nv">$salutacio</span><span class="p">;</span> 
<span class="linenos" data-linenos=" 8 "></span>    <span class="cp">?&gt;</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="10 "></span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="02-phpbasics-tipus-de-les-variables">Tipus de les variables</h4>
<ul>
<li>El tipus de la variable es decideix en funció del context en què s'utilitze.</li>
<li>En assignar-li el valor 7, la variable és de tipus “sencer” </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$la_meua_variable</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>  <span class="c1">// ara és un número</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$la_meua_variable</span> <span class="o">=</span> <span class="s2">&quot;set&quot;</span><span class="p">;</span> <span class="c1">// ara és cadena</span>
</code></pre></div>
<p>Si li canviem el contingut passa a ser de tipus “cadena”</p>
<h5 id="02-phpbasics-variable-no-inicialitzades">Variable no inicialitzades</h5>
<p>Si s'intenta utilitzar una variable abans d'assignar-li un valor, es genera un error de tipus <strong>E_NOTICE</strong> però no s'interromp l'execució de l'script. L'eixida mostrarà un avís cada volta que s'intente.</p>
<h4 id="02-phpbasics-tipus-de-dades-en-php">Tipus de dades en PHP</h4>
<ul>
<li>booleà (<strong>boolean</strong>). Els seus possibles valors són true i false. A més, qualsevol nombre enter es considera com true, excepte el 0 que és false.</li>
<li>sencer (<strong>integer</strong>). Qualsevol nombre sense decimals. Es poden representar en format decimal, octal (començant per un 0), o hexadecimal (començant per 0x).</li>
<li>real (<strong>float</strong>). Qualsevol nombre amb decimals. Es poden representar també en notació científica.</li>
<li>cadena (<strong>string</strong>). Conjunts de caràcters delimitats per cometes simples o dobles.</li>
<li>vector (<strong>array</strong>). Conjunt de variables del mateix tipus ordenades.</li>
<li>Objecte (<strong>object</strong>). Utilitzat per les instàncies de classes.</li>
<li><strong>null</strong>. És un tipus de dades especial, que s'usa per a indicar que la variable no té valor. (<a href="http://php.net/manual/es/language.types.null.php">http://php.net/manual/es/language.types.null.php</a>)</li>
</ul>
<h4 id="02-phpbasics-ambit-de-les-variables">Àmbit de les variables</h4>
<p>L'àmbit d'una variable és la part del codi en que és visible. 
Una variable declarada en un fitxer de PHP està disponible en eixe fitxer i en els que l'incloguen. 
Les funcions definixen un àmbit local, separat de la resta del codi.
Es poden definir variables globlals amb la paraula reservada <strong>global</strong>, encara que no són aconsellables.</p>
<h4 id="02-phpbasics-variables-predefinides">Variables predefinides</h4>
<p>Són variables internes predefinides de PHP que poden usar-se des de qualsevol àmbit. Tomem forma <strong>d'arrays associatius</strong> que contenen un conjunt de valors.</p>
<ul>
<li><strong>$_SERVER</strong>. Conté informació sobre l'entorn del servidor web i d'execució.</li>
<li><strong>$_GET, $_POST i $_COOKIE</strong> contenen les variables que s'han passat al
script actual utilitzant, respectivament, els mètodes GET (paràmetres en la URL), HTTP POST i Cookies HTTP </li>
<li><strong>$_REQUEST</strong> junta en un solament el contingut dels tres *arrays anteriors,
$_GET, $_POST i $_COOKIE. </li>
<li><strong>$_ENV</strong> conté les variables que es puguen haver passat a PHP des de l'entorn en què s'executa. </li>
<li><strong>$_FILES</strong> conté els fitxers que es puguen haver pujat al servidor
utilitzant el mètode POST. </li>
<li><strong>$_SESSION</strong> conté les variables de sessió disponibles per al guió
actual.</li>
</ul>
<p><a href="http://es.php.net/manual/es/language.variables.superglobals.php">http://es.php.net/manual/es/language.variables.superglobals.php</a></p>
<h3 id="02-phpbasics-constants">Constants</h3>
<p>Per a definir constants s'utilitza <strong>define()</strong>, que reb el nom de la constant i el valor que li volem donar</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nb">define</span><span class="p">(</span><span class="s2">&quot;LIMITE&quot;</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
</code></pre></div>
<p>És habitual utilitzar identificadors en majuscules per a les constants.</p>
<h3 id="02-phpbasics-operadors">Operadors</h3>
<h3 id="02-phpbasics-arimetics">Arimètics</h3>
<table>
<thead>
<tr>
<th>Exemple</th>
<th>Nom</th>
<th>Resultat</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>+$a</code></td>
<td>Identidat</td>
<td>Conversió de <code>$a</code> a <code>int</code> o <code>float</code> segons el cas.</td>
</tr>
<tr>
<td><code>-$a</code></td>
<td>Negació</td>
<td>Oposat de <code>$a</code>.</td>
</tr>
<tr>
<td><code>$a + $b</code></td>
<td>Suma</td>
<td>Suma de <code>$a</code> i <code>$b</code>.</td>
</tr>
<tr>
<td><code>$a - $b</code></td>
<td>Resta</td>
<td>Diferència de <code>$a</code> i <code>$b</code>.</td>
</tr>
<tr>
<td><code>$a * $b</code></td>
<td>Multiplicació</td>
<td>Producte de <code>$a</code> i <code>$b</code>.</td>
</tr>
<tr>
<td><code>$a / $b</code></td>
<td>Divisió</td>
<td>Quocient de <code>$a</code> i <code>$b</code>.</td>
</tr>
<tr>
<td><code>$a % $b</code></td>
<td>Módul / Residu</td>
<td>Residu de <code>$a</code> dividit per <code>$b</code>.</td>
</tr>
<tr>
<td><code>$a ** $b</code></td>
<td>Potència</td>
<td>Resultat de <code>$a</code> elevat a <code>$b</code>. PHP &gt;= 5.6.</td>
</tr>
</tbody>
</table>
<p>En el caso de <strong>cadenas</strong>, si queremos concatenarlas, se utiliza el operador <code>.</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$x</span> <span class="o">=</span> <span class="mi">33</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$y</span> <span class="o">=</span> <span class="mi">11</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="nv">$z</span> <span class="o">=</span> <span class="nv">$x</span> <span class="o">+</span> <span class="nv">$y</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="k">echo</span> <span class="s2">&quot;La suma de 33 y 11 es &quot;</span><span class="o">.</span><span class="mf">44.</span><span class="s2">&quot;&lt;br /&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span><span class="k">echo</span> <span class="s2">&quot;La suma de &quot;</span><span class="o">.</span><span class="nv">$x</span><span class="o">.</span><span class="s2">&quot; y &quot;</span><span class="o">.</span><span class="nv">$y</span><span class="o">.</span><span class="s2">&quot; es &quot;</span><span class="o">.</span><span class="p">(</span><span class="mi">33</span> <span class="o">+</span> <span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;br /&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="6 "></span><span class="k">echo</span> <span class="s2">&quot;La suma de &quot;</span><span class="o">.</span><span class="nv">$x</span><span class="o">.</span><span class="s2">&quot; y &quot;</span><span class="o">.</span><span class="nv">$y</span><span class="o">.</span><span class="s2">&quot; es &quot;</span><span class="o">.</span><span class="nv">$z</span><span class="o">.</span><span class="s2">&quot;&lt;br /&gt;&quot;</span><span class="p">;</span>
</code></pre></div>
<p>Realment en lloc de concatenar cadenas con variables, podem imprimir-les directament 
ja que s'expandeixen automàticament:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">echo</span> <span class="s2">&quot;La suma de </span><span class="si">$x</span><span class="s2"> y </span><span class="si">$y</span><span class="s2"> es </span><span class="si">$z</span><span class="s2"> &lt;br /&gt;&quot;</span><span class="p">;</span>
</code></pre></div>
<p>En ocasions, necesitem envoltar el nom de la variable entre claus per poder un més text al resultat:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$color</span> <span class="o">=</span> <span class="s2">&quot;rojo&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">echo</span> <span class="s2">&quot;El plural de </span><span class="si">$color</span><span class="s2"> el </span><span class="si">${</span><span class="nv">color</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
<p>Més endavant estudiarem algunes funcions per al tractament de cadenes.</p>
<h3 id="02-phpbasics-comparacio">Comparació</h3>
<table>
<thead>
<tr>
<th>Exemple</th>
<th>Nom</th>
<th>Resultat</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>$a == $b</code></td>
<td>Igual</td>
<td><code>true</code> si <code>$a</code> és igual a <code>$b</code> després de la conversió de tipus.</td>
</tr>
<tr>
<td><code>$a === $b</code></td>
<td>Idèntic, Comparació estricta</td>
<td><code>true</code> si <code>$a</code> és igual a <code>$b</code>, i són del mateix tipus de dada.</td>
</tr>
<tr>
<td><code>$a != $b</code>, <code>$a &lt;&gt; $b</code></td>
<td>Diferent</td>
<td><code>true</code> si <code>$a</code> no és igual a <code>$b</code> després de la conversió de tipus.</td>
</tr>
<tr>
<td><code>$a !== $b</code></td>
<td>No idèntic</td>
<td><code>true</code> si <code>$a</code> no és igual a <code>$b</code>, o si no són del mateix tipus.</td>
</tr>
<tr>
<td><code>$a &lt; $b</code></td>
<td>Menor que</td>
<td><code>true</code> si <code>$a</code> és estrictament menor que <code>$b</code>.</td>
</tr>
<tr>
<td><code>$a &gt; $b</code></td>
<td>Major que</td>
<td><code>true</code> si <code>$a</code> és estrictament major que <code>$b</code>.</td>
</tr>
<tr>
<td><code>$a &lt;= $b</code></td>
<td>Menor o igual que</td>
<td><code>true</code> si <code>$a</code> és menor o igual que <code>$b</code>.</td>
</tr>
<tr>
<td><code>$a &gt;= $b</code></td>
<td>Major o igual que</td>
<td><code>true</code> si <code>$a</code> és major o igual que <code>$b</code>.</td>
</tr>
<tr>
<td><code>$a &lt;=&gt; $b</code></td>
<td>Nau espacial</td>
<td>Torna <code>-1</code>, <code>0</code> o <code>1</code> quan <code>$a</code> és respectivamente menor, igual, o major que <code>$b</code>. PHP &gt;= 7.</td>
</tr>
<tr>
<td><code>$a ?? $b ?? $c</code></td>
<td>Fusión de <em>null</em></td>
<td>El primer operano d'esquerra a dreta que existisca i no siga <code>null</code>. <code>null</code> si no hi ha valors definits i no són <code>null</code>. PHP &gt;= 7.</td>
</tr>
</tbody>
</table>
<h3 id="02-phpbasics-logics">Lògics</h3>
<table>
<thead>
<tr>
<th>Exemple</th>
<th>Nom</th>
<th>Resultat</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>$a and $b</code>, <code>$a &amp;&amp; $b</code></td>
<td><em>And</em> (i)</td>
<td><code>true</code> si tant <code>$a</code> com <code>$b</code> són <code>true</code>.</td>
</tr>
<tr>
<td><code>$a or $b</code>, <code>$a || $b</code></td>
<td><em>Or</em> (o inclusiu)</td>
<td><code>true</code> si qualsevol de <code>$a</code> o <code>$b</code> és <code>true</code>.</td>
</tr>
<tr>
<td><code>$a xor $b</code></td>
<td><em>Xor</em> (o exclusiu)</td>
<td><code>true</code> si <code>$a</code> o <code>$b</code> és <code>true</code>, pero no ambdós.</td>
</tr>
<tr>
<td><code>!$a</code></td>
<td><em>Not</em> (no)</td>
<td><code>true</code> si <code>$a</code> no és <code>true</code>.</td>
</tr>
</tbody>
</table>
<h3 id="02-phpbasics-assignacio">Assignació</h3>
<table>
<thead>
<tr>
<th>Exemple</th>
<th>Nom</th>
<th>Resultat</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>$a = $b</code></td>
<td>Assignació</td>
<td>Assigna a <code>$a</code> el valor de <code>$b</code></td>
</tr>
<tr>
<td><code>$a += $b</code></td>
<td>Assignació de la suma</td>
<td>Le suma a <code>$a</code> el valor de <code>$b</code>. Equivalent a <code>$a = $a + $b</code></td>
</tr>
<tr>
<td><code>$a -= $b</code></td>
<td>Assignació de la resta</td>
<td>Le resta a <code>$a</code> el valor de <code>$b</code>. Equivalent a <code>$a = $a - $b</code></td>
</tr>
<tr>
<td><code>$a *= $b</code></td>
<td>Assignació del producte</td>
<td>Assigna a <code>$a</code> el producto de <code>$a</code> por <code>$b</code>. Equivalent a <code>$a = $a * $b</code></td>
</tr>
<tr>
<td><code>$a /= $b</code></td>
<td>Assignació de la divisió</td>
<td>Assigna a <code>$a</code> el quocient de <code>$a</code> entre <code>$b</code>. Equivalent a <code>$a = $a / $b</code></td>
</tr>
<tr>
<td><code>$a %= $b</code></td>
<td>Assignació del residu</td>
<td>Assigna a <code>$a</code> el residu de dividir <code>$a</code> entre <code>$b</code>. Equivalent a <code>$a = $a % $b</code></td>
</tr>
<tr>
<td><code>$a .= $b</code></td>
<td>Concatenació</td>
<td>Concatena a <code>$a</code> la cadena <code>$b</code>. Equivalent a <code>$a = $a . $b</code></td>
</tr>
<tr>
<td><code>$a++</code></td>
<td>Increment</td>
<td>Incrementa <code>$a</code> en una unitat. Equivalent a <code>$a = $a + 1</code></td>
</tr>
<tr>
<td><code>$a--</code></td>
<td>Decrement</td>
<td>Decrementa <code>$a</code> en una unitat. Equivalent a <code>$a = $a - 1</code></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Prioridad de los operadores</p>
<p>Recorda la prioritat. Primer els parèntesis, després la negació (<code>!</code>), productes/divisions, sumes/restes, comparacions, lògics i finalment es realitza l'assignació.
Més informació a <a href="https://www.php.net/manual/es/language.operators.precedence.php">https://www.php.net/manual/es/language.operators.precedence.php</a></p>
</div>
<div class="admonition question">
<p class="admonition-title">Autoevaluación</p>
<p>Si <code>$a=5</code> i <code>$b=4</code>, esbrina el valor de <code>$c</code> si <code>$c = $a*2 &gt; $b+5 &amp;&amp; !($b&lt;&gt;4)</code></p>
</div>
<h4 id="02-phpbasics-operador-ternari">Operador ternari</h4>
<p>Funciona com un condicional <strong>condició ? valor si true : valor si false</strong> i que es pot simplificar ** condició  </p>
<p><a href="https://www.php.net/manual/es/language.operators.php">https://www.php.net/manual/es/language.operators.php</a></p>
<p>Farem alguns <strong>exercicis</strong>: <a href="#02-phpbasics-2.0.activitat.md">Exercisi 2.0 Conceptes bàsics</a></p>
<h2 id="02-phpbasics-estructures-de-control-de-flux">Estructures de control de flux</h2>
<ul>
<li>
<p>Les instruccions de control de flux en PHP funcionen exactament igual que en altres llenguatges de programació.</p>
</li>
<li>
<p>Les més habituals són:</p>
</li>
<li>
<p>Condicionals: if, if else, switch </p>
</li>
<li>Bucles: while, do while, for</li>
</ul>
<p>seguint les estructures:</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">if</span> <span class="p">(</span><span class="nx">condició</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="c1">// instruccions</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
<span class="linenos" data-linenos="4 "></span><span class="k">else</span> <span class="p">{</span>
<span class="linenos" data-linenos="5 "></span>    <span class="c1">// instruccions</span>
<span class="linenos" data-linenos="6 "></span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">switch</span> <span class="p">(</span><span class="nv">$variable</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>    <span class="k">case</span> <span class="nx">valor</span><span class="o">:</span>
<span class="linenos" data-linenos=" 3 "></span>        <span class="c1">//instruccio1</span>
<span class="linenos" data-linenos=" 4 "></span>        <span class="k">break</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">case</span> <span class="nx">valor</span><span class="o">:</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="c1">//instruccio1</span>
<span class="linenos" data-linenos=" 7 "></span>        <span class="k">break</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">default</span><span class="o">:</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="c1">//instruccio1</span>
<span class="linenos" data-linenos="10 "></span><span class="p">}</span>           
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">while</span> <span class="p">(</span><span class="nx">condició</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="c1">//instruccions</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">do</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="c1">//instruccions</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="nx">condició</span><span class="p">);</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="linenos" data-linenos="2 "></span>    <span class="c1">//instruccions</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div></p>
<p><a href="http://php.net/manual/es/language.control-structures.php">http://php.net/manual/es/language.control-structures.php</a></p>
<h4 id="02-phpbasics-expansio-de-variables">Expansió de variables</h4>
<ul>
<li>Podem introduir una variable dins d'un text sempre que usem les cometes dobles per a delimitar el text. Açò farà que el contingut de la variable s'expandisca i es concatene amb el text existent en la cadena.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;Mòdul: </span><span class="si">$module</span><span class="s2">&lt;/p&gt;&quot;</span>
</code></pre></div>
<ul>
<li>A voltes, és necessari envoltar-la entre claus</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;Mòdul: </span><span class="si">{</span><span class="nv">$module</span><span class="si">}</span><span class="s2">DAW&lt;/p&gt;&quot;</span>
</code></pre></div>
<ul>
<li>Si no posàrem les claus l'intèrpret cercaria una variable que es cride $moduleDAW</li>
</ul>
<h2 id="02-phpbasics-maneig-de-cadenes-de-text">Maneig de cadenes de text</h2>
<ul>
<li>Podem utilitzar tant cometes simples com a cometes dobles.</li>
<li>Per a concatenar cadenes utilitzarem l'operador punt (.)</li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>$fullName = $name.&#39; &#39;.$surname;
</code></pre></div>
<a href="https://www.php.net/manual/es/ref.strings.php">Funcions de cadena</a></p>
<h2 id="02-phpbasics-maneig-de-dates">Maneig de dates</h2>
<h3 id="02-phpbasics-funcio-time">Funció <code>time()</code></h3>
<p>En PHP les dates s'emmagatzemen com a números enters. La funció <code>time()</code> retorna el nombre de segons transcorreguts 
des de l'1 de gener de 1970 (instant conegut com a època Unix). 
A aquesta forma d'expressar data i hora se li denomina <strong>timestamp</strong>.</p>
<h3 id="02-phpbasics-funcio-date">Funció <code>date()</code></h3>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nb">date</span> <span class="p">(</span><span class="nx">string</span> <span class="nv">$format</span> <span class="p">[,</span> <span class="nx">int</span> <span class="nv">$timestamp</span><span class="o">=</span><span class="nb">time</span><span class="p">()])</span><span class="o">:</span> <span class="nx">string</span>
</code></pre></div>
<p>La funció <code>date</code> retorna una cadena formatada segons els codi de format. Si no li passem la variable <code>timestamp</code> 
ens retorna la cadena formatada per a la data i l'hora actual.</p>
<p>Els codis de format més habituals  per a la funció <code>date</code> són:</p>
<table>
<thead>
<tr>
<th>CODI</th>
<th>DESCRIPCIÓ</th>
</tr>
</thead>
<tbody>
<tr>
<td>a</td>
<td>am o pm</td>
</tr>
<tr>
<td>A</td>
<td>AM o PM</td>
</tr>
<tr>
<td>d</td>
<td>Dia del mes amb zeros</td>
</tr>
<tr>
<td>D</td>
<td>Abreviatura del dia de la setmana (en anglès)</td>
</tr>
<tr>
<td>F</td>
<td>Nom del mes (en anglès)</td>
</tr>
<tr>
<td>h</td>
<td>Hora en format 1-12</td>
</tr>
<tr>
<td>H</td>
<td>Hora en format 0-23</td>
</tr>
<tr>
<td>i</td>
<td>Minuts</td>
</tr>
<tr>
<td>j</td>
<td>Dia del mes sense zeros</td>
</tr>
<tr>
<td>l</td>
<td>Dia de la setmana</td>
</tr>
<tr>
<td>m</td>
<td>Número de mes (1-12)</td>
</tr>
<tr>
<td>M</td>
<td>Abreviatura del mes (en anglès)</td>
</tr>
<tr>
<td>s</td>
<td>Segons</td>
</tr>
<tr>
<td>y</td>
<td>Any amb 2 dígits</td>
</tr>
<tr>
<td>Y</td>
<td>Any amb 4 dígits</td>
</tr>
<tr>
<td>z</td>
<td>Dia de l'any (1-365)</td>
</tr>
</tbody>
</table>
<p>La informació completa la pots trobar en el <a href="https://www.php.net/manual/es/function.date.php">manual oficial de PHP: date</a></p>
<p>Suposant que hui és 15 de setembre de 2019 i les 19 hores 20 minuts i 23 segons et mostrem alguns exemples:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d-m-Y&quot;</span><span class="p">);</span> <span class="c1">// 15-09-2019</span>
<span class="linenos" data-linenos="2 "></span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;H:i:s&quot;</span><span class="p">);</span>  <span class="c1">//  19:20:23</span>
<span class="linenos" data-linenos="3 "></span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">);</span> <span class="c1">// 2019</span>
<span class="linenos" data-linenos="4 "></span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;YmdHis&quot;</span><span class="p">);</span> <span class="c1">// 20190915192023</span>
<span class="linenos" data-linenos="5 "></span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/y H:i a&quot;</span><span class="p">);</span> <span class="c1">// 15/09/19 19:20 pm</span>
<span class="linenos" data-linenos="6 "></span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d-m-Y H:i&quot;</span><span class="p">,</span> <span class="nb">time</span><span class="p">());</span> <span class="c1">// Moment actual</span>
</code></pre></div>
<h3 id="02-phpbasics-funcio-mktimehora-min-seg-mes-dia-any">Funció <code>mktime(hora, min, seg, mes, dia, any)</code></h3>
<p>La funció mktime permet obtenir la marca de temps Unix (<em>timestamp</em>) d'una data.</p>
<p>Per exemple:</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$data</span> <span class="o">=</span> <span class="nb">mktime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2020</span><span class="p">);</span>
<span class="linenos" data-linenos="2 "></span><span class="k">echo</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;d-m-Y&#39;</span><span class="p">,</span> <span class="nv">$data</span><span class="p">);</span> <span class="c1">// mostrarà 01-01-2020</span>
</code></pre></div>
Més informació en <a href="https://www.php.net/manual/es/function.mktime.php">https://www.php.net/manual/es/function.mktime.php</a></p>
<p>Un altra forma de crear dates és mitjançant la funció <code>strtotime()</code> on podem indicar les dates mitjançant una cadena de text. Per exemple:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">// posarem la data en el format any-mes-dia per a evitar confusions.</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$date</span> <span class="o">=</span><span class="nb">strtotime</span><span class="p">(</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">);</span> 
</code></pre></div>
<h3 id="02-phpbasics-operar-amb-dates">Operar amb dates</h3>
<p>Com hem dit al principi les dates s'emmagatzem com a enters on cada unitat representa un segon. Així podem sumar i restar dates (<em>timestamp</em>) per a afegir, llevar o calcular diferències entre ells.</p>
<p>Per exemple, per poder determinar els dies que falten per a l'1 de gener de 2020 faríem:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$data</span><span class="o">=</span><span class="nb">mktime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2020</span><span class="p">);</span> <span class="c1">// timestamp que representa l&#39;1 de gener de 2020</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$diferencia</span><span class="o">=</span><span class="nv">$data</span> <span class="o">-</span> <span class="nb">time</span><span class="p">();</span> <span class="c1">// restem a l&#39;1 de gener de 2020 el temps actual, </span>
<span class="linenos" data-linenos="3 "></span>                                <span class="c1">// el resultat estarà en segons.</span>
<span class="linenos" data-linenos="4 "></span><span class="nv">$diferenciaEnDies</span> <span class="o">=</span><span class="p">(((</span> <span class="nv">$diferencia</span> <span class="o">/</span> <span class="mi">60</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">24</span> <span class="p">);</span>
<span class="linenos" data-linenos="5 "></span><span class="cm">/*  </span>
<span class="linenos" data-linenos="6 "></span><span class="cm">    dividim els segons entre 60 i obtenim els minuts,</span>
<span class="linenos" data-linenos="7 "></span><span class="cm">    els dividim entre 60 i obtenim les hores,</span>
<span class="linenos" data-linenos="8 "></span><span class="cm">    els dividim entre 24 i obtenim els dies </span>
<span class="linenos" data-linenos="9 "></span><span class="cm">*/</span>
</code></pre></div>
<h3 id="02-phpbasics-validar-dates">Validar dates</h3>
<p>En la funció <code>checkdate</code> podem validar una data.</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nb">checkdate</span> <span class="p">(</span><span class="nx">int</span> <span class="nv">$month</span><span class="p">,</span> <span class="nx">int</span> <span class="nv">$day</span> <span class="p">,</span><span class="nx">int</span> <span class="nv">$year</span><span class="p">)</span><span class="o">:</span> <span class="nx">bool</span>
</code></pre></div>
La funció torna <code>true</code> si la data es vàlida, si no, torna  <code>false</code>. </p>
<h3 id="02-phpbasics-classe-datetime">Classe DateTime</h3>
<p>PHP disposa també de la classe <code>DateTime</code> per a representar les dates, la veurem més avant.</p>
<div class="admonition todo">
<p class="admonition-title">Activitat 3: Treballar amb dates</p>
<p>Crea un fitxer anomenat dates.php i realitza les següents tasques:</p>
<ol>
<li>Mostra la data i hora actuals amb el format: <code>dd/mm/yyyy hh:mm:ss</code></li>
<li>Mostra el nom de la zona horària que s'utilitza per defecte.</li>
<li>Mostra la data de que serà d’ací 45 dies.</li>
<li>Mostra el nombre de dies que han passat des de l'1 de gener.</li>
<li>Mostra la data i hora actuals de Nova York.</li>
<li>Mostra el dia de la setmana que era l'1 de gener d'enguany.</li>
</ol>
<p>En acabar penja el document a Aules.</p>
</div>
<div class="admonition todo">
<p class="admonition-title">Activitat 4</p>
<p><code>200dadesPersonals.php</code>: Escriu un programa que emmagatzeme en variables teu nom, primer cognom, segon cognom, email, any de naixement i telèfon. Després mostra'ls per pantalla dins d'una taula.     </p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Nom</td>
<td>Bruce</td>
<td></td>
</tr>
<tr>
<td>Cognoms</td>
<td>Wayne</td>
<td></td>
</tr>
<tr>
<td>Email</td>
<td>batman@dccomics.com</td>
<td></td>
</tr>
<tr>
<td>Any de naixement</td>
<td>1939</td>
<td></td>
</tr>
<tr>
<td>Telèfon</td>
<td>555666777</td>
<td></td>
</tr>
</tbody>
</table>
<p><code>206anyos.php</code>: Després de llegir l'edat d'una persona, mostrar l'edat que tindrà d'aquí a 10 anys i fa 10 anys. A més, mostra quin any serà en cada un dels casos. Finalment, mostra l'any de jubilació suposant que treballaràs fins als 65 anys.</p>
<p>Tip: <code>$anyoActual = date("Y")</code>;</p>
</div>
<h2 id="02-phpbasics-maneig-darrays">Maneig d'arrays</h2>
<p>Un array és un tipus de dades que ens permet emmagatzemar diversos valors. Per tal d'accedir a un valor utilitzarem una <em>clau</em>. Les claus poden ser nombres o textos (<em>arrays associatius</em>). Si no indiquem cap clau, a cada element se li associarà una clau numèrica correlativa.</p>
<h3 id="02-phpbasics-array-indexat">Array indexat</h3>
<h4 id="02-phpbasics-crear-array">Crear array</h4>
<ul>
<li>Podem crear un array buit de dues formes:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$noms</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$noms</span> <span class="o">=</span> <span class="p">[];</span>
</code></pre></div>
<ul>
<li>Si volem assignar valors al array en el moment de crear-ho: </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$noms</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Sandra&#39;</span><span class="p">,</span> <span class="s1">&#39;Pedro&#39;</span><span class="p">,</span> <span class="s1">&#39;Andrea&#39;</span><span class="p">);</span> 
<span class="linenos" data-linenos="2 "></span><span class="nv">$noms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Sandra&#39;</span><span class="p">,</span> <span class="s1">&#39;Pedro&#39;</span><span class="p">,</span> <span class="s1">&#39;Andrea&#39;</span><span class="p">];</span>
</code></pre></div>
<h4 id="02-phpbasics-mostrar-el-contingut-dun-array">Mostrar el contingut d'un array</h4>
<p>Si intentem mostrar el contingut d'un array amb <strong>echo</strong> no obtindrem  les dades que hi ha dins del array. En lloc d'açò podem utilitzar la funció print_r: </p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nb">print_r</span><span class="p">(</span><span class="nv">$noms</span><span class="p">);</span>
</code></pre></div>
<p>Però si necessitem donar-li format als continguts del array, haurem de recórrer-ho amb un bucle i anar mostrant element a element.</p>
<h4 id="02-phpbasics-afegint-elements-al-array">Afegint elements al array</h4>
<p>Podem afegir elements al array utilitzant claudàtors buits. La clau d'aquests elements serà el següent índex numèric disponible.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$noms</span><span class="p">[]</span><span class="o">=</span><span class="s1">&#39;Raul&#39;</span><span class="p">;</span> <span class="nv">$noms</span><span class="p">[]</span><span class="o">=</span><span class="s1">&#39;Marta&#39;</span><span class="p">;</span>
</code></pre></div>
<h4 id="02-phpbasics-accedir-als-elements-del-array">Accedir als elements del array</h4>
<p>Accedirem als elements del array indicant la clau de l'element entre claudàtors:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">echo</span> <span class="nv">$noms</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</code></pre></div>
<p>També podem modificar el seu valor:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$noms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Sara&#39;</span><span class="p">;</span>
</code></pre></div>
<h4 id="02-phpbasics-recorrer-arrays">Recórrer arrays</h4>
<p><img alt="" src="../assets/t204.png" /></p>
<h3 id="02-phpbasics-arrays-associatius">Arrays associatius</h3>
<p>Si el array conté dades diverses i/o ens interessa accedir a ells amb claus més específiques que un simple índex numèric podem utilitzar arrays associatius: </p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$alumne</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;nom&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Sara&#39;</span><span class="p">,</span> <span class="s1">&#39;cognom&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;García&#39;</span><span class="p">,</span> <span class="s1">&#39;edat&#39;</span> <span class="o">=&gt;</span> <span class="mi">22</span> <span class="p">);</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$alumne</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nom&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Sara&#39;</span><span class="p">,</span> <span class="s1">&#39;cognom&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;García&#39;</span><span class="p">,</span> <span class="s1">&#39;edat&#39;</span> <span class="o">=&gt;</span> <span class="mi">22</span> <span class="p">];</span>
<span class="linenos" data-linenos="3 "></span><span class="nv">$alumne</span><span class="p">[</span><span class="s1">&#39;nom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Verónica&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="k">echo</span> <span class="nv">$alumne</span><span class="p">[</span><span class="s1">&#39;nom&#39;</span><span class="p">];</span>
</code></pre></div>
<h4 id="02-phpbasics-recorrer-arrays-associatius">Recórrer arrays associatius</h4>
<p><img alt="" src="../assets/t205.png" /></p>
<h4 id="02-phpbasics-recorrer-claus-i-valors">Recórrer claus i valors</h4>
<p><img alt="" src="../assets/t206.png" /></p>
<h3 id="02-phpbasics-arrays-multidimensionals">Arrays multidimensionals</h3>
<p>Imagina que volem tenir un array els elements del qual són noms d'esports. Volem dividir-los en esports d'hivern i esports d'estiu. Podem crear un array esports que continga dos elements que al seu torn també seran arrays.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$esports</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hivern&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;esquí de fons&#39;</span><span class="p">,</span> <span class="s1">&#39;hoquei sobre gel&#39;</span><span class="p">],</span> <span class="s1">&#39;estiu&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s1">&#39;natació&#39;</span><span class="p">,</span> <span class="s1">&#39;voley platja&#39;</span><span class="p">]</span> <span class="p">];</span>
</code></pre></div>
<p>Per a accedir al primer esport d'hivern:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">echo</span> <span class="nv">$esports</span><span class="p">[</span><span class="s1">&#39;hivern&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
</code></pre></div>
<h3 id="02-phpbasics-funcions-darrays">Funcions d'arrays</h3>
<p>Podem obtenir la mida de l'array mitjançant la funció <code>count(array)</code>. 
Per recórrer l'array farem ús d'un bucle <code>for</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>$tam = count($fruites); // mida de l&#39;array
<span class="linenos" data-linenos="2 "></span>for ($i=0; $i<span class="p">&lt;</span><span class="nt">count</span><span class="err">($</span><span class="na">fruites</span><span class="err">);</span> <span class="err">$</span><span class="na">i</span><span class="err">++)</span> <span class="err">{</span>
<span class="linenos" data-linenos="3 "></span>   <span class="na">echo</span> <span class="err">&quot;</span><span class="na">Element</span> <span class="err">$</span> <span class="na">i:</span> <span class="err">$</span> <span class="na">fruites</span> <span class="err">[$</span> <span class="na">i</span><span class="err">]</span> <span class="err">&lt;</span><span class="na">br</span> <span class="p">/&gt;</span>&quot;;
<span class="linenos" data-linenos="4 "></span>}
</code></pre></div>
<p>Les operacions més importants que podem realitzar amb <em>arrays</em> són:</p>
<ul>
<li><code>print_r($ array)</code>: mostra el contingut de tot el <code>$array</code></li>
<li><code>$elem = array_pop($array)</code>: elimina l'últim <code>$element</code></li>
<li><code>array_push ($ array, $ elem)</code>: afegeix un <code>$element</code> al final.</li>
<li><code>$bool = in_array($elem, $array)</code>: esbrina si <code>$elem</code> està en el<code>$array</code></li>
</ul>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="02-phpbasics-__tabbed_1_1" name="02-phpbasics-__tabbed_1" type="radio" /><label for="02-phpbasics-__tabbed_1_1">PHP</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="nv">$fruits</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="s2">&quot;pear&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">];</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="nb">array_push</span> <span class="p">(</span><span class="nv">$fruites</span><span class="p">,</span> <span class="s2">&quot;pinapple&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 4 "></span><span class="nb">print_r</span><span class="p">(</span><span class="nv">$fruits</span><span class="p">);</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="nv">$lastFruit</span> <span class="o">=</span> <span class="nb">array_pop</span><span class="p">(</span><span class="nv">$fruits</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;pineapple&quot;</span><span class="p">,</span> <span class="nv">$fruits</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt; Pineapple left &lt;/ p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt; No pineapple left &lt;/ p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span><span class="nb">print_r</span><span class="p">(</span><span class="nv">$fruites</span><span class="p">);</span>
<span class="linenos" data-linenos="13 "></span><span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
</div>
<input id="02-phpbasics-__tabbed_1_2" name="02-phpbasics-__tabbed_1" type="radio" /><label for="02-phpbasics-__tabbed_1_2">Consola</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="go">Array</span>
<span class="linenos" data-linenos=" 2 "></span><span class="go">(</span>
<span class="linenos" data-linenos=" 3 "></span><span class="go">  [0] =&gt; orange</span>
<span class="linenos" data-linenos=" 4 "></span><span class="go">  [1] =&gt; pear</span>
<span class="linenos" data-linenos=" 5 "></span><span class="go">  [2] =&gt; apple</span>
<span class="linenos" data-linenos=" 6 "></span><span class="go">  [3] =&gt; pinapple</span>
<span class="linenos" data-linenos=" 7 "></span><span class="go">)</span>
<span class="linenos" data-linenos=" 8 "></span><span class="go">&lt;p&gt;No pineapple left&lt;/ p&gt;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="go">Array</span>
<span class="linenos" data-linenos="10 "></span><span class="go">(</span>
<span class="linenos" data-linenos="11 "></span><span class="go">  [0] =&gt; orange</span>
<span class="linenos" data-linenos="12 "></span><span class="go">  [1] =&gt; pear</span>
<span class="linenos" data-linenos="13 "></span><span class="go">  [2] =&gt; apple</span>
<span class="linenos" data-linenos="14 "></span><span class="go">)</span>
</code></pre></div>
</div>
</div>
<ul>
<li><code>$claus = array_keys($array)</code>: torna les claus de l'<code>$ array</code> associatiu.</li>
<li><code>$tam = count ($array)</code>: retorna la mida de <code>$ array</code>.</li>
<li><code>sort($array)</code>: ordena els elements de l' <code>$ array</code>.</li>
<li><code>isset($array[element])</code>: indica si existeix / té valor element dins del array.</li>
<li><code>unset($array[element])</code>: elimina l'element de l'array (deixa un buit).</li>
</ul>
<div class="tabbed-set" data-tabs="2:2"><input checked="checked" id="02-phpbasics-__tabbed_2_1" name="02-phpbasics-__tabbed_2" type="radio" /><label for="02-phpbasics-__tabbed_2_1">PHP</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="nv">$capitals</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="s2">&quot;Italy&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Rome&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 2 "></span>  <span class="s2">&quot;France&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Paris&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 3 "></span>  <span class="s2">&quot;Portugal&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Lisbon&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="nv">$countries</span> <span class="o">=</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$capitals</span><span class="p">);</span>
<span class="linenos" data-linenos=" 6 "></span><span class="nb">print_r</span><span class="p">(</span><span class="nv">$countries</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="nb">sort</span><span class="p">(</span><span class="nv">$countries</span><span class="p">);</span>
<span class="linenos" data-linenos=" 8 "></span><span class="nb">print_r</span><span class="p">(</span><span class="nv">$countries</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="nb">unset</span><span class="p">(</span><span class="nv">$capitals</span><span class="p">[</span><span class="s2">&quot;France&quot;</span><span class="p">]);</span>
<span class="linenos" data-linenos="11 "></span><span class="nb">print_r</span><span class="p">(</span><span class="nv">$capitals</span><span class="p">);</span>
</code></pre></div>
</div>
<input id="02-phpbasics-__tabbed_2_2" name="02-phpbasics-__tabbed_2" type="radio" /><label for="02-phpbasics-__tabbed_2_2">Consola</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="go">Array</span>
<span class="linenos" data-linenos=" 2 "></span><span class="go">(</span>
<span class="linenos" data-linenos=" 3 "></span><span class="go">  [0] =&gt; Italy</span>
<span class="linenos" data-linenos=" 4 "></span><span class="go">  [1] =&gt; France</span>
<span class="linenos" data-linenos=" 5 "></span><span class="go">  [2] =&gt; Portugal</span>
<span class="linenos" data-linenos=" 6 "></span><span class="go">)</span>
<span class="linenos" data-linenos=" 7 "></span><span class="go">Array</span>
<span class="linenos" data-linenos=" 8 "></span><span class="go">(</span>
<span class="linenos" data-linenos=" 9 "></span><span class="go">  [0] =&gt; France</span>
<span class="linenos" data-linenos="10 "></span><span class="go">  [1] =&gt; Italy</span>
<span class="linenos" data-linenos="11 "></span><span class="go">  [2] =&gt; Portugal</span>
<span class="linenos" data-linenos="12 "></span><span class="go">)</span>
<span class="linenos" data-linenos="13 "></span><span class="go">Array</span>
<span class="linenos" data-linenos="14 "></span><span class="go">(</span>
<span class="linenos" data-linenos="15 "></span><span class="go">  [Italy] =&gt; Rome</span>
<span class="linenos" data-linenos="16 "></span><span class="go">  [Portugal] =&gt; Lisbon</span>
<span class="linenos" data-linenos="17 "></span><span class="go">)</span>
</code></pre></div>
</div>
</div>
<p>Existeixen moltíssimes més funcions per treballar amb arrays. Tota la informació en el <a href="https://www.php.net/manual/es/ref.array.php">documentació oficial</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Articles per aprofundir en les operacions amb arrays</p>
<ul>
<li>Un article molt complet (en anglès) de <a href="#02-phpbasics-<https:-code.tutsplus.com-tutorials-working-with-php-arrays-in-the-right-way-cms-28606">Com treballar amb arrays en PHP de la manera correcta</a>.</li>
<li>Un altre article recomanable (en anglès) és <a href="https://code.tutsplus.com/tutorials/wow-to-sort-arrays-in-php--cms-32313">Com ordenar arrays en PHP</a>.</li>
</ul>
</div>
<p>Altres recursos: </p>
<ul>
<li><a href="https://www.studytonight.com/php/indexed-array">https://www.studytonight.com/php/indexed-array</a></li>
<li><a href="https://aprende-web.net/php/php6_1.php">https://aprende-web.net/php/php6_1.php</a></li>
</ul>
<h2 id="02-phpbasics-funcions">Funcions</h2>
<h3 id="02-phpbasics-funcions-predefinides">Funcions predefinides</h3>
<p>Algunes de les funcions predefinides en PHP són les següents, però hi ha moltíssimes més 
vinculades als diferents mòduls que podem instal·lar.</p>
<ul>
<li><code>is_null($var)</code> determina si una variable és nula o no.</li>
<li><code>isset($var)</code> determina si una variable estan definida i no és NULL.</li>
<li><code>unset($var)</code> destrueix les variables especificades.</li>
<li><code>empty($var)</code> torna <strong>true</strong> si no existeix o és <strong>FALSE</strong></li>
<li><code>is_int($var)</code>, <strong>is_float()</strong>, <strong>is_bool()</strong>, <strong>is_array()</strong></li>
<li><code>var_dump($var)</code>, mostra informació de la variable.</li>
</ul>
<h3 id="02-phpbasics-funcions-definides-per-lusuari">Funcions definides per l'usuari</h3>
<p>Per a crear les teues pròpies funcions, hauràs d'usar la paraula <strong>function</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">function</span> <span class="nf">suma</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">)</span> <span class="p">{</span> 
<span class="linenos" data-linenos="2 "></span>    <span class="k">return</span> <span class="nv">$a</span> <span class="o">+</span> <span class="nv">$b</span><span class="p">;</span> 
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
<p>Per tal d'invocar la funció:</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$resultat</span> <span class="o">=</span> <span class="nx">suma</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</code></pre></div>
Si una funció no té una sentència <strong>return</strong>, retorna <strong>null</strong> en finalitzar.</p>
<div class="admonition important">
<p class="admonition-title">Command-query separation</p>
<p>Sí bé és un principi de la programació orientada a objectes és útil usar-lo també quan definim funcions. El principi afirma que cada mètode ha de ser un comandament que realitza una acció o una consulta que retorna dades al que la crida, pero no ambdues coses.</p>
</div>
<h3 id="02-phpbasics-valors-per-defecte-en-els-parametres">Valors per defecte en els paràmetres</h3>
<p>Podem indicar valors per defecte per als paràmetres. Si quan cridem a la funció no indiquem el valor d'un paràmetre es prendrà el valor per defecte indicat.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">function</span> <span class="nf">preuAmbIva</span><span class="p">(</span><span class="nv">$preu</span><span class="p">,</span> <span class="nv">$iva</span><span class="o">=</span><span class="mf">0.21</span><span class="p">){</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">return</span> <span class="nv">$preu</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nv">$iva</span><span class="p">);</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
<span class="linenos" data-linenos="4 "></span><span class="nv">$preu</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span><span class="nv">$pIva</span> <span class="o">=</span> <span class="nx">preuAmbIva</span><span class="p">(</span><span class="nv">$preu</span><span class="p">);</span>
</code></pre></div>
<ul>
<li>Pot haver-hi més d'un paràmetre amb valor per defecte, però sempre han d'estar al final.</li>
</ul>
<h3 id="02-phpbasics-pas-de-parametres-per-referencia">Pas de paràmetres per referència</h3>
<p>Per defecte els paràmetres es passen per valor. Per a passar un paràmetre per referència afegirem el símbol <strong>&amp;</strong> davant del seu nom.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">function</span> <span class="nf">preuAmbIva</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$preu</span><span class="p">,</span> <span class="nv">$iva</span><span class="o">=</span><span class="mf">0.18</span><span class="p">){</span>
<span class="linenos" data-linenos="2 "></span>    <span class="nv">$preu</span> <span class="o">*=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nv">$iva</span><span class="p">);</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
<h4 id="02-phpbasics-declaracions-de-tipus-type-hinting">Declaracions de tipus (Type Hinting)</h4>
<p>Les funcions obliguen a que els paràmetres siguen de cert tipus. Si el valor donat és d'un tipus incorrecte, es generarà un error. Per això s'ha d'anteposar-se el nom del tipus al nom del paràmetre. Es pot fer que una declaració accepte valors <strong>NULL</strong> si el valor predeterminat del
paràmetre s'estableix a NULL.</p>
<h4 id="02-phpbasics-tipus-valids">Tipus vàlids</h4>
<table>
<thead>
<tr>
<th align="center">Type</th>
<th align="center">Description</th>
<th align="center">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Class/interface name</td>
<td align="center">The value must be an instanceof the given class or interface.</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">self</td>
<td align="center">The value must be an instanceof the same class as the one in which the type declaration is used. Can only be used in classes.</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">parent</td>
<td align="center">The value must be an instanceof the parent of the class in which the type declaration is used. Can only be used in classes.</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">array</td>
<td align="center">The value must be an array.</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">callable</td>
<td align="center">The value must be a valid callable. Cannot be used as a class property type declaration.</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">bool</td>
<td align="center">The value must be a boolean value.</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">float</td>
<td align="center">The value must be a floating point number.</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">int</td>
<td align="center">The value must be an integer.</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">string</td>
<td align="center">The value must be a string.</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">iterable</td>
<td align="center">The value must be either an array or an instanceof Traversable.</td>
<td align="center">PHP 7.1.0</td>
</tr>
<tr>
<td align="center">object</td>
<td align="center">The value must be an object.</td>
<td align="center">PHP 7.2.0</td>
</tr>
<tr>
<td align="center">mixed</td>
<td align="center">The value can be any value.</td>
<td align="center">PHP 8.0.0</td>
</tr>
</tbody>
</table>
<h4 id="02-phpbasics-exemple">Exemple</h4>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">function</span> <span class="nf">suma</span><span class="p">(</span><span class="nx">int</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">int</span> <span class="nx">b</span><span class="p">)</span><span class="o">:</span><span class="nx">int</span>
<span class="linenos" data-linenos="2 "></span><span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">return</span> <span class="nv">$a</span> <span class="o">+</span> <span class="nv">$b</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span>
<span class="linenos" data-linenos="5 "></span><span class="nv">$resultado</span> <span class="o">=</span> <span class="nx">suma</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
</code></pre></div>
<h4 id="02-phpbasics-funcions-com-a-parametres">Funcions com a paràmetres</h4>
<p>En PHP és possible passar funcions com a paràmetres a altres funcions. Només cal passar el nom de la funció entre cometes. 
Exemple:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span> <span class="k">function</span> <span class="nf">calculator</span><span class="p">(</span><span class="nv">$operation</span><span class="p">,</span><span class="nv">$numA</span><span class="p">,</span><span class="nv">$numB</span><span class="p">){</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">return</span> <span class="nv">$operation</span><span class="p">(</span><span class="nv">$numA</span><span class="p">,</span><span class="nv">$numB</span><span class="p">);</span> 
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
<span class="linenos" data-linenos="4 "></span><span class="k">function</span> <span class="nf">sumar</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span><span class="nv">$b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$a</span><span class="o">+</span><span class="nv">$b</span><span class="p">;</span> <span class="p">}</span>
<span class="linenos" data-linenos="5 "></span><span class="k">function</span> <span class="nf">restar</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span><span class="nv">$b</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$a</span><span class="o">-</span><span class="nv">$b</span><span class="p">;</span> <span class="p">}</span>
<span class="linenos" data-linenos="6 "></span>
<span class="linenos" data-linenos="7 "></span><span class="nv">$a</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span><span class="nv">$b</span><span class="o">=</span><span class="mi">6</span><span class="p">;</span>
<span class="linenos" data-linenos="8 "></span><span class="k">echo</span> <span class="nx">calculator</span><span class="p">(</span><span class="s1">&#39;sumar&#39;</span><span class="p">,</span><span class="nv">$a</span><span class="p">,</span><span class="nv">$b</span><span class="p">);</span>
<span class="linenos" data-linenos="9 "></span><span class="k">echo</span> <span class="nx">calculator</span><span class="p">(</span><span class="s1">&#39;restar&#39;</span><span class="p">,</span><span class="nv">$a</span><span class="p">,</span><span class="nv">$b</span><span class="p">);</span>
</code></pre></div>
<h4 id="02-phpbasics-funcions-anonimes-closures">Funcions anònimes (<strong>closures</strong>)</h4>
<ul>
<li>Estan implementades usant la classe <strong>Closure</strong></li>
<li>Permeten la creació de funcions que no tenen un nom específic</li>
<li>Podem assignar la funció a una variable o passar-la com a paràmetre a una altra funció.</li>
<li>Exemple</li>
</ul>
<p>Sense paràmetres:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$anonima</span> <span class="o">=</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">echo</span> <span class="s2">&quot;Hola&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="3 "></span><span class="p">};</span> 
<span class="linenos" data-linenos="4 "></span><span class="nv">$anonima</span><span class="p">();</span>
</code></pre></div>
<p>Amb paràmetres:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$anonima</span> <span class="o">=</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$nom</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">echo</span> <span class="s2">&quot;Hola </span><span class="si">{</span><span class="nv">$nom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="3 "></span><span class="p">};</span> 
<span class="linenos" data-linenos="4 "></span><span class="nv">$anonima</span><span class="p">(</span><span class="s1">&#39;Vicent&#39;</span><span class="p">);</span>
</code></pre></div>
<h4 id="02-phpbasics-usar-variables-de-lambit-superior">Usar variables de l'àmbit superior</h4>
<ul>
<li>Una funció anònima pot usar variables de l'àmbit superior mitjançant la paraula reservada <strong>use</strong>: </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">function</span> <span class="nf">saluda</span><span class="p">(</span><span class="nx">callable</span> <span class="nv">$fnSaluda</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="nv">$fnSaluda</span><span class="p">(</span><span class="s1">&#39;Vicent&#39;</span><span class="p">);</span> 
<span class="linenos" data-linenos="3 "></span><span class="p">}</span> 
<span class="linenos" data-linenos="4 "></span><span class="nv">$salutacio</span> <span class="o">=</span> <span class="s1">&#39;Hola&#39;</span><span class="p">;</span> 
<span class="linenos" data-linenos="5 "></span><span class="nv">$anonima</span> <span class="o">=</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$nom</span><span class="p">)</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$salutacio</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="6 "></span>    <span class="k">echo</span> <span class="s2">&quot;</span><span class="si">{</span><span class="nv">$salutacio</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nv">$nom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="7 "></span><span class="p">};</span> 
<span class="linenos" data-linenos="8 "></span><span class="nx">saluda</span><span class="p">(</span><span class="nv">$anonima</span><span class="p">);</span>
</code></pre></div>
<h4 id="02-phpbasics-llibreries">Llibreries</h4>
<p>Podem fer llibreries de funcions guardant-les en un fitxer que desprès importem des d'on les utilitzem. Ho podem fer amb include, o utilitzant composer per a fer-ho.</p>
<h2 id="02-phpbasics-noves-caracterisques-php-7">Noves caracterísques PHP 7</h2>
<h3 id="02-phpbasics-spaceship-operator">Spaceship operator  (&lt;==&gt;)</h3>
<p>Compara dues expressions $a i $b i torna -1 si $a és menor que $b, 0 si són iguals i 1 si $b és major que $a.</p>
<p>Exemple:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">// Integers</span>
<span class="linenos" data-linenos="2 "></span><span class="k">echo</span> <span class="mi">1</span> <span class="o">&lt;=&gt;</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// 0</span>
<span class="linenos" data-linenos="3 "></span><span class="k">echo</span> <span class="mi">1</span> <span class="o">&lt;=&gt;</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// -1</span>
<span class="linenos" data-linenos="4 "></span><span class="k">echo</span> <span class="mi">2</span> <span class="o">&lt;=&gt;</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// 1</span>
</code></pre></div>
<h3 id="02-phpbasics-operador-de-fusio-de-null">Operador de fusió de null ??</h3>
<p>Torna el primer operand si existeix i no és NULL o el segon operand.</p>
<p>Exemple:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">// Fetches the value of $_GET[&#39;user&#39;] and returns &#39;nobody&#39;</span>
<span class="linenos" data-linenos="2 "></span><span class="c1">// if it does not exist.</span>
<span class="linenos" data-linenos="3 "></span><span class="nv">$username</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span><span class="o">??</span><span class="s1">&#39;nobody&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>
<span class="linenos" data-linenos="5 "></span><span class="c1">// This is equivalent to:</span>
<span class="linenos" data-linenos="6 "></span><span class="nv">$username</span> <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;nobody&#39;</span><span class="p">;</span>
</code></pre></div>
<p><strong>Més recursos:</strong></p>
<ul>
<li><a href="https://www.php.net/manual/es/migration70.new-features.php">Noves característiques PHP 7.0</a></li>
<li><a href="https://www.php.net/manual/es/migration71.new-features.php">Noves característiques PHP 7.1</a></li>
<li><a href="https://www.php.net/manual/es/migration72.new-features.php">Noves característiques PHP 7.2</a></li>
<li><a href="https://www.php.net/manual/es/migration73.new-features.php">Noves característiques PHP 7.3</a></li>
<li><a href="https://www.php.net/manual/es/migration74.new-features.php">Noves característiques PHP 7.4</a></li>
<li><a href="https://www.php.net/manual/es/migration80.new-features.php">Noves característiques PHP 8.0</a></li>
</ul>
<h2 id="02-phpbasics-processament-de-formularis">Processament de formularis</h2>
<h3 id="02-phpbasics-que-es-una-peticio-http">Què és una petició HTTP?</h3>
<p>Una petició HTTP és una sol·licitud d'un recurs a un servidor. La petició es realitza a través d'una URL. Amb la petició s'envien també paràmetres.</p>
<p>Hi ha diferents mètodes (METHOD) per a realitzar una petició (GET, POST, PUT, DELETE, PATCH, etc.). Els més habituals són GET i POST. La resta són més utilitzats en les RESTful API.</p>
<p><img alt="Sol·licitud HTTP" src="../assets/http-request.png" /></p>
<h3 id="02-phpbasics-metode-get">Mètode GET</h3>
<p>El mètodo de sol·licitud GET té les següents característiques:</p>
<ul>
<li>S'utilitza per a sol·licitar dades d'un recurs. Mostren els paràmetres que </li>
<li>s'envien en la url. Es poden utilitzar directament en enllaços. </li>
<li>El resultat es pot emmagatzemar en cache. Romanen en l'historial del navegador. </li>
<li>La grandària dels paràmetres està limitat a 2048 caràcters.</li>
</ul>
<p><em>Exemple de petició GET</em>
<img alt="Petició GET" src="../assets/get-example.png" /></p>
<p><em>Inspecció de la petició</em>
<img alt="Inspecció del petició GET: Capçaleres" src="../assets/get-inspect-headers.png" /></p>
<p><em>Inspecció de la petició</em>
<img alt="Inspecció del petició GET: Paràmeters" src="../assets/get-inspect-parameters.png" /></p>
<h4 id="02-phpbasics-accedir-a-les-dades-de-la-peticio-get">Accedir a les dades de la petició GET</h4>
<p>Per a accedir a les dades usem la variable superglobal <code>$_GET</code>.</p>
<p><code>$_GET</code> és un array associatiu les claus del qual coincidiran amb els noms que li hem donat als paràmetres.</p>
<p>Per a accedir als paràmetres de la petició anterior:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">echo</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;nom&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cognom&#39;</span><span class="p">];</span> <span class="c1">// Homer Simpson</span>
</code></pre></div>
<h4 id="02-phpbasics-metode-post">Mètode POST</h4>
<p>El mètode POST té les següents característiques:</p>
<ul>
<li>S'utilitza per a enviar dades a un recurs.</li>
<li>Els paràmetres van en el cos de la petició, no són visibles per a l'usuari.</li>
<li>La petició no es guarda en cache.</li>
<li>No es pot utilitzar en un enllaç.</li>
<li>No roman en l'historial.</li>
<li>No tenim la limitació de grandària dels paràmetres.</li>
<li>Es solen utilitzar en els formularis.</li>
</ul>
<h5 id="02-phpbasics-evitar-el-csrf">Evitar el CSRF</h5>
<p>En tota pàgina que reba paràmetres POST has de comprovar el <strong>HTTP referer</strong> del navegador, i que aquest siga de dins de la teua web. En PHP el referer que envia el navegador s'emmagatzema en <code>$_SERVER['HTTP_REFERER']</code>. És a dir, sols processarem peticions 
que vinguen del teu lloc web.</p>
<div class="admonition note">
<p class="admonition-title">Més informació</p>
<p>En el següent enllaç trobareu més informació relativa als atacs CSRF <a href="https://www.ionos.es/digitalguide/servidores/seguridad/cross-site-request-forgery/">CSRF: explicación del ataque Cross Site Request Forgery</a></p>
</div>
<p>Seria tal com:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">if</span><span class="p">(</span><span class="nb">parse_url</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_REFERER&#39;</span><span class="p">],</span> <span class="nx">PHP_URL_HOST</span><span class="p">)</span><span class="o">!=</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> 
<span class="linenos" data-linenos="2 "></span>   <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Anti-CSRF&#39;</span><span class="p">);</span> 
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Amb aquest codi estem obligant que el navegador envie un <em>referer</em> si o sí. Per tant només ha d'utilitzar-se en pàgines a les quals el navegador accedisca des d'una altra pàgina de la nostra web.</p>
<p>Òbviament no podem col·locar-ho en la primera pàgina a la qual s'accedeix a la nostra web (<code>index.php</code> o similar), ja que si l'usuari a escrit l'adreça a mà en la barra del navegador no s'enviarà referer cap i saltarà el sistema.</p>
</div>
<h3 id="02-phpbasics-definicio-de-formularis">Definició de formularis</h3>
<p>Com hem dit abans el mètode POST s'empra en els formularis. El formulari següent enviarà les dades a la pàgina <code>index.php</code> (atribut <code>action</code> de l'element <code>form</code>).</p>
<p>Utilitza el mètode <code>post</code> indicat en l'atribut <code>method</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;index.php&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="2 "></span>    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;nom&quot;</span><span class="p">&gt;</span>Nom<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="3 "></span>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;nom&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="4 "></span>    <span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
<span class="linenos" data-linenos="5 "></span>    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;cognom&quot;</span><span class="p">&gt;</span>Cognom<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="6 "></span>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;cognom&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="7 "></span>    <span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
<span class="linenos" data-linenos="8 "></span>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;Enviar&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="9 "></span><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</code></pre></div>
<p><em>Inspecció de la petició: Headers</em>
<img alt="Inspecció del petició POST" src="../assets/post-inspect-headers.png" /></p>
<p><em>Inspecció de la petició: Paramètres</em>
<img alt="Inspecció del petició POST" src="../assets/post-inspect-parameters.png" /></p>
<h3 id="02-phpbasics-accedir-a-les-dades-de-la-peticio-post">Accedir a les dades de la petició POST</h3>
<p>Usem la variable superglobal <code>$_POST</code>. Funciona igual que <code>$_GET</code>, però amb els noms (atribut <code>name</code>) que li hem donat als camps del formulari.</p>
<p>En depuració podem mostar totes les dades rebudes:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nb">var_dump</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
<span class="linenos" data-linenos="2 "></span><span class="nb">print_r</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">)</span>
</code></pre></div>
<p>Per a mostrar les dades individualment:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">echo</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;nom&#39;</span><span class="p">];</span>
<span class="linenos" data-linenos="2 "></span><span class="k">echo</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;cognom&#39;</span><span class="p">];</span>
</code></pre></div>
<h4 id="02-phpbasics-accedir-a-parametres-no-existents">Accedir a paràmetres no existents</h4>
<p>Errors del tipus  </p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Notice: Undefined index: nom in /home/ubuntu/index.php on line 6
</code></pre></div>
ens indiquen que la clau <code>nom</code>  no existeix en l'array <code>$_POST</code>. La variable supergloblal <code>$_POST</code> està buida si no s'ha
enviat el formulari.</p>
<p>Per a evitar aquest tipus d'errors és important verificar que s'haja enviat el formulari prèviament:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">if</span> <span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_METHOD&#39;</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;POST&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="2 "></span><span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="02-phpbasics-validacio-de-formularis">Validació de formularis</h3>
<p>Hem de comprovar que les dades que envia el formulari són correctes.</p>
<p>Les validacions a realitzar són les següents:</p>
<ol>
<li>Els camps requerits no han de quedar buits. Ni contenir espais en blanc a l'inici i al final.</li>
<li>Els camps email i data han de tenir el format esperat.</li>
<li>Tots els camps s'han de filtrar amb <code>htmlspecialchars</code> per a evitar atacs de <em>Cross-site Scripting</em> (XSS).</li>
</ol>
<p>Aquest article sobre <em>Cross-site Scripting</em> és molt il·lustratiu: <a href="https://www.w3schools.com/php/php_form_validation.asp">PHP Form Validation</a></p>
<h4 id="02-phpbasics-valors-buits">Valors buits</h4>
<ol>
<li>Els camps requerits no deurien quedar-se buits.</li>
<li>Per a verificar que un valor no queda buit podem utilitzar la funció <code>empty()</code> de PHP.</li>
</ol>
<h4 id="02-phpbasics-espais-en-blanc">Espais en blanc</h4>
<ol>
<li>Hem d'eliminar els espais en blanc del principi i final dels camps.</li>
<li>S'utilitza la funció <code>trim</code></li>
</ol>
<h4 id="02-phpbasics-escapar-lentrada">Escapar l'entrada</h4>
<p>Sempre hem de filtrar l'entrada amb <code>htmlspecialchars</code> abans de mostrar el camp amb <code>echo</code> o similar. Acò convertirà
qualsevol caràcter especial d'html en la entitat corresponent, així no interferirà en el el programa.</p>
<h4 id="02-phpbasics-comprovar-lemail">Comprovar l'email</h4>
<p>Per a verificar si un email és correcte podem utilitzar la funció <code>filter_var</code> </p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nb">filter_var</span><span class="p">(</span><span class="nv">$email</span><span class="p">,</span> <span class="nx">FILTER_VALIDATE_EMAIL</span><span class="p">)</span>
</code></pre></div>
o la funció <code>filter_input</code> quan obtenin les dades directament d'una variable extern.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">// suposem que rebem les dades d&#39;un formulari que té un quadre de text de nom &#39;email&#39;</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$email</span> <span class="o">=</span> <span class="nb">filter_input</span><span class="p">(</span><span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="nx">FILTER_VALIDATE_EMAIL</span><span class="p">)</span>
</code></pre></div>
<h4 id="02-phpbasics-filter_input">filter_input</h4>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nb">filter_input</span><span class="p">(</span><span class="nx">int</span> <span class="nv">$type</span><span class="p">,</span> <span class="nx">string</span> <span class="nv">$variable_name</span><span class="p">[,</span> <span class="nx">int</span> <span class="nv">$filter</span><span class="o">=</span><span class="nx">FILTER_DEFAULT</span><span class="p">[,</span> <span class="nx">mixed</span> <span class="nv">$options</span><span class="p">]])</span><span class="o">:</span><span class="nx">mixed</span>
</code></pre></div>
La funció <code>filter_input</code> agafa una variable externa (<code>$_GET</code>, <code>$_POST</code>, etc) concreta pel seu nom i aplica el filtre indicat.</p>
<p>Els filtres poden <a href="https://www.php.net/manual/es/filter.filters.validate.php">sanejar</a> o <a href="https://www.php.net/manual/es/filter.filters.sanitize.php">validar</a> les variables externes.</p>
<p>Per exemple, si volem agafar el valor del paràmetre <em>nom</em>  del querystring (<code>http://localhost/index.php?nom=&lt;h1&gt;Homer&lt;/h1&gt;</code>) usarem el tipus <code>INPUT_GET</code>.</p>
<p>El filtre <code>FILTER_SANITIZE_STRING</code> elimina etiquetes, i opcionalment elimina o codifica caracters especials.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$nom</span> <span class="o">=</span> <span class="nb">filter_input</span><span class="p">(</span><span class="nx">INPUT_GET</span><span class="p">,</span> <span class="s1">&#39;nom&#39;</span><span class="p">,</span> <span class="nx">FILTER_SANITIZE_STRING</span><span class="p">)</span><span class="o">.</span>  <span class="c1">// $nom = Homer</span>
</code></pre></div>
<p>Més informació en:</p>
<ul>
<li><a href="http://php.net/manual/es/function.filter-var.php">filter_var</a></li>
<li><a href="http://php.net/manual/es/function.filter-input.php">filter_input</a></li>
</ul>
<h3 id="02-phpbasics-comprovar-la-data">Comprovar la data</h3>
<ul>
<li>Per a comprovar la data hem de crear una funció a aquest efecte.</li>
<li>Podem utilitzar el mètode estàtic <code>createFromFormat</code> de la classe <code>DateTime</code></li>
</ul>
<p>Més informació: <a href="http://php.net/manual/es/datetime.createfromformat.php">http://php.net/manual/es/datetime.createfromformat.php</a></p>
<h4 id="02-phpbasics-exemple_1">Exemple</h4>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$data1</span> <span class="o">=</span> <span class="s2">&quot;2001-05-02&quot;</span><span class="p">;</span> <span class="c1">// Data és de tipus string</span>
<span class="linenos" data-linenos="2 "></span><span class="c1">// DateTime::createFromFormat converteix una cadena de text a on objecte DateTime</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">// ens tornarà una instància de DateTime o FALSE en cas d&#39;error.</span>
<span class="linenos" data-linenos="4 "></span>
<span class="linenos" data-linenos="5 "></span><span class="nv">$dt1</span> <span class="o">=</span> <span class="nx">DateTime</span><span class="o">::</span><span class="na">createFromFormat</span><span class="p">(</span><span class="s1">&#39;Y-m-d&#39;</span><span class="p">,</span> <span class="nv">$data1</span><span class="p">);</span>  
<span class="linenos" data-linenos="6 "></span>
<span class="linenos" data-linenos="7 "></span><span class="k">if</span> <span class="p">(</span><span class="nv">$dt1</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="8 "></span>    <span class="k">echo</span> <span class="s2">&quot;La data d&#39;inici és incorrecta&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="9 "></span><span class="p">}</span>
</code></pre></div>
<p>https://www.php.net/manual/es/function.strtotime.php</p>
<p>També és habitual trobar els controls de data separats en 3 elements input. Un per a l’any, l’altre per a mes i l’altre per al dia.</p>
<h3 id="02-phpbasics-bones-practiques-en-lobtencio-de-dades-des-de-lexterior">Bones pràctiques en l’obtenció de dades des de l’exterior</h3>
<p>Cal seguir les següents bones pràctiques:</p>
<ol>
<li>No confieu mai (mai) en l’entrada des de l’exterior del vostre PHP.</li>
<li>Sanegeu i valideu l’entrada de dades sempre.</li>
<li>Les funcions <code>filter_var()</code> i <code>filter_input()</code> poden sanejar el text i validar els formats de text (per exemple, adreces de correu electrònic, enters).</li>
<li>Recordeu que l’entrada de dades no es limita a formularis enviats per l’usuari. Els fitxers carregats i descarregats, els valors de sessió, les dades de galetes i les dades de serveis web de tercers també són dades que venen de l'exterior.</li>
</ol>
<p>A mode de resum podíem resumir la gestió de formularis en el següent diagrama de flux.</p>
<p><img alt="Form handle" src="../assets/form-handle.png" /></p>
<p>En els següents recursos trobaràs informació addicional sobre els controls de formularis en HTML5:</p>
<ul>
<li><a href="https://developer.mozilla.org/es/docs/Learn/HTML/Forms">Formularios en HTML</a> en MDN web docs.</li>
<li><a href="https://developer.mozilla.org/es/docs/HTML/HTML5/Forms_in_HTML5">Formularios en HTML5</a> en MDN web docs.</li>
<li><a href="https://www.w3schools.com/html/html_forms.asp">HTML Forms</a> en W3CSchools.</li>
</ul>
<h2 id="02-phpbasics-sentencies-per-a-incloure-fitxers">Sentències per a incloure Fitxers</h2>
<p>Les sentències <code>include()</code> i <code>include_once()</code> i <code>require()</code> i <code>require_once()</code> inclouen i avaluen el fitxeru especificat. </p>
<p><code>include_once()</code> i <code>require_once()</code> a més verifique que el fitxer no haja sigut inclòs abans i és preferible a <code>include</code>. Cal ser curòs amb el <code>path</code> de l'arxiu a incloure. </p>
<p>La diferència entre <code>require</code> i <code>include</code> és el tractament de l'error quan el fitxer no existeix. Mentre <code>include</code> mostra un avís, <code>require</code> mostra una error fatal que para l'execució de l'script.</p>
<h3 id="02-phpbasics-ambit-de-les-variables_1">Àmbit de les variables</h3>
<p>Com s'observa en l'exemple següent, les variables creades abans de cridar l'include, estaran disponibles en el fitxer inclòs. 
És a dir, com si tot fora un únic document.</p>
<div class="tabbed-set" data-tabs="3:1"><input checked="checked" id="02-phpbasics-__tabbed_3_1" name="02-phpbasics-__tabbed_3" type="radio" /><label for="02-phpbasics-__tabbed_3_1">fruits.php</label><div class="tabbed-content"></div>
</div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="o">&lt;?</span><span class="nx">php</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="nv">$fruit</span> <span class="o">=</span> <span class="s1">&#39;apple&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="k">include</span> <span class="s1">&#39;fruit.view.php&#39;</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="4:1"><input checked="checked" id="02-phpbasics-__tabbed_4_1" name="02-phpbasics-__tabbed_4" type="radio" /><label for="02-phpbasics-__tabbed_4_1">fruits.view.php</label><div class="tabbed-content"></div>
</div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Fruites<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 7 "></span>        <span class="cp">&lt;?</span><span class="o">=</span> <span class="s2">&quot;A </span><span class="si">$color</span><span class="s2"> </span><span class="si">$fruit</span><span class="s2">&quot;</span> <span class="cp">?&gt;</span> 
<span class="linenos" data-linenos=" 8 "></span>    <span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>       
<span class="linenos" data-linenos=" 9 "></span><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="10 "></span><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="02-phpbasics-rutes">Rutes</h3>
<p>En l'exemple anterior <code>include "fruit.view.php"</code> la ruta s'especifica de forma relativa, és a dir, la ruta es calcularà a 
partir de l'execució del fitxer principal. A mesura que les aplicacions van creixent aquest tipus de rutes acaben sent un mal de cap.
Per això és recomanable escriure les inclusions de forma relativa però fixant prèviament el directori actual.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>require __DIR__ . &#39;/fruits.view.php&#39;;
</code></pre></div>
<h2 id="02-phpbasics-pujada-de-fitxers">Pujada de fitxers</h2>
<p>Per a pujar fitxers PHP implementa un mecanisme senzill a través de la variable superglobal <code>$_FILES</code>.</p>
<p>En <a href="https://www.php.net/manual/es/features.file-upload.php">Pujada d'arxius</a> disposeu de tota la informació necessària per a gestionar la pujada d'arxius.</p>
<h3 id="02-phpbasics-formulari">Formulari</h3>
<p>Per poder utilitzar el tipus <code>file</code> en l'element <code>input</code> cal que el formulari incloga l'atribut <code>enctype</code> amb el valor <code>multipart/form-data</code>. </p>
<p>El valor de l'atribut <code>name</code> de l'element <code>input</code> serà l'índex de l'array associatiu <code>$_FILES</code> que ens permetrà obtenir tota la informació del procés de pujada del fitxer.</p>
<p>En el següent exemple:</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;upload.php&quot;</span> <span class="na">enctype</span><span class="o">=</span><span class="s">&quot;multipart/form-data&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="2 "></span>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;MAX_FILE_SIZE&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;10240&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="3 "></span>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;file&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;image&quot;</span> <span class="p">/&gt;</span>
<span class="linenos" data-linenos="4 "></span>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;Upload&quot;</span> <span class="p">/&gt;</span>
<span class="linenos" data-linenos="5 "></span><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</code></pre></div>
Emprarem <code>$_FILES['image']</code> per obtenir les dades de l'arxiu penjat.</p>
<h3 id="02-phpbasics-variable-superglobal-_files">Variable superglobal <code>$_FILES</code></h3>
<p>Cada element en <code>$_FILES</code> és un array que aporta informació sobre el fitxer pujat. Les claus més importants són:</p>
<ul>
<li><code>name</code>. El nom original del fitxer pujat. No és massa útil perquè el sistema original pot tindre convencions diferents i pot generar col·lisions si l'utilitzem per a emmagatzemar-lo en la seua ubicació definitiva.</li>
<li><code>type</code>. El tipus MIME del fitxer deduït pel navegador.</li>
<li><code>size</code>. La grandària en bytes del fitxer. Si el fitxer és massa gran el valor enviat serà 0.</li>
<li><code>tmp_name</code>. El nom temporal del fitxer en el servidor on s'ha emmagatzemat el fitxer pujat. </li>
</ul>
<h3 id="02-phpbasics-moure-el-fitxer">Moure el fitxer</h3>
<p>Com que el fitxer pujat es guarda en una carpeta temporal hem d'emprar la funció <a href="https://www.php.net/manual/es/function.move-uploaded-file.php"><code>move_uploaded_file</code></a> per a guardar-lo en la ubicació definitiva. </p>
<p>La funció <a href="https://www.php.net/manual/es/function.is-uploaded-file.php"><code>is_uploaded_file</code></a> ens permet a assegurar-nos que el fitxer ha estat pujat usant HTTP POST i no es tracta d'un fitxer maliciós.</p>
<p><code>move_uploaded_file</code> ja fa eixa comprovació en executar-se.</p>
<h3 id="02-phpbasics-gestio-derrors">Gestió d'errors</h3>
<p>PHP torna un codi d'error en <code>$_FILES</code>. El codi es pot trabar en la clau <code>error</code>. Per exemple: <code>$_FILES['image']['error']</code>. </p>
<p>Els missates d'error més importants són:</p>
<ul>
<li><code>UPLOAD_ERR_OK</code>: La pujada ha sigut correcta.</li>
<li><code>UPLOAD_ERR_INI_SIZE</code>: La grandària del fitxer que s'intenta pujar és major que el valor indicat en la directiva <code>upload_max_filesize</code>.</li>
<li><code>UPLOAD_ERR_FORM_SIZE</code>: La grandària del fitxer que s'intenta pujar és major que el valor indicat en el formulari en <code>max_file_size</code>. </li>
<li><code>UPLOAD_ERR_NO_FILE</code>: No s'ha enviat cap fitxer.</li>
</ul>
<p>En <a href="https://www.php.net/manual/es/features.file-upload.errors.php">Explicació dels missatges d'error</a> teniu més informació.</p>
<h2 id="02-phpbasics-activitats">Activitats</h2>
<h3 id="02-phpbasics-cadenes">Cadenes</h3>
<ol>
<li>
<p><code>221Cadenes.php</code>: Copia el contingut de la pàgina <code>index.php</code>, activa la directiva de tipus estricta (<code>declare( strict_types = 1 );</code>) i mostra el següent: </p>
<ol>
<li>Elimina els espais del principi i el final del nom si els hi haguera (<em>trim</em>). </li>
<li>Elimina la lletra a del principi i el final del nom si els hi haguera (<em>trim</em>). </li>
<li>Mostra la variable nom en majúscules, minúscules i amb la primera lletra en majúscula i les altres en minúscules (<em>strtoupper</em>, <em>strtolower</em>, <em>ucfirst</em>). </li>
<li>Mostra el codi ascii de la primera lletra del nom (<em>ord</em>). </li>
<li>Mostra la longitud del nom (<em>strlen</em>). </li>
<li>Mostra el nombre de vegades que apareix la lletra a (majúscula o minúscula, <em>substr_count</em>). </li>
<li>Mostra la posició de la primera <code>a</code> existent en el nom, siga majúscula o minúscula (<em>strpos</em>). Si no hi ha cap mostrarà -1. </li>
<li>El mateix, però amb l''última a. </li>
<li>Mostra el nom substituint la lletr o pel número zero, siga majúscula o minúscula (<em>str_replace</em>). </li>
<li>Indica si el nom comença per <code>al</code> o no. </li>
</ol>
</li>
<li>
<p><code>222Cadenes.php</code>: En el mateix document <code>cadenes.php</code> i a partir d'una variable que continga una url:<br />
    <div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$url</span><span class="o">=</span><span class="s1">&#39;http://username:password@hostname:9090/path?arg=value#anchor&#39;</span><span class="p">;</span>
</code></pre></div>
      Utilitza la funció <code>parse_url</code> per a extraure de la url les següents parts:<br />
        1. El protocol utilitzat (en l'exemple "http").<br />
        2. El nom d'usuari (en l'exemple "username").
        3. El path de la url (en l'exemple "/path").
        4. El querystring de la url (en l'exemple "arg=value").</p>
</li>
</ol>
<h3 id="02-phpbasics-arrays-indexats">Arrays indexats</h3>
<ol>
<li>
<p><code>231Arrays.php</code>: Crea una pàgina, copia el contingut de la pàgina <code>index.php</code> i resol els exercicis següents 
utilitzant funcions d'arrays:</p>
<ol>
<li>Crea un array amb els noms de diversos alumnes de la classe incloent el teu. </li>
<li>Mostra el nombre d'elements que té l'array (<em>count</em>). </li>
<li>Crea una cadena de text que continga els noms dels alumnes existents en l'array separats per un espai i 
mostra-la (<em>implode</em>).</li>
<li>Mostra l'array en un ordre aleatori diferent al que ho vas crear (<em>shuffle</em>). </li>
<li>Mostra l'array ordenat alfabèticament (<em>sort</em>). </li>
<li>Mostra els alumnes el nom dels quals continga almenys una “a” (<em>array_filter</em>).</li>
<li>Mostra l'array en l'ordre invers al que es va crear (<em>rsort</em>). </li>
<li>Mostra la posició que té el teu nom en l'array (<em>array_search</em>).</li>
</ol>
</li>
<li>
<p><code>232Ciutats.php</code>: Segons l'INE les 7 ciutats més grans d’Espanya (per habitants) el 2018 van ser les següents:</p>
<ul>
<li>Madrid, MAD, 3.223.334</li>
<li>Sevilla, AN  , 688.711</li>
<li>Murcia, MU,  447.182</li>
<li>Málaga, AN,  571.026</li>
<li>Zaragoza, AR, 666.880</li>
<li>València, CV,     791.413</li>
<li>Barcelona, CAT, 1.620.343</li>
</ul>
<p>Copia <code>index.php</code> i crea un nou document <code>cituats.php</code>. Defineix un array que continga aquesta informació sobre ciutats i 
habitants. Imprimeix una taula d'ubicacions i habitants que incloga la població total de les 7 ciutats.</p>
<p>Opcional:
Modifica la solució de l’anterior exercici perquè mostre les ciutats ordenades per habitants. Després mostra-les per ordre alfabètic.</p>
</li>
</ol>
<h3 id="02-phpbasics-arrays-multidimensionals_1">Arrays multidimensionals</h3>
<ol>
<li>
<p><code>233Alumnes.php</code>: Resol els exercicis següents utilitzant funcions d'arrays: </p>
<ol>
<li>Crea un array d'alumnes on cada element siga un altre array que continga nom i edat de l'alumne. </li>
<li>Crea una taula HTML en la qual es mostren totes les dades dels alumnes. </li>
<li>Utilitza la funció <code>array_column</code> per a obtenir un array indexat que continga únicament els noms dels alumnes i mostra’ls per pantalla.    </li>
<li>Crea un array amb 10 números i utilitza la funció <code>array_sum</code> per a obtenir la suma dels 10 nombres. </li>
<li>Sense usar bucles for calcula la mitjana d'edat de l'alumnat.     </li>
</ol>
</li>
<li>
<p><code>234CiutatsOpcional.php</code>: Modifica la solució del exercici <code>ciutats.php</code> perquè la taula continga també la columna del total d’habitants de la 
comunitat autònoma de les ciutats de la llista i el percentatge sobre els habitants de la comunitat autònoma que representa.</p>
<p>Per exemple: </p>
<table>
<thead>
<tr>
<th>Ciutat</th>
<th align="right">Habitants</th>
<th align="right">Habitats CA</th>
<th align="right">% sobre CA</th>
</tr>
</thead>
<tbody>
<tr>
<td>València</td>
<td align="right">791.413</td>
<td align="right">5.003.769</td>
<td align="right">15.81%</td>
</tr>
</tbody>
</table>
<p>Pista: Caldrà modificar l'array  <code>$ciutats</code> i convertir-lo en multidimensional. Les dades de comunitats autònomes hauran
d'estar en un altre array. </p>
<p>Dades: <a href="https://es.wikipedia.org/wiki/Anexo:Municipios_de_Espa%C3%B1a_por_poblaci%C3%B3n">Municipis de España</a></p>
</li>
</ol>
<h3 id="02-phpbasics-funcions_1">Funcions</h3>
<ol>
<li>
<p><code>241funcions.php</code>: Escriu una funció per retornar una etiqueta HTML <code>&lt;img /&gt;</code>. </p>
<p>La funció hauria d’acceptar com a argument obligatori l’URL de la imatge i arguments opcionals per a un text 
  alternatiu, alçada i amplada.</p>
</li>
<li>
<p><code>242funcions.php</code>: Copieu la funció de l’exercici anterior i modifiqueu-la de manera que només es passe el nom de fitxer a la funció en
lloc de l’URL completa. Dins de la funció, farem ús d’una variable global per fer l’URL completa.</p>
<p>Per exemple, si passem <code>photo.png</code> a la funció, i la variable global conté <code>/images</code>, llavors l’atribut <code>src</code> de 
  l'etiqueta <img> retornada serà <code>/images/photo.png</code>. </p>
<p>Una funció com aquesta és una forma senzilla de mantenir correctes les vostres etiquetes d’imatges, fins i tot si les
  imatges es mouen a un nou camí o servidor. Només cal canviar la variable global, per exemple, de <code>/images</code> a 
  <code>http://images.example.com/.</code></p>
</li>
<li>
<p><code>243funciocolors.php</code>:  Els colors web com <code>#ffffff</code> i <code>#cc3399</code> es realitzen concatenant els valors hexadecimals de color per a vermell, 
verd i blau. </p>
<p>Escriu una funció que accepte 3 arguments: roig, verd i blau, i que retorne un string que conté el color adequat per
  utilitzar-lo en una pàgina web. </p>
<p>Per exemple, si els arguments són 255, 0, i 255, llavors la cadena retornada hauria de ser #FF00FF.</p>
<p>Pot resultar útil utilitzeu la funció <code>dechex()</code> integrada, que es troba documentada a <a href="http://www.php.net/">http://www.php.net/</a></p>
<p>Assegureu-vos que els paràmetres reben valors enters i que són colors vàlids.</p>
<p>Implementa 3 exemples d’ús.</p>
</li>
<li>
<p><code>244funcionsSQL.php</code>: Crea una funció anomenada <code>insert</code>  que ens genere una sentència INSERT INTO en SQL.  </p>
<p>Per a açò la funció rebrà dos paràmetres:<br />
      1. El nom de la taula<br />
      2.   Un array associatiu que contindrà els noms i valors dels camps de la taula.</p>
<p>La sentència resultant tindrà la següent forma: </p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>“INSERT INTO nom_taula (nom dels camps separats per comes) 
<span class="linenos" data-linenos="2 "></span>  VALUES (noms dels camps separats per comes amb el caràcter “:” davant)  
</code></pre></div>
De moment, no farem res amb els valors dels camps. </p>
<p>Ajuda: utilitza les funcions <code>sprintf</code>, <code>implode</code> i <code>array_keys</code></p>
</li>
<li>
<p><code>245funcionsSQL2.php</code>: A partir de l'exercici anterior crea una altra funció que reba els mateixos paràmetres més un paràmetre booleà 
per a indicar si volem generar la query amb els noms dels camps o no. </p>
<p>El paràmetre tindrà el valor <code>true</code> per defecte.</p>
<p>Si el seu valor és <code>true</code> generarà la consulta igual que en l'exercici anterior, però si és <code>false</code> la generarà així: </p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">nom_taula</span> 
<span class="linenos" data-linenos="2 "></span>  <span class="k">VALUES</span> <span class="p">(</span><span class="n">valors</span> <span class="n">dels</span> <span class="n">camps</span> <span class="n">separats</span> <span class="n">per</span> <span class="n">comes</span> <span class="n">amb</span> <span class="n">el</span> <span class="n">caràcter</span> <span class="err">‘</span><span class="p">:</span><span class="err">’</span> <span class="n">davant</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p><code>246funcionsSQLReferencia.php</code>: Repeteix l'exercici anterior amb els següents canvis: </p>
<p>La cadena resultant es passarà per referència.</p>
<p>Passarem la cadena de la següent forma: </p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>  <span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">taula</span> <span class="p">(</span><span class="n">camps</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="n">valors</span><span class="p">)</span> 
</code></pre></div>
<p>Dins de la funció substituirem el següent: </p>
<ol>
<li>El text taula pel nom de la taula. </li>
<li>El text camps pels noms dels camps separats per comes</li>
<li>El text valors pels noms dels camps separats per comes i el caràcter ‘:’ davant. </li>
</ol>
</li>
</ol>
<h3 id="02-phpbasics-formularis">Formularis</h3>
<ol>
<li>
<p><code>261ExempleGet.php</code>: Crea una pàgina que reba com a paràmetre un nom i mostre el text ‘Benvingut [nom]!!!’ sent [nom] el nom has 
passat com a paràmetre.</p>
</li>
<li>
<p><code>262Formulari.php</code>: Crea un formulari que tinga els següents camps:</p>
<ul>
<li><code>firstname</code></li>
<li><code>lastname</code></li>
<li><code>phone</code></li>
<li><code>email</code></li>
</ul>
<p>En l'atribut <code>action</code> del formulari posarem el següent:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;262Formulari.php&quot;</span> <span class="err">...</span><span class="p">/&gt;</span>
</code></pre></div>
<p>Açò farà que siga la pròpia pàgina del formulari la que processe les dades del mateix.</p>
<p>En prémer <code>Enviar</code> han d'aparèixer sota el formulari les dades que s'han introduït en el mateix en format de 
taula.</p>
</li>
<li>
<p><code>263FormulariReparat.php</code>: Soluciona el problema dels paràmetres no enviats de l'exercici anterior.</p>
</li>
<li>
<p><code>264FormulariValidat.php</code>: Modifica l'exercici anterior realitzant les següents validacions:</p>
<ul>
<li>Tots els camps són obligatoris.</li>
<li><code>firstname</code>, no pot superar els 25 caracters.</li>
<li><code>lastname</code>, no pot superar els 50 caracters.</li>
<li><code>phone</code>, ha de contenir 9 digits (expressió regular: <code>^\d{9}$</code>).</li>
<li><code>email</code>, ha de ser una adreça electrònica correcta.</li>
</ul>
<p>S'avaluaran tots els camps i si hi ha error/s caldrà mostrar-lo/s. Si no hi ha errors es mostraran les dades introduïdes per l'usuari.</p>
</li>
<li>
<p><code>265FormulariOpcions.php</code>: Modifica l'exercici anterior afegint els següents camps al formulari:</p>
<ul>
<li><code>genre</code>: serà un <em>radio button</em> i podrà ser <em>home</em>, <em>dona</em> i <em>no binari</em>.</li>
<li><code>hobbies</code>: serà un checkbox amb aficions de la que podràs triar-ne més d'una:<ul>
<li>Lectura</li>
<li>Programació</li>
<li>Ciclisme</li>
<li>Running</li>
<li>...</li>
</ul>
</li>
<li><code>contact-time</code>: serà una llista de les millores hores per a contactar: <ul>
<li>Primera hora (08:00 a 10:00)</li>
<li>Abans de dinar (12:00 a 13:00)</li>
<li>Després de dinar (14:00 a 16:00)</li>
<li>Per la nit (20:00 a 22:00)</li>
</ul>
</li>
</ul>
<p>En els tres casos són obligatoris, s'ha de mantindre el valor en cas de ser correcte .</p>
</li>
<li>
<p><code>266FormulariArray</code>: Modifica l'exercici anterior de forma que el contingut dels camps de selecció es genere dinàmicament des d'arrays associatius. A més, els valors rebuts s'haurien de validar contra l'<em>array</em> i mostrar-se fent és d'ell.</p>
</li>
</ol>
<h3 id="02-phpbasics-inclusio-de-fitxers">Inclusió de fitxers</h3>
<ol>
<li>
<p><code>271Formulari.php</code>: Basant-te en l'activitat <code>264FormulariValidat.php</code> modifica les validacions perquè es facen mitjançant funcions. </p>
<p>Les funcions es guardaran en el fitxer <code>helpers.php</code> i s'hauran d'incloure en fitxer <code>271Formulari.php</code>.</p>
</li>
<li>
<p><code>272Formulari.php</code>: Basant-te en l'activitat <code>271Formulari.php</code> separa la part de codi de la presentació de forma que tota la lògica estiga en un fitxer i la part de presentació en altre fitxer <code>271Formulari.view.php</code>.</p>
</li>
</ol>
<h3 id="02-phpbasics-pujada-de-fitxers_1">Pujada de fitxers</h3>
<ol>
<li><code>281FormularImatge.php</code>: Modifica l'activitat <code>272Formulari.php</code> afegint un camp de tipus <code>FILE</code> per a pujar una imatge al servidor. Es guardarà en la carpeta <code>uploads</code> i es mostrarà amb la resta de dades. </li>
<li><code>282FormulariImage.php</code>: Modifica l'activitat anterior de forma que es controle el següent:<ol>
<li>Les imatges sols podran ser <code>jpg</code>.</li>
<li>No podran superar 1MB de grandària</li>
<li>Es guardaran en un nom aleatori únic.</li>
</ol>
</li>
</ol>
<h2 id="02-phpbasics-credits">Crèdits</h2>
<ul>
<li>Aitor Medrano. (setembre de 2021) <em>Desarrollo Web en Entorno Servidor</em> disponible en: <a href="https://aitor-medrano.github.io/dwes2122/index.html">https://aitor-medrano.github.io/dwes2122/index.html</a></li>
</ul></section>
                        <h1 class='nav-section-title' id='section-3-php-orientat-a-objectes'>
                            3.- PHP Orientat a Objectes <a class='headerlink' href='#section-3-php-orientat-a-objectes' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="03-phpoo-0301-phpoo-basic"><h1 id="03-phpoo-0301-phpoo-basic-poo-en-php-conceptes-basics">POO en PHP. Conceptes bàsics</h1>
<h2 id="03-phpoo-0301-phpoo-basic-introduccio">Introducció</h2>
<p>La programació orientada a objectes (OOP, per les seues sigles en
anglès) és un paradigma de programació.</p>
<p>Paradigma:</p>
<blockquote>
<p>Teoria […] el nucli central de la qual […] suministra la base i el
model per resoldre problemes i avançar en el coneixement.</p>
</blockquote>
<p>Per la qual cosa podem definir la programació orientada a objecte com
un mètode -provat i estudiat- el qual es basa en les interaccions
d'objectes per resoldre les necessitats d'un sistema informàtic.</p>
<p>Un objecte és una estructura que conté dades i el codi que els maneja.</p>
<p>L'estructura dels objectes es defineix en les classes. En elles s'escriu
el codi que defineix el comportament dels objectes i s'indiquen els
membres que formaran part dels objectes d'aquesta classe. Entre els
membres de una classe pot haver-hi:</p>
<ul>
<li><strong>Mètodes</strong>. Són els membres de la classe que contenen el codi de la
    mateixa. Un mètode és com una funció. Pot rebre paràmetres i
    retornar valors.</li>
<li><strong>Atributs o propietats</strong>. Emmagatzemen informació sobre el estat de
    l'objecte al que pertanyen (i per tant, el seu valor pot ser
    diferent per a cadascun dels objectes de la mateixa classe).</li>
</ul>
<p>A la creació de un objecte basat en una classe se li anomena instanciar
una classe i a l'objecte obtingut també se li coneix com a instància
d'aqueixa classe.</p>
<p>Els pilars fonamentals de la POO són:</p>
<ul>
<li><strong>Herència</strong>. És el procés de crear una classe a partir de una altra,
    heretant el seu comportament i característiques i podent
    redefinir-los.</li>
<li><strong>Abstracció</strong>. Fa referència al fet que cada classe oculta en el seu
    interior les peculiaritats de la seua implementació, i presenta a
    l'exterior una sèrie de mètodes (interfície) el comportament dels
    quals està ben definit. Vist des de l'exterior, cada objecte és un
    ens abstracte que realitza un treball.</li>
<li><strong>Polimorfisme</strong>. Un mateix mètode pot tenir comportaments diferents en
    funció de l'objecte amb que s'utilitze.</li>
<li><strong>Encapsulació</strong>. En la POO s'ajunten en un mateix lloc les dades i el
    codi que els manipula.</li>
</ul>
<p>Els avantatges més importants que aporta la programació orientada a
objectes són:</p>
<ul>
<li><strong>Modularitat</strong>. La POO permet dividir els programes en parts o
    mòduls més xicotets, que són independents uns d'uns altres però
    poden comunicar-se entre ells.</li>
<li><strong>Extensibilitat</strong>. Si es desitgen afegir noves característiques a
    una aplicació, la POO facilita aquesta tasca de dues formes: afegint
    nous mètodes al codi, o creant nous objectes que estenguen el
    comportament dels ja existents.</li>
<li><strong>Manteniment</strong>. Els programes desenvolupats utilitzant POO són més
    senzills de mantenir, a causa de la modularitat abans comentada.
    També ajuda seguir certes convencions en escriure'ls , per exemple,
    escriure cada classe en un fitxer propi. No ha d'haver-hi dues
    classes en un mateix fitxer, ni un altre codi a part de el propi de
    la classe.</li>
</ul>
<h2 id="03-phpoo-0301-phpoo-basic-caracteristiques-basiques-de-lus-dobjectes-en-php">Característiques bàsiques de l'ús d'objectes en PHP</h2>
<p>Segurament tot, o la majoria del que acabes de veure, ja ho coneixies,
i és fins i tot probable que sàpigues utilitzar algun llenguatge de
programació orientat a objectes, així que anem a veure directament les
peculiaritats pròpies de PHP en el que fa referència a la POO.</p>
<p>En PHP podemos utilitzar els dos paradigmes de la programació: estructurada i orientada a objectes.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span> <span class="c1">// utilitzant programació estructurada</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$dwes</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="s1">&#39;dwes&#39;</span><span class="p">,</span> <span class="s1">&#39;abc123.&#39;</span><span class="p">,</span> <span class="s1">&#39;dwes&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">// utilizant POO</span>
<span class="linenos" data-linenos="4 "></span><span class="nv">$dwes</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mysqli</span><span class="p">();</span>
<span class="linenos" data-linenos="5 "></span><span class="nv">$dwes</span><span class="o">-&gt;</span><span class="na">connect</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="s1">&#39;dwes&#39;</span><span class="p">,</span> <span class="s1">&#39;abc123.&#39;</span><span class="p">,</span> <span class="s1">&#39;dwes&#39;</span><span class="p">);</span>
</code></pre></div>
<p>No obstant açò, el llenguatge PHP original no es va dissenyar amb
característiques d'orientació a objectes. Només a partir de la versió 3,
es van començar a introduir alguns trets de POO en el llenguatge. Açò es
va potenciar en la versió 4, encara que encara de forma molt
rudimentària. Per exemple, en PHP4:</p>
<ul>
<li>Els objectes es passen sempre per valor, no per referència.</li>
<li>No es pot definir el nivell d'accés per als membres de la classe.
    Tots són públics.</li>
<li>No existeixen les interfícies.</li>
<li>No existeixen mètodes destructors.</li>
</ul>
<p>En PHP5 es va reescriure i potenciar el suport d'orientació a objectes del llenguatge, ampliant les seues
característiques i millorant el seu rendiment i el seu funcionament general. Les característiques de POO que 
suporta PHP5 inclouen:</p>
<ul>
<li>Mètodes estàtics.</li>
<li>Mètodes constructors i destructors.</li>
<li>Herència.</li>
<li>Interfícies.</li>
<li>Classes abstractes.</li>
</ul>
<p>Entre les característiques que no inclou PHP5, i que pots conèixer
d'altres llenguatges de programació, estan:</p>
<ul>
<li>Herència múltiple.</li>
<li>Sobrecàrrega de mètodes (tenir diversos mètodes amb el mateix nom,
    però amb funcionalitats diferents. Els mètodes sobrecarregats han de
    tenir diferents paràmetres. Quan es diu al mètode, s'utilitza una o
    una altra versió en funció dels paràmetres amb que es realitze la
    trucada (podent distingir per el seu nombre i per el seu tipus,
    segons el llenguatge de programació utilitzat)) (inclosos els
    mètodes constructors).</li>
<li>Sobrecàrrega d'operadors (similar a la sobrecàrrega de mètodes. Es
    poden definir diverses funcionalitats a un mateix operador, i
    s'utilitzarà una o una altra en funció del tipus dels operands que
    s'usen en cada instant).</li>
</ul>
<p>PHP 7 incorpora millores en el rendiment i el tipat d'arguments, valors de retorn i atributs (des de la versió 7.4)</p>
<h2 id="03-phpoo-0301-phpoo-basic-definicio-de-classes">Definició de classes</h2>
<p>La declaració de una classe en PHP es fa utilitzant la paraula <code>class</code>. A continuació i entre claus, han de 
figurar els membres de la classe.</p>
<p>Convé fer-ho de forma ordenada, primer les propietats o atributs, i
després els mètodes, cadascun amb el seu codi respectiu.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">private</span> <span class="nx">string</span> <span class="nv">$code</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">public</span> <span class="nx">string</span> <span class="nv">$name</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>    <span class="k">public</span> <span class="nx">float</span> <span class="nv">$price</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getSummaryLine</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
<span class="linenos" data-linenos="6 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">;</span>
<span class="linenos" data-linenos="7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
<p>En UML la classe anterior es representaria així:</p>
<div  class="mermaid">classDiagram
  class Product {
    -string code
    +string name
    +float price
    +string getSummaryLine()
  } 
</div>
<p>Com comentàvem abans, és preferible que cada classe figure en el seu
propi fitxer (<strong><code>Product.php</code></strong>). A més, molts programadors prefereixen
utilitzar per a les classes noms que comencen per lletra majúscula, per
a, d'aquesta forma, distingir-los dels objectes i altres variables.</p>
<p>Una vegada definida la classe, podem usar la paraula <strong><code>new</code></strong> per a
instanciar objectes de la següent forma:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$product</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Product</span><span class="p">();</span>
</code></pre></div>
<p>Perquè la línia anterior s'execute sense error, prèviament hem d'haver
declarat la classe. Per a açò, en aqueix mateix fitxer hauràs de
incloure la classe posant alguna cosa com:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">require</span><span class="p">(</span><span class="s1">&#39;Product.php&#39;</span><span class="p">);</span>
</code></pre></div>
<p>Els atributs de una classe són similars a les variables de PHP. És
possible indicar un valor en la declaració de la classe. En aquest cas,
tots els objectes que s'instancien a partir de aqueixa classe, partiran
amb aqueix valor per defecte en l'atribut.</p>
<p>Per a accedir des d'un objecte als seus atributs o als mètodes de
la classe, has d'utilitzar l'operador fletxa (fixa't que només es posa
el símbol $ davant del nom de l'objecte):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$product</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">=</span> <span class="s1">&#39;Samsung Galaxy S&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">echo</span> <span class="nv">$product</span><span class="o">-&gt;</span><span class="na">getSummaryLine</span><span class="p">();</span> 
</code></pre></div>
<h3 id="03-phpoo-0301-phpoo-basic-visibilitat">Visibilitat</h3>
<p>Quan es declara una propietat o un mètode, s'ha d'indicar el seu nivell d'accés (o visibilitat). Els
principals nivells són:</p>
<ul>
<li><code>public</code>. Els atributs declarats com <code>public</code> poden utilitzar-se
    directament per els objectes de la classe. És el cas de l'atribut
    <code>$name</code> anterior.</li>
<li><code>private</code>. Els atributs declarats com <code>private</code> només poden ser
    accedits i modificats per els mètodes definits en la classe, no
    directament per els objectes de la mateixa. És el cas de l'atribut
    <code>$code</code>.</li>
<li><code>protected</code>. Una propietat o mètode <code>protected</code> sols pot ser accedida per la classe on es defineix o per un subclasse. No és accessible des de fora.  </li>
</ul>
<p>Un dels motius per a crear atributs privats és que el seu valor forma
part de la informació interna de l'objecte i no ha de formar part de la
seua interfície. Un altre motiu és mantenir cert control sobre els seus
possibles valors. Per exemple, si no vols que es puga canviar lliurement
el valor del codi d'un producte. O necessites conèixer quin serà el nou
valor abans d'assignar-lo. En aquests casos, se solen definir aqueixos
atributs com a privats i a més es creen dins de la classe mètodes per a
permetre'ns obtenir i/o modificar els valors d'aqueixos atributs. Per
exemple:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">private</span> <span class="nx">string</span> <span class="nv">$code</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">setCode</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$newCode</span><span class="p">)</span><span class="o">:</span> <span class="nx">boolean</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">existsCode</span><span class="p">(</span><span class="nv">$newCode</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-linenos="4 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span> <span class="o">=</span> <span class="nv">$newCode</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span>        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="linenos" data-linenos="6 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="7 "></span>    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
<span class="linenos" data-linenos="9 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">getCode</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span><span class="p">;</span> <span class="p">}</span>
</code></pre></div>
<p>Encara que no és obligatori, el nom del mètode que ens permet obtenir el
valor de un atribut sol començar per <code>get</code>, i el que ens permet
modificar-lo per <code>set</code>.</p>
<h2 id="03-phpoo-0301-phpoo-basic-constructor">Constructor</h2>
<p>Com ja has vist, per a instanciar objectes de una classe s'utilitza la
paraula <code>new</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$product</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Product</span><span class="p">();</span>
</code></pre></div>
<p>En PHP7 pots definir en les classes mètodes constructors, que s'executen
quan es crea l'objecte.</p>
<p>El constructor d'una classe ha d'anomenar-se <code>__construct</code>. Es poden utilitzar, per exemple, 
per assignar valors a atributs.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">private</span> <span class="nx">string</span> <span class="nv">$code</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">public</span> <span class="nx">string</span> <span class="nv">$name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>    <span class="nx">…</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span>
</code></pre></div>
<p>El constructor d'una classe pot cridar a altres mètodes o tenir
paràmetres, en aquest cas hauran de passar-se quan es crea l'objecte.
No obstant açò, només pot haver-hi un mètode constructor en cada classe.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">private</span> <span class="nx">string</span> <span class="nv">$code</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">public</span> <span class="nx">string</span> <span class="nv">$name</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$code</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="5 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$code</span> <span class="o">=</span> <span class="nv">$code</span><span class="p">;</span>
<span class="linenos" data-linenos="6 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="7 "></span>    <span class="o">...</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
<span class="linenos" data-linenos="9 "></span><span class="nv">$product</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Product</span><span class="p">(</span><span class="s1">&#39;GALAXYS&#39;</span><span class="p">);</span>
</code></pre></div>
<p>Per exemple, si com en aquest exemple, definim un constructor en el qual
cal passar el codi, sempre que instancies un nou objecte d'aqueixa
classe hauràs de indicar el seu codi.</p>
<h2 id="03-phpoo-0301-phpoo-basic-la-pseuodovariable-this">La pseuodovariable $this</h2>
<p>Quan des d'un objecte s'invoca un mètode de la classe, a aquest se li
passa sempre una referència a l'objecte que ha fet la crida. Aquesta
referència s'emmagatzema en la pseudovariable <code>$this.</code> S'utilitza, per
exemple, en el codi anterior per a tenir accés als atributs privats de
l'objecte (que només són accessibles des dels mètodes de la classe).</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>echo &quot;<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>&quot; . $this-&gt;code . &quot;<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>&quot;;
</code></pre></div>
<p>En la documentació de PHP tens més informació sobre els mètodes màgics:
<a href="http://es.php.net/manual/es/language.oop5.magic.php">http://es.php.net/manual/es/language.oop5.magic.php</a></p>
<h2 id="03-phpoo-0301-phpoo-basic-constants-de-classe">Constants de classe</h2>
<p>A més de mètodes i propietats, en una classe també es poden definir constants, 
utilitzant la paraula <code>const</code>. És important que no confongues els atributs amb
les constants. Són conceptes diferents: les constants no poden canviar el seu 
valor (òbviament, d'ahí el seu nom), no usen el caràcter <code>$</code>, s'escriuen en 
majúscules (per convenció) i el seu valor està associat a la classe, és a dir, 
no existeix una còpia del mateix en cada objecte. </p>
<p>Per tant, per a accedir a les constants d'una classe, s'ha d'utilitzar el 
nom de la classe i l'operador <code>::</code>, anomenat operador de resolució d'àmbit 
(que s'utilitza per a accedir a els elements de una classe).</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">DB</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">const</span> <span class="no">USUARIO</span> <span class="o">=</span> <span class="s1">&#39;dwes&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>      <span class="o">...</span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span>
<span class="linenos" data-linenos="5 "></span><span class="k">echo</span> <span class="nx">DB</span><span class="o">::</span><span class="na">USUARIO</span><span class="p">;</span>
</code></pre></div>
<p>És important ressaltar que no és necessari que existisca cap objecte de
una classe per a poder accedir al valor de les constants que definisca.</p>
<div class="admonition important">
<p class="admonition-title">PHP-FIG</p>
<p>El PHP Framework Interop Group és un grup de treball on està involucrada gent que treballa en diferents <em>frameworks</em> amb
l'objectiu de posar en comú les tècniques que usen en els diferents projectes per poder integrar-les i compartir-les 
i poder treballar millor junts.</p>
</div>
<p>Les recomanacions <a href="https://www.php-fig.org/psr/psr-1/">PSR-1</a> i <a href="https://www.php-fig.org/psr/psr-12/">PSR-12</a> 
són recomanacions sobre l'estil de programació amb l'objectiu d'aplicar estandards comuns i 
així facilitar la lectura del codi realitzar per altres.</p>
<p>Algunes recomancions que cal seguir:</p>
<ol>
<li>Class names MUST be declared in <code>StudlyCaps</code>. For instance: <code>Product</code>.</li>
<li>Class constants MUST be declared in all upper case with underscore separators. For example: const IMAGE_PATH.      </li>
<li>About property names the only recommendation is to be consistent. So, we SHOULD use <code>$camelCase</code>. The same recommendations applies for variables.</li>
<li>Method names MUST be declared in <code>camelCase()</code>.</li>
</ol>
<p>Més informació en <a href="http://coppeldev.github.io/php/standards/psr-1.html">Estándares</a></p>
<h2 id="03-phpoo-0301-phpoo-basic-utilitzacio-dobjectes">Utilització d'objectes</h2>
<p>Ja saps com instanciar un objecte utilitzant <code>new</code>, i com accedir a els
seus mètodes i atributs públics amb l'operador fletxa:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$product</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Product</span><span class="p">();</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$product</span><span class="o">-&gt;</span><span class="na">name</span><span class="o">=</span> <span class="s1">&#39;Samsung Galaxy S&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="k">echo</span> <span class="nv">$product</span><span class="o">-&gt;</span><span class="na">getSummaryLine</span><span class="p">();</span>
</code></pre></div>
<p>Una vegada creat un objecte, pots utilitzar l'operador <code>instanceof</code> per
a comprovar si és o no una instància de una classe determinada.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">if</span> <span class="p">(</span><span class="nv">$product</span> <span class="nx">instanceof</span> <span class="nx">Product</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>        <span class="nx">…</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
<p>Des de PHP7, pots indicar en les funcions i mètodes de quina classe han
de ser els objectes que es passen com a paràmetres. Per a açò, has
d'especificar el tipus abans del paràmetre.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">sellProduct</span><span class="p">(</span><span class="nx">Product</span> <span class="nv">$product</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="nx">…</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
<p>Si quan es realitza la crida, el paràmetre no és del tipus adequat, es
produeix un error que podries capturar. </p>
<p>Una característica de la POO que has de tenir molt en compte és què
succeeix amb els objectes quan els passes a una funció, o simplement
quan executes un codi com el següent:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$product1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Product</span><span class="p">();</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$product1</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">=</span> <span class="s1">&#39;Samsung Galaxy S&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="nv">$product2</span> <span class="o">=</span> <span class="nv">$product1</span><span class="p">;</span>
</code></pre></div>
<p>El codi anterior simplement crearia un nou identificador del mateix objecte. Açò és,
quan s'utilitze qualsevol dels identificadors per a canviar el valor de algun atribut, aquest canvi es 
veuria també reflectit en accedir utilitzant l'altre identificador. Recorda que, encara que hi haja dos o
més identificadors del mateix objecte, en realitat tots es refereixen a l'única còpia que s'emmagatzema 
del mateix.</p>
<h2 id="03-phpoo-0301-phpoo-basic-comparacio-dobjectes">Comparació d'Objectes</h2>
<p>En utilitzar l'operador de comparació (==), es comparen d'una manera
senzilla les variables de cada objecte, és a dir: dues instàncies d'un
objecte són iguals si tenen els mateixos atributs i valors (els valors
es comparen amb ==), i són instàncies de la mateixa classe.</p>
<p>Quan s'utilitza l'operador identitat (===), les variables d'un objecte
són idèntiques si i només sí fan referència a la mateixa instància de
la mateixa classe.</p>
<h2 id="03-phpoo-0301-phpoo-basic-herencia">Herència</h2>
<p>L'herència és un mecanisme de la POO que ens permet definir noves
classes sobre la base d'una altra ja existent. Les noves classes que
hereten també es coneixen amb el nom de subclasses. La classe de la qual
hereten es diu classe base o superclasse.</p>
<p>Per exemple, en la nostra tenda web anem a tenir productes de diferents
tipus. En principi hem creat per a manejar-los una classe anomenada
<code>Product</code>, amb alguns atributs i un mètode que genera una eixida
personalitzada en format HTML del codi.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>   <span class="k">public</span> <span class="nx">string</span> <span class="nv">$code</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>   <span class="k">public</span> <span class="nx">string</span> <span class="nv">$name</span><span class="p">;</span>    
<span class="linenos" data-linenos="4 "></span>  <span class="o">...</span>       
<span class="linenos" data-linenos="5 "></span>   <span class="k">public</span> <span class="k">function</span> <span class="nf">show</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="6 "></span>      <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;&quot;</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span> <span class="o">.</span> <span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="7 "></span>   <span class="p">}</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
<p>Aquesta classe és molt útil si l'única informació que tenim dels
diferents productes és la que es mostra dalt. Però, si vols
personalitzar la informació que vas a tractar de cada tipus de producte
(i emmagatzemar, per exemple per als televisors, les polzades que tenen
o la seua tecnologia de fabricació), pots crear noves classes que
hereten de <code>Product</code>. Per exemple, <code>TV</code>, <code>Computer</code>, <code>Phone</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">TV</span> <span class="k">extends</span> <span class="nx">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">public</span> <span class="nx">float</span> <span class="nv">$size</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">public</span> <span class="nx">string</span> <span class="nv">$technology</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="03-phpoo-0301-phpoo-basic-la-paraula-reservada-extends">La paraula reservada <code>extends</code></h3>
<p>Com pots veure, per a definir una classe que herete d'una altra,
simplement has de utilitzar la paraula <code>extends</code> indicant la superclasse. </p>
<p>Els nous objectes que s'instancien a partir de la subclasse 
són també objectes de la classe base; es pot comprovar utilitzant l'operador <code>instanceof</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$tv</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TV</span><span class="p">();</span>
<span class="linenos" data-linenos="2 "></span><span class="k">if</span> <span class="p">(</span><span class="nv">$tv</span> <span class="nx">instanceof</span> <span class="nx">Product</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>  <span class="c1">// Aquest codi s&#39;executa doncs la condició és certa</span>
<span class="linenos" data-linenos="4 "></span>        <span class="nx">…</span>
<span class="linenos" data-linenos="5 "></span><span class="p">}</span>
</code></pre></div>
<p>La nova classe hereta tots els atributs i mètodes públics de la classe
base, però no els privats. Si vols crear en la classe base un mètode no
visible a l'exterior (com els privats) que s'herete a les subclasses,
has d'utilitzar la paraula <strong>protected</strong> en lloc de <strong>private</strong>. A més, pots
redefinir el comportament dels mètodes existents en la classe base,
simplement creant en la subclasse un nou mètode amb el mateix nom.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">TV</span> <span class="k">extends</span> <span class="nx">Producte</span> <span class="p">{</span> 
<span class="linenos" data-linenos="2 "></span>   <span class="k">public</span> <span class="nx">float</span> <span class="nv">$size</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>   <span class="k">public</span> <span class="nx">string</span> <span class="nv">$technology</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>
<span class="linenos" data-linenos="5 "></span>   <span class="k">public</span> <span class="k">function</span> <span class="nf">show</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="6 "></span>      <span class="k">print</span> <span class="s2">&quot;&lt;p&gt;&quot;</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">size</span> <span class="o">.</span> <span class="s2">&quot; polzades&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="7 "></span>   <span class="p">}</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
<h2 id="03-phpoo-0301-phpoo-basic-bibliografia">Bibliografia</h2>
<ul>
<li>José Luis Comesaña.  <em>Apuntes de formación a distancia del módulo
    «Desarrollo web en entorno servidor» del CFGS DAW, elaborados y
    licenciados por el Ministerio de Educación, Cultura y Deporte.</em> [en
    línia]. 2012 [data de consulta: 13 de setembre de 2019].
    Disponible en
    &lt;<a href="https://github.com/statickidz/TemarioDAW/tree/master/DWES">https://github.com/statickidz/TemarioDAW/tree/master/DWES</a>&gt;</li>
<li>Antonio López. <em>Learning PHP 7.</em> Packt Publishing (29 de marzo de
    2016) .</li>
</ul></section><section class="print-page" id="03-phpoo-0399-activities"><h1 id="03-phpoo-0399-activities-activitats">Activitats</h1>
<ol>
<li>
<p><code>301-Card</code>: Crea una classe anomenada <code>Card</code> que contindrà la informació
     relativa una carta de la baralla francesa amb les seguents propietats:</p>
<ul>
<li><code>suit</code>, string, privada.</li>
<li><code>symbol</code>, string, privada.</li>
<li><code>value</code>, entera, privada.</li>
</ul>
<p>El constructor i el seus <em>getters</em> i <em>setters</em>.</p>
<p>Crea cinc objects diferents en un array i mostra'ls de forma aleatòria. </p>
</li>
<li>
<p><code>302-CardCollection</code>: Crea una classe anomenada <code>CardCollection</code> que contindrà la propietat
     <code>cards</code> que serà un array de cartes (objectes <code>Card</code>).</p>
<p>Hi haurà dues formes d'inserir cartes, mitjançant el mètode <code>CardCollection::add(array $array)</code> que rebrà un array de cartes i els afegirà a la propietat <code>cards</code> i el mètode <code>CardCollecion::addCard(Card $card)</code> que rebrà una carta i la inserirà en la propietat <code>card</code>.</p>
<p>A més, contindrà el mètode <code>shuffle()</code> que ordenarà les cartes de forma aleatòria.</p>
<p>Instància la classe, afig 5 cartes, reordena-les i mostra-les.</p>
</li>
</ol></section><h1 class='nav-section-title-end'>Ended: 3.- PHP Orientat a Objectes</h1></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            2021-2022 Vicent Jordà - Licencia CC BY-NC-SA
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate"], "translations": {"clipboard.copy": "C\u00f2pia al porta-retalls", "clipboard.copied": "Copiat al porta-retalls", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Cerca", "search.result.placeholder": "Escriu per a comen\u00e7ar a cercar", "search.result.none": "Cap document coincideix", "search.result.one": "1 document coincident", "search.result.other": "# documents coincidents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.409db549.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.756773cc.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
      
    
  </body>
</html>