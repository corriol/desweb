
<!DOCTYPE html>

<html class="no-js" lang="ca">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.2.2, mkdocs-material-7.2.6" name="generator"/>
<title>Programació Orientada a Objectes en PHP - DWES</title>
<link href="../../assets/stylesheets/main.802231af.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.3f5d1f46.min.css" rel="stylesheet"/>
<meta content="#ff6e42" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
<link href="../../css/print-site.css" rel="stylesheet"/>
<link href="../../css/print-site-material.css" rel="stylesheet"/>
<link href="../../stylesheets/extra.css" rel="stylesheet"/>
</head>
<body data-md-color-accent="" data-md-color-primary="deep-orange" data-md-color-scheme="" dir="ltr">
<script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#programacio-orientada-a-objectes-en-php">
          Salta el contingut
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="DWES" class="md-header__button md-logo" data-md-component="logo" href="../.." title="DWES">
<img alt="logo" src="../../assets/logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            DWES
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Programació Orientada a Objectes en PHP
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Cerca" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Cerca" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="DWES" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="DWES">
<img alt="logo" src="../../assets/logo.png"/>
</a>
    DWES
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
        Inici
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../01-intro/">
        1.- Introducció a la programació Web
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-phpbasics/">
        2.- El llenguatge PHP
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4">
        3.- PHP Orientat a Objectes
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="3.- PHP Orientat a Objectes" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          3.- PHP Orientat a Objectes
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../0301-phpoo-basic/">
        PHP OO Bàsic
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../0399-activities/">
        Activitats
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="programacio-orientada-a-objectes-en-php">Programació Orientada a Objectes en PHP</h1>
<h2 id="introduccio">Introducció</h2>
<p>La programació orientada a objectes (OOP, per les seues sigles en
anglès) és un paradigma de programació.</p>
<p>Paradigma:</p>
<blockquote>
<p>Teoria […] el nucli central de la qual […] suministra la base i el
model per resoldre problemes i avançar en el coneixement.</p>
</blockquote>
<p>Per la qual cosa podem definir la programació orientada a objecte com
un mètode -provat i estudiat- el qual es basa en les interaccions
d'objectes per resoldre les necessitats d'un sistema informàtic.</p>
<p>Un objecte és una estructura que conté dades i el codi que els maneja.</p>
<p>L'estructura dels objectes es defineix en les classes. En elles s'escriu
el codi que defineix el comportament dels objectes i s'indiquen els
membres que formaran part dels objectes d'aquesta classe. Entre els
membres de una classe pot haver-hi:</p>
<ul>
<li><strong>Mètodes</strong>. Són els membres de la classe que contenen el codi de la
    mateixa. Un mètode és com una funció. Pot rebre paràmetres i
    retornar valors.</li>
<li><strong>Atributs o propietats</strong>. Emmagatzemen informació sobre el estat de
    l'objecte al que pertanyen (i per tant, el seu valor pot ser
    diferent per a cadascun dels objectes de la mateixa classe).</li>
</ul>
<p>A la creació de un objecte basat en una classe se li anomena instanciar
una classe i a l'objecte obtingut també se li coneix com a instància
d'aqueixa classe.</p>
<p>Els pilars fonamentals de la POO són:</p>
<ul>
<li><strong>Herència</strong>. És el procés de crear una classe a partir de una altra,
    heretant el seu comportament i característiques i podent
    redefinir-los.</li>
<li><strong>Abstracció</strong>. Fa referència al fet que cada classe oculta en el seu
    interior les peculiaritats de la seua implementació, i presenta a
    l'exterior una sèrie de mètodes (interfície) el comportament dels
    quals està ben definit. Vist des de l'exterior, cada objecte és un
    ens abstracte que realitza un treball.</li>
<li><strong>Polimorfisme</strong>. Un mateix mètode pot tenir comportaments diferents en
    funció de l'objecte amb que s'utilitze.</li>
<li><strong>Encapsulació</strong>. En la POO s'ajunten en un mateix lloc les dades i el
    codi que els manipula.</li>
</ul>
<p>Els avantatges més importants que aporta la programació orientada a
objectes són:</p>
<ul>
<li><strong>Modularitat</strong>. La POO permet dividir els programes en parts o
    mòduls més xicotets, que són independents uns d'uns altres però
    poden comunicar-se entre ells.</li>
<li><strong>Extensibilitat</strong>. Si es desitgen afegir noves característiques a
    una aplicació, la POO facilita aquesta tasca de dues formes: afegint
    nous mètodes al codi, o creant nous objectes que estenguen el
    comportament dels ja existents.</li>
<li><strong>Manteniment</strong>. Els programes desenvolupats utilitzant POO són més
    senzills de mantenir, a causa de la modularitat abans comentada.
    També ajuda seguir certes convencions en escriure'ls , per exemple,
    escriure cada classe en un fitxer propi. No ha d'haver-hi dues
    classes en un mateix fitxer, ni un altre codi a part de el propi de
    la classe.</li>
</ul>
<h2 id="caracteristiques-basiques-de-lus-dobjectes-en-php">Característiques bàsiques de l'ús d'objectes en PHP</h2>
<h3 id="introduccio_1">Introducció</h3>
<p>Segurament tot, o la majoria del que acabes de veure, ja ho coneixies,
i és fins i tot probable que sàpigues utilitzar algun llenguatge de
programació orientat a objectes, així que anem a veure directament les
peculiaritats pròpies de PHP en el que fa referència a la POO.</p>
<p>En PHP podemos utilitzar els dos paradigmes de la programació: estructurada i orientada a objectes.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span> <span class="c1">// utilitzant programació estructurada</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$dwes</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="s1">'dwes'</span><span class="p">,</span> <span class="s1">'abc123.'</span><span class="p">,</span> <span class="s1">'dwes'</span><span class="p">);</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">// utilizant POO</span>
<span class="linenos" data-linenos="4 "></span><span class="nv">$dwes</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mysqli</span><span class="p">();</span>
<span class="linenos" data-linenos="5 "></span><span class="nv">$dwes</span><span class="o">-&gt;</span><span class="na">connect</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="s1">'dwes'</span><span class="p">,</span> <span class="s1">'abc123.'</span><span class="p">,</span> <span class="s1">'dwes'</span><span class="p">);</span>
</code></pre></div>
<p>No obstant açò, el llenguatge PHP original no es va dissenyar amb
característiques d'orientació a objectes. Només a partir de la versió 3,
es van començar a introduir alguns trets de POO en el llenguatge. Açò es
va potenciar en la versió 4, encara que encara de forma molt
rudimentària. Per exemple, en PHP4:</p>
<ul>
<li>Els objectes es passen sempre per valor, no per referència.</li>
<li>No es pot definir el nivell d'accés per als membres de la classe.
    Tots són públics.</li>
<li>No existeixen les interfícies.</li>
<li>No existeixen mètodes destructors.</li>
</ul>
<p>En PHP5 es va reescriure i potenciar el suport d'orientació a objectes del llenguatge, ampliant les seues
característiques i millorant el seu rendiment i el seu funcionament general. Les característiques de POO que 
suporta PHP5 inclouen:</p>
<ul>
<li>Mètodes estàtics.</li>
<li>Mètodes constructors i destructors.</li>
<li>Herència.</li>
<li>Interfícies.</li>
<li>Classes abstractes.</li>
</ul>
<p>Entre les característiques que no inclou PHP5, i que pots conèixer
d'altres llenguatges de programació, estan:</p>
<ul>
<li>Herència múltiple.</li>
<li>Sobrecàrrega de mètodes (tenir diversos mètodes amb el mateix nom,
    però amb funcionalitats diferents. Els mètodes sobrecarregats han de
    tenir diferents paràmetres. Quan es diu al mètode, s'utilitza una o
    una altra versió en funció dels paràmetres amb que es realitze la
    trucada (podent distingir per el seu nombre i per el seu tipus,
    segons el llenguatge de programació utilitzat)) (inclosos els
    mètodes constructors).</li>
<li>Sobrecàrrega d'operadors (similar a la sobrecàrrega de mètodes. Es
    poden definir diverses funcionalitats a un mateix operador, i
    s'utilitzarà una o una altra en funció del tipus dels operands que
    s'usen en cada instant).</li>
</ul>
<p>PHP 7 incorpora millores en el rendiment i el tipat d'arguments, valors de retorn i atributs (des de la versió 7.4)</p>
<h3 id="definicio-de-classes">Definició de classes</h3>
<p>La declaració de una classe en PHP es fa utilitzant la paraula <code>class</code>. A continuació i entre claus, han de 
figurar els membres de la classe.</p>
<p>Convé fer-ho de forma ordenada, primer les propietats o atributs, i
després els mètodes, cadascun amb el seu codi respectiu.</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">private</span> <span class="nx">string</span> <span class="nv">$code</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">public</span> <span class="nx">string</span> <span class="nv">$name</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>    <span class="k">public</span> <span class="nx">float</span> <span class="nv">$price</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">show</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="6 "></span>        <span class="k">print</span> <span class="s2">"&lt;p&gt;"</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span> <span class="o">.</span> <span class="s2">"&lt;/p&gt;"</span><span class="p">;</span>
<span class="linenos" data-linenos="7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
Com comentàvem abans, és preferible que cada classe figure en el seu
propi fitxer (<strong><code>Product.php</code></strong>). A més, molts programadors prefereixen
utilitzar per a les classes noms que comencen per lletra majúscula, per
a, d'aquesta forma, distingir-los dels objectes i altres variables.</p>
<p>Una vegada definida la classe, podem usar la paraula <strong><code>new</code></strong> per a
instanciar objectes de la següent forma:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$product</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Product</span><span class="p">();</span>
</code></pre></div>
<p>Perquè la línia anterior s'execute sense error, prèviament hem d'haver
declarat la classe. Per a açò, en aqueix mateix fitxer hauràs de
incloure la classe posant alguna cosa com:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">require</span><span class="p">(</span><span class="s1">'Product.php'</span><span class="p">);</span>
</code></pre></div>
<p>Els atributs de una classe són similars a les variables de PHP. És
possible indicar un valor en la declaració de la classe. En aquest cas,
tots els objectes que s'instancien a partir de aqueixa classe, partiran
amb aqueix valor per defecte en l'atribut.</p>
<p>Per a accedir des d'un objecte als seus atributs o als mètodes de
la classe, has d'utilitzar l'operador fletxa (fixa't que només es posa
el símbol $ davant del nom de l'objecte):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$product</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">=</span> <span class="s1">'Samsung Galaxy S'</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$product</span><span class="o">-&gt;</span><span class="na">show</span><span class="p">();</span>
</code></pre></div>
<p>Quan es declara una propietat o un mètode, s'ha d'indicar el seu nivell d'accés (o visibilitat). Els
principals nivells són:</p>
<ul>
<li><code>public</code>. Els atributs declarats com <code>public</code> poden utilitzar-se
    directament per els objectes de la classe. És el cas de l'atribut
    <code>$name</code> anterior.</li>
<li><code>private</code>. Els atributs declarats com <code>private</code> només poden ser
    accedits i modificats per els mètodes definits en la classe, no
    directament per els objectes de la mateixa. És el cas de l'atribut
    <code>$code</code>.</li>
<li><code>protected</code>. Una propietat o mètode <code>protected</code> sols pot ser accedida per la classe on es defineix o per un subclasse. No és accessible des de fora.  </li>
</ul>
<p>Un dels motius per a crear atributs privats és que el seu valor forma
part de la informació interna de l'objecte i no ha de formar part de la
seua interfície. Un altre motiu és mantenir cert control sobre els seus
possibles valors. Per exemple, si no vols que es puga canviar lliurement
el valor del codi d'un producte. O necessites conèixer quin serà el nou
valor abans d'assignar-lo. En aquests casos, se solen definir aqueixos
atributs com a privats i a més es creen dins de la classe mètodes per a
permetre'ns obtenir i/o modificar els valors d'aqueixos atributs. Per
exemple:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">private</span> <span class="nv">$code</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">setCode</span><span class="p">(</span><span class="nv">$newCode</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">existsCode</span><span class="p">(</span><span class="nv">$newCode</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-linenos="4 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span> <span class="o">=</span> <span class="nv">$newCode</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span>        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="linenos" data-linenos="6 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="7 "></span>    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
<span class="linenos" data-linenos="9 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">getCode</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span><span class="p">;</span> <span class="p">}</span>
</code></pre></div>
<p>Encara que no és obligatori, el nom del mètode que ens permet obtenir el
valor de un atribut sol començar per <code>get</code>, i el que ens permet
modificar-lo per <code>set</code>.</p>
<p>En PHP5 es van introduir els anomenats mètodes màgics, entre ells
<code>__set</code> i <code>__get</code>. Si es declaren aquests dos mètodes en una classe, PHP
els invoca automàticament quan des de un objecte s'intenta usar un
atribut no existent o no accessible. Per exemple, el codi següent simula
que la classe <code>Product</code> té qualsevol atribut que vulguem usar.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">private</span> <span class="nv">$atributos</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__get</span><span class="p">(</span><span class="nv">$atributo</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="4 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">atributos</span><span class="p">[</span><span class="nv">$atributo</span><span class="p">];</span>
<span class="linenos" data-linenos="5 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="6 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__set</span><span class="p">(</span><span class="nv">$atributo</span><span class="p">,</span> <span class="nv">$valor</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="7 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">atributos</span><span class="p">[</span><span class="nv">$atributo</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$valor</span><span class="p">;</span>
<span class="linenos" data-linenos="8 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="9 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="constructor-i-destructor">Constructor i destructor</h3>
<p>Com ja has vist, per a instanciar objectes de una classe s'utilitza la
paraula <code>new</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$product</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Product</span><span class="p">();</span>
</code></pre></div>
<p>En PHP7 pots definir en les classes mètodes constructors, que s'executen
quan es crea l'objecte.</p>
<p>El constructor d'una classe ha d'anomenar-se <code>__construct</code>. Es poden utilitzar, per exemple, 
per assignar valors a atributs.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">private</span> <span class="k">static</span> <span class="nv">$numProducts</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">private</span> <span class="nv">$code</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
<span class="linenos" data-linenos="5 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos="6 "></span>        <span class="nx">self</span><span class="o">::</span><span class="nv">$numPoducts</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos="7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="8 "></span>    <span class="nx">…</span>
<span class="linenos" data-linenos="9 "></span><span class="p">}</span>
</code></pre></div>
<p>El constructor d'una classe pot cridar a altres mètodes o tenir
paràmetres, en aquest cas hauran de passar-se quan es crea l'objecte.
No obstant açò, només pot haver-hi un mètode constructor en cada classe.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>    <span class="k">private</span> <span class="k">static</span> <span class="nv">$numProducts</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">private</span> <span class="nv">$code</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$code</span> <span class="o">=</span> <span class="nv">$code</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="nx">self</span><span class="o">::</span><span class="nv">$numProducts</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="o">...</span>
<span class="linenos" data-linenos=" 9 "></span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span><span class="nv">$p</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Product</span><span class="p">(</span><span class="s1">'GALAXYS'</span><span class="p">);</span>
</code></pre></div>
<p>Per exemple, si com en aquest exemple, definim un constructor en el qual
calga passar el codi, sempre que instancies un nou objecte d'aqueixa
classe hauràs de indicar el seu codi.</p>
<p>També és possible definir un mètode destructor, que ha d'anomenar-se
<code>__destruct()</code> que s'executarà quan s'elimine l'objecte.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">private</span> <span class="k">static</span> <span class="nv">$numProducts</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">private</span> <span class="nv">$code</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$code</span> <span class="o">=</span> <span class="nv">$code</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="nx">self</span><span class="o">::</span><span class="nv">$numProducts</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="nx">self</span><span class="o">::</span><span class="nv">$numProducts</span><span class="o">--</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>    <span class="o">...</span>
<span class="linenos" data-linenos="12 "></span><span class="p">}</span>
<span class="linenos" data-linenos="13 "></span><span class="nv">$p</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Product</span><span class="p">(</span><span class="s1">'GALAXYS'</span><span class="p">);</span>
</code></pre></div>
<h3 id="la-pseuodovariable-this">La pseuodovariable $this</h3>
<p>Quan des d'un objecte s'invoca un mètode de la classe, a aquest se li
passa sempre una referència a l'objecte que ha fet la crida. Aquesta
referència s'emmagatzema en la pseudovariable <code>$this.</code> S'utilitza, per
exemple, en el codi anterior per a tenir accés als atributs privats de
l'objecte (que només són accessibles des dels mètodes de la classe).</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>echo "<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>" . $this-&gt;code . "<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>";
</code></pre></div>
<p>En la documentació de PHP tens més informació sobre els mètodes màgics:
<a href="http://es.php.net/manual/es/language.oop5.magic.php">http://es.php.net/manual/es/language.oop5.magic.php</a></p>
<h3 id="constants-de-classe">Constants de classe</h3>
<p>A més de mètodes i propietats, en una classe també es poden definir constants, 
utilitzant la paraula <code>const</code>. És important que no confongues els atributs amb
les constants. Són conceptes diferents: les constants no poden canviar el seu 
valor (òbviament, de ací el seu nom), no usen el caràcter <code>$</code>, s'escriuen en 
majúscules (per convenció)  i el seu valor està associat a la classe, és a dir, 
no existeix una còpia del mateix en cada objecte. </p>
<p>Per tant, per a accedir a les constants d'una classe, s'ha d'utilitzar el 
nom de la classe i l'operador <code>::</code>, anomenat operador de resolució d'àmbit 
(que s'utilitza per a accedir a els elements de una classe).</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">DB</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">const</span> <span class="no">USUARIO</span> <span class="o">=</span> <span class="s1">'dwes'</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>      <span class="o">...</span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span>
<span class="linenos" data-linenos="5 "></span><span class="k">echo</span> <span class="nx">DB</span><span class="o">::</span><span class="na">USUARIO</span><span class="p">;</span>
</code></pre></div>
<p>És important ressaltar que no és necessari que existisca cap objecte de
una classe per a poder accedir al valor de les constants que definisca.</p>
<h3 id="php-standard-recommendations">PHP Standard Recommendations</h3>
<div class="admonition important">
<p class="admonition-title">PHP-FIG</p>
<p>El PHP Framework Interop Group és un grup de treball on està involucrada gent que treballa en diferents <em>frameworks</em> amb
l'objectiu de posar en comú les tècniques que usen en els diferents projectes per poder integrar-les i compartir-les 
i poder treballar millor junts.</p>
</div>
<p>Les recomanacions <a href="https://www.php-fig.org/psr/psr-1/">PSR-1</a> i <a href="https://www.php-fig.org/psr/psr-12/">PSR-12</a> 
són recomanacions sobre l'estil de programació amb l'objectiu d'aplicar estandards comuns i 
així facilitar la lectura del codi realitzar per altres.</p>
<p>Algunes recomancions que cal seguir:</p>
<ol>
<li>Class names MUST be declared in <code>StudlyCaps</code>. For instance: <code>Product</code>.</li>
<li>Class constants MUST be declared in all upper case with underscore separators. For example: const IMAGE_PATH.      </li>
<li>About property names the only recommendation is to be consistent. So, we SHOULD use <code>$camelCase</code>. The same recommendations applies for variables.</li>
<li>Method names MUST be declared in <code>camelCase()</code>.</li>
</ol>
<p>Més informació en <a href="http://coppeldev.github.io/php/standards/psr-1.html">Estándares</a></p>
<h3 id="metodes-o-atributs-estatics">Mètodes o atributs estàtics</h3>
<p>Tampoc s'han de confondre les constants amb els membres estàtics d'una
classe. En PHP7, una classe pot tenir atributs o mètodes estàtics, també
anomenats a vegades atributs o mètodes de classe. Es defineixen utilitzant
la paraula clau <code>static</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">private</span> <span class="k">static</span> <span class="nv">$numProducts</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">newProduct</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="4 "></span>        <span class="nx">self</span><span class="o">::</span><span class="nv">$numProducts</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="6 "></span>       <span class="nx">…</span>
<span class="linenos" data-linenos="7 "></span><span class="p">}</span>
</code></pre></div>
<p>Els atributs i mètodes estàtics no poden ser cridats des d'un objecte de
la classe utilitzant l'operador <code>-&gt;</code>. Si el mètode o atribut és públic,
haurà d'accedir-se utilitzant el nom de la classe i l'operador de
resolució d'àmbit.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nx">Product</span><span class="o">::</span><span class="na">newProduct</span><span class="p">();</span>
</code></pre></div>
<p>Si és privat, com l'atribut <code>$numProducts</code> en l'exemple anterior,
només es podrà accedir a ell des dels mètodes de la pròpia classe,
utilitzant la paraula <code>self</code>. De la mateixa forma que <code>$this</code> referencia
a l'objecte actual, <code>self</code> fa referència a la classe actual.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nx">self</span><span class="o">::</span><span class="nv">$numProductes</span><span class="o">++</span><span class="p">;</span>
</code></pre></div>
<p>Els atributs estàtics d'una classe s'utilitzen per a guardar informació general sobre la mateixa, com pot ser 
el nombre d'objectes que s'han instanciat. Només existeix un valor de l'atribut, que s'emmagatzema a
nivell de classe.</p>
<p>Els mètodes estàtics solen realitzar alguna tasca específica o retornar un objecte concret. Per exemple, 
les classes matemàtiques solen tenir mètodes estàtics per a realitzar logaritmes o arrels quadrades. No té
sentit crear un objecte si l'única cosa que volem és realitzar una operació matemàtica.</p>
<p>Els mètodes estàtics es criden des de la classe. No és possible
cridar-los des d'un objecte i per tant, no podem usar <code>$this</code> dins d'un
mètode estàtic.</p>
<h3 id="utilitzacio-dobjectes">Utilització d'objectes</h3>
<p>Ja saps com instanciar un objecte utilitzant <code>new</code>, i com accedir a els
seus mètodes i atributs públics amb l'operador fletxa:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$product</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Product</span><span class="p">();</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$product</span><span class="o">-&gt;</span><span class="na">name</span><span class="o">=</span> <span class="s1">'Samsung Galaxy S'</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="nv">$product</span><span class="o">-&gt;</span><span class="na">show</span><span class="p">();</span>
</code></pre></div>
<p>Una vegada creat un objecte, pots utilitzar l'operador <code>instanceof</code> per
a comprovar si és o no una instància de una classe determinada.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">if</span> <span class="p">(</span><span class="nv">$product</span> <span class="nx">instanceof</span> <span class="nx">Product</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>        <span class="nx">…</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
<p>Des de PHP7, pots indicar en les funcions i mètodes de quina classe han
de ser els objectes que es passen com a paràmetres. Per a açò, has
d'especificar el tipus abans del paràmetre.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">sellProduct</span><span class="p">(</span><span class="nx">Product</span> <span class="nv">$product</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="nx">…</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
<p>Si quan es realitza la crida, el paràmetre no és del tipus adequat, es
produeix un error que podries capturar. </p>
<p>Una característica de la POO que has de tenir molt en compte és què
succeeix amb els objectes quan els passes a una funció, o simplement
quan executes un codi com el següent:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$p</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Product</span><span class="p">();</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$p</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">=</span> <span class="s1">'Samsung Galaxy S'</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="nv">$a</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">;</span>
</code></pre></div>
<p>El codi anterior simplement crearia un nou identificador del mateix objecte. Açò és,
quan s'utilitze qualsevol dels identificadors per a canviar el valor de algun atribut, aquest canvi es 
veuria també reflectit en accedir utilitzant l'altre identificador. Recorda que, encara que hi haja dos o
més identificadors del mateix objecte, en realitat tots es refereixen a l'única còpia que s'emmagatzema 
del mateix.</p>
<p>Per tant, a partir de PHP5 no pots copiar un objecte utilitzant
l'operador <code>=</code>. Si necessites copiar un objecte, has d'utilitzar <code>clone</code>. En
utilitzar <code>clone</code> sobre un objecte existent, es crea una còpia del mateix.</p>
<p>A més, existeix una forma senzilla de personalitzar la còpia per a cada
classe particular. Per exemple, pot succeir que vulgues copiar tots els
atributs menys algun. En el nostre exemple, almenys el codi de cada
producte ha de ser diferent i, per tant, potser no tinga sentit
copiar-lo en crear un nou objecte. Si aquest fóra el cas, pots crear un
mètode de nom <code>__clone</code> en la classe. Aquest mètode es cridarà
automàticament després de copiar tots els atributs en el nou objecte.</p>
<h3 id="comparacio-dobjectes">Comparació d'Objectes</h3>
<p>En utilitzar l'operador de comparació (==), es comparen d'una manera
senzilla les variables de cada objecte, és a dir: dues instàncies d'un
objecte són iguals si tenen els mateixos atributs i valors (els valors
es comparen amb ==), i són instàncies de la mateixa classe.</p>
<p>Quan s'utilitza l'operador identitat (===), les variables d'un objecte
són idèntiques si i només sí fan referència a la mateixa instància de
la mateixa classe.</p>
<h3 id="clonacio-dobjectes">Clonació d'Objectes</h3>
<p>Per crear una còpia d'un objecte s'utilitza la paraula clau <code>clone</code> (que
invoca, si fos possible, al mètode  <code>__clone()</code> de l'objecte). No es pot
cridar el mètode <code>__clone()</code> d'un objecte directament.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$copia_objecte</span> <span class="o">=</span> <span class="k">clone</span> <span class="nv">$objecte</span><span class="p">;</span>
</code></pre></div>
<p>Quan es clona un objecte, PHP7 durà a terme una còpia superficial de les
propietats de l'objecte. Les propietats que siguen referències a altres
variables (per exemple, objectes), mantindran les referències.</p>
<p>Compte: si els atributs són objectes no es clonaran.</p>
<h3 id="iteracio-dobjectes">Iteració d'objectes</h3>
<p>PHP 7 ofereix una forma de definir objectes, de manera que és possible
recórrer una llista d'elements amb, per exemple, una sentència <code>foreach</code>.
Per defecte, s'utilitzaran totes les propietats visibles per a la
iteració.</p>
<h2 id="herencia">Herència</h2>
<h3 id="introduccio_2">Introducció</h3>
<p>L'herència és un mecanisme de la POO que ens permet definir noves
classes sobre la base d'una altra ja existent. Les noves classes que
hereten també es coneixen amb el nom de subclasses. La classe de la qual
hereten es diu classe base o superclasse.</p>
<p>Per exemple, en la nostra tenda web anem a tenir productes de diferents
tipus. En principi hem creat per a manejar-los una classe anomenada
<code>Product</code>, amb alguns atributs i un mètode que genera una eixida
personalitzada en format HTML del codi.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>   <span class="k">public</span> <span class="nx">string</span> <span class="nv">$code</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>   <span class="k">public</span> <span class="nx">string</span> <span class="nv">$name</span><span class="p">;</span>    
<span class="linenos" data-linenos="4 "></span>
<span class="linenos" data-linenos="5 "></span>   <span class="k">public</span> <span class="k">function</span> <span class="nf">show</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="6 "></span>      <span class="k">echo</span> <span class="s2">"&lt;p&gt;"</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span> <span class="o">.</span> <span class="s2">"&lt;/p&gt;"</span><span class="p">;</span>
<span class="linenos" data-linenos="7 "></span>   <span class="p">}</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
<p>Aquesta classe és molt útil si l'única informació que tenim dels
diferents productes és la que es mostra a dalt. Però, si vols
personalitzar la informació que vas a tractar de cada tipus de producte
(i emmagatzemar, per exemple per als televisors, les polzades que tenen
o la seua tecnologia de fabricació), pots crear noves classes que
hereten de <code>Product</code>. Per exemple, <code>TV</code>, <code>Computer</code>, <code>Phone</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">TV</span> <span class="k">extends</span> <span class="nx">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">public</span> <span class="nv">$size</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">public</span> <span class="nv">$technology</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="la-paraula-reservada-extends">La paraula reservada <code>extends</code></h3>
<p>Com pots veure, per a definir una classe que herete d'una altra,
simplement has de utilitzar la paraula <code>extends</code> indicant la superclasse. </p>
<p>Els nous objectes que s'instancien a partir de la subclasse 
són també objectes de la classe base; es pot comprovar utilitzant l'operador <code>instanceof</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$tv</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TV</span><span class="p">();</span>
<span class="linenos" data-linenos="2 "></span><span class="k">if</span> <span class="p">(</span><span class="nv">$tv</span> <span class="nx">instanceof</span> <span class="nx">Product</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>  <span class="c1">// Aquest codi s'executa doncs la condició és certa</span>
<span class="linenos" data-linenos="4 "></span>        <span class="nx">…</span>
<span class="linenos" data-linenos="5 "></span><span class="p">}</span>
</code></pre></div>
<p>La nova classe hereta tots els atributs i mètodes públics de la classe
base, però no els privats. Si vols crear en la classe base un mètode no
visible a l'exterior (com els privats) que s'herete a les subclasses,
has d'utilitzar la paraula <strong>protected</strong> en lloc de <strong>private</strong>. A més, pots
redefinir el comportament dels mètodes existents en la classe base,
simplement creant en la subclasse un nou mètode amb el mateix nom.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">TV</span> <span class="k">extends</span> <span class="nx">Producte</span> <span class="p">{</span> 
<span class="linenos" data-linenos="2 "></span>   <span class="k">public</span> <span class="nv">$size</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>   <span class="k">public</span> <span class="nv">$technology</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>
<span class="linenos" data-linenos="5 "></span>   <span class="k">public</span> <span class="k">function</span> <span class="nf">show</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="6 "></span>      <span class="k">print</span> <span class="s2">"&lt;p&gt;"</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">size</span> <span class="o">.</span> <span class="s2">" polzades&lt;/p&gt;"</span><span class="p">;</span>
<span class="linenos" data-linenos="7 "></span>   <span class="p">}</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
<h2 id="la-paraula-reservada-final">La paraula reservada <code>final</code></h2>
<p>Existeix una forma d'evitar que les classes heretades puguen redefinir
el comportament dels mètodes existents en la superclasse: utilitzar la
paraula <code>final</code>.</p>
<p>Si en el nostre exemple haguérem fet:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span> 
<span class="linenos" data-linenos="2 "></span>    <span class="k">public</span> <span class="nv">$code</span><span class="p">;</span> 
<span class="linenos" data-linenos="3 "></span>    <span class="k">public</span> <span class="nv">$name</span><span class="p">;</span>         
<span class="linenos" data-linenos="4 "></span>    <span class="k">public</span> <span class="nv">$price</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span>    <span class="k">public</span> <span class="k">final</span> <span class="k">function</span> <span class="nf">show</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="7 "></span>        <span class="k">print</span> <span class="s2">"&lt;p&gt;"</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span> <span class="o">.</span> <span class="s2">"&lt;/p&gt;"</span><span class="p">;</span>
<span class="linenos" data-linenos="8 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="9 "></span><span class="p">}</span>
</code></pre></div>
<p>En aquest cas el mètode <code>show</code> no podria redefinir-se en la classe <code>TV</code>.</p>
<p>També es pot declarar una classe utilitzant <code>final</code>. En aquest cas no
podran crear-se classes heretades utilitzant-les com a base.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">final</span> <span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>  <span class="o">...</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="la-paraula-reservada-abstract">La paraula reservada <code>abstract</code></h3>
<p>Oposadament al modificador <code>final</code>, existeix també <code>abstract</code>.</p>
<p>S'utilitza de la mateixa forma, tant amb mètodes com amb classes
completes, però en lloc de prohibir l'herència, obliga a que s'herete.
És a dir,  una classe amb el modificador abstract no pot tenir objectes que la
instancien, però sí podrà utilitzar-se de classe base i les seues
subclasses sí podran utilitzar-se per a instanciar objectes.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">abstract</span> <span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>   <span class="o">...</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
<p>Un mètode en el qual s'indique <code>abstract</code>, ha de ser redefinit obligatòriament per les subclasses, i no 
podrà contenir codi.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>        <span class="nx">…</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">abstract</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">show</span><span class="p">();</span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span>
</code></pre></div>
<p>Anem a fer una petita modificació en la nostra classe <code>Product</code>. Per a
facilitar la creació de nous objectes, crearem un constructor al que se
li passarà un array amb els valors dels atributs del nou producte.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>    <span class="k">public</span> <span class="nv">$code</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">public</span> <span class="nv">$name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">public</span> <span class="nv">$shortName</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="nv">$price</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">show</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="k">echo</span> <span class="s2">"&lt;p&gt;"</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span> <span class="o">.</span> <span class="s2">"&lt;/p&gt;"</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$row</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">'code'</span><span class="p">];</span>
<span class="linenos" data-linenos="12 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">'name'</span><span class="p">];</span>
<span class="linenos" data-linenos="13 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">shortName</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">'short_name'</span><span class="p">];</span>
<span class="linenos" data-linenos="14 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">price</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">'price'</span><span class="p">];</span>
<span class="linenos" data-linenos="15 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="16 "></span><span class="p">}</span>
</code></pre></div>
<p><strong>Què passa ara amb la classe <code>TV</code>, què hereta de Product? Quan crees un
nou objecte d'aqueixa classe, es cridarà al constructor de Product?
Pots crear un nou constructor específic perquè redefinisca el
comportament de la classe base?</strong></p>
<p>Començant per aquesta última pregunta, òbviament pots definir un nou
constructor per a les classes heretades que redefinisquen el
comportament del que existeix en la classe base, tal com faries amb
qualsevol altre mètode. I depenent de si programes o no el constructor
en la classe heretada, es cridarà o no automàticament al constructor de
la classe base.</p>
<p>En PHP5+, si la classe heretada no té constructor propi, es cridarà
automàticament al constructor de la classe base (si existeix). No
obstant açò, si la classe heretada defineix el seu propi constructor,
hauràs de ser tu el que realitze la crida al constructor de la classe
base si ho consideres necessari, utilitzant per a açò la paraula
<code>parent</code> i l'operador de resolució d'àmbit.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">class</span> <span class="nc">TV</span> <span class="k">extends</span> <span class="nx">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>    <span class="k">public</span> <span class="nv">$size</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">public</span> <span class="nv">$technology</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">show</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="k">print</span> <span class="s2">"&lt;p&gt;"</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">size</span> <span class="o">.</span> <span class="s2">" polzades&lt;/p&gt;"</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$row</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span><span class="nv">$row</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">size</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">'size'</span><span class="p">];</span>
<span class="linenos" data-linenos="12 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">technology</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">'technology'</span><span class="p">];</span>
<span class="linenos" data-linenos="13 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="14 "></span> <span class="p">}</span>
</code></pre></div>
<p>Ja has vist amb amb anterioritat com s'utilitzava la paraula clau <code>self</code>
per a tenir accés a la classe actual. La paraula <code>parent</code> és semblant. En
utilitzar <code>parent</code> fas referència a la classe base de la actual, tal com
apareix rere <code>extends</code>.</p>
<h2 id="interficies">Interfícies</h2>
<h3 id="introduccio_3">Introducció</h3>
<p>Un interfície (<em>interface</em>) és com una classe buida que solament conté declaracions de mètodes. 
Es defineixen utilitzant la paraula <code>interface</code>. Per exemple, abans vam veure que podíem crear noves classes
heretades de <code>Product</code>, com <code>TV</code> o <code>Ordinador</code>. També vam veure que en les subclasses
podies redefinir el comportament del mètode perquè generara una eixida
en HTML diferent per a cada tipus de producte.</p>
<p>Si vols assegurar-te que tots els tipus de productes tinguen un mètode
<code>show</code>, pots crear un interface com el següent.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">interface</span> <span class="nx">IShow</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">show</span><span class="p">();</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
<p>I quan crees les subclasses hauràs d'indicar amb la paraula <code>implements</code>
que han de implementar els mètodes declarats en aquest interface.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">TV</span> <span class="k">extends</span> <span class="nx">Product</span> <span class="k">implements</span> <span class="nx">IShow</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>            <span class="nx">…</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">show</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="4 "></span>        <span class="k">echo</span> <span class="s2">"&lt;p&gt;"</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">size</span> <span class="o">.</span> <span class="s2">" polzades&lt;/p&gt;"</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="6 "></span>        <span class="nx">…</span>
<span class="linenos" data-linenos="7 "></span><span class="p">}</span>
</code></pre></div>
<p>Tots els mètodes que es declaren en un <code>interface</code> han de ser públics. A
més de mètodes, els interfícies podran contenir constants però no
atributs.</p>
<p>Un interface és com un contracte que la classe ha de complir. En
implementar tots els mètodes declarats en la interfície s'assegura la
interoperabilitat entre classes. Si saps que una classe implementa un
interfície determinada saps quins noms tenen els seus mètodes, quins
paràmetres els has de passar i, probablement, podràs esbrinar fàcilment
amb quins objectiu han sigut escrits.</p>
<p>Per exemple, en la llibreria de PHP està definit la interfície
<code>countable</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nx">Countable</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">abstract</span> <span class="k">public</span> <span class="nx">int</span> <span class="nb">count</span> <span class="p">(</span> <span class="nx">void</span> <span class="p">)</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
<p>Si crees una classe per a la cistella de la compra en la tenda web,
podries implementar aquesta interfície per a contar els productes que
figuren en la mateixa.</p>
<p>Abans vas aprendre que en PHP5 una classe només pot heretar d'una altra.
En PHP5 no existeix l'herència múltiple. No obstant açò, sí és possible
crear classes que implementen diverses interfícies, simplement separant
la llista d'interfícies per comes després de la paraula <code>implements</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">TV</span> <span class="k">extends</span> <span class="nx">Product</span> <span class="k">implements</span> <span class="nx">IShow</span><span class="p">,</span> <span class="nx">Countable</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>         <span class="nx">…</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
<p>L'única restricció és que els noms dels mètodes que s'hagen
d'implementar en els diferents interfícies no coincidisquen. És a dir,
en el nostre exemple, la interfície <code>IShow</code> no podria contenir el
mètode <code>count</code>, doncs aquest ja està declarat en <code>Countable</code>.</p>
<p>En PHP7 també es poden crear nous interfícies heretant d'uns altres ja
existents. Es fa de la mateixa forma que amb les classes, utilitzant la
paraula <code>extends</code>.</p>
<h2 id="classes-abstractes-vs-interficies">Classes abstractes vs interfícies</h2>
<p>Un dels dubtes més comuns en POO, és quina solució adoptar en algunes
situacions: interfícies o classes abstractes. Ambdues permeten definir
regles per a les classes que els implementen o hereten respectivament. I
cap permet instanciar objectes. Les diferències principals entre ambdues
opcions són:</p>
<ul>
<li>En les classes abstractes, els mètodes poden contenir codi. Si van a
    existir diverses subclasses amb un comportament comú, es podria
    programar en els mètodes de la classe abstracta. Si s'opta per un
    interface, caldria repetir el codi en totes les classes que ho
    implemente.</li>
<li>Les classes abstractes poden contenir atributs, i les interfícies
    no.</li>
<li>No es pot crear una classe que herete de dues classes abstractes,
    però sí es pot crear una classe que implemente diverses interfícies.</li>
</ul>
<p>Per exemple, en la botiga <em>online</em> va a haver-hi dos tipus d'usuaris:
clients i empleats. Si necessites crear en la teua aplicació objectes de
tipus Usuari (per exemple, per a manejar de forma conjunta als
clients i als empleats), hauries de crear una classe no abstracta amb
aqueix nom, de la qual heretarien Client i Empleat.</p>
<p>Podeu llegir també l'article
 <a href="https://poesiabinaria.net/2010/06/clases-abstractas-e-interfaces-en-php/">Clases abastractas e interfaces en PHP </a></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">Usuari</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>     <span class="o">...</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
<span class="linenos" data-linenos="4 "></span><span class="k">class</span> <span class="nc">Client</span> <span class="k">extends</span> <span class="nx">Usuari</span> <span class="p">{</span>
<span class="linenos" data-linenos="5 "></span><span class="o">...</span>
<span class="linenos" data-linenos="6 "></span><span class="p">}</span>
<span class="linenos" data-linenos="7 "></span><span class="k">class</span> <span class="nc">Empleat</span> <span class="k">extends</span> <span class="nx">Usuari</span> <span class="p">{</span>
<span class="linenos" data-linenos="8 "></span><span class="o">...</span>
<span class="linenos" data-linenos="9 "></span><span class="p">}</span>
</code></pre></div>
<p>Però si no fóra així, hauries de decidir si crees o no <code>Usuari</code>, i si ho
faries com una classe abstracta o com una interfície.</p>
<p>Si per exemple, volgueres definir en un únic lloc els atributs comuns a
Client i a Empleat, hauries de crear una classe abstracta Usuari de la
qual hereten.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">abstract</span> <span class="k">class</span> <span class="nc">Usuari</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">public</span> <span class="nv">$dni</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span>    <span class="k">protected</span> <span class="nv">$nom</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span>        <span class="o">...</span>
<span class="linenos" data-linenos="6 "></span><span class="p">}</span>
</code></pre></div>
<p>Però açò no podries fer-ho si ja tens planificada alguna relació
d'herència per a una d'aquestes dues classes.</p>
<p>Per a finalitzar amb les interfícies, a la llista de funcions de PHP
relacionades amb la POO pots afegir les següents.</p>
<table>
<thead>
<tr>
<th>Funció</th>
<th>Exemple</th>
<th>Significat</th>
</tr>
</thead>
<tbody>
<tr>
<td>get_declared_interfícies</td>
<td>print_r (get_declared_interfícies());</td>
<td>Retorna un array amb els noms dels interfícies declarats.</td>
</tr>
<tr>
<td>interface_exists</td>
<td>if (interface_exists('iShow') { … }</td>
<td>Retorna true si existeix l'interface que s'indica, o false en cas contrari.</td>
</tr>
</tbody>
</table>
<p>{:.alert .alert-activity}</p>
<div markdown="1">




## Trets (Traits)



Des de la seva versió 5.4.0, PHP implementa una metodologia de
reutilització de codi anomenada `Traits`.


Els trets («traits» en anglès) són un mecanisme de reutilització de
codi en llenguatges d'herència simple, com PHP. L'objectiu d'un tret és
el de reduir les limitacions pròpies de l'herència simple permetent que
els desenvolupadors reutilitzen a voluntat conjunts de mètodes sobre
diverses classes independents i pertanyents a classes jeràrquiques
diferents. 

Un Trait és similar a una classe, però amb l'únic objectiu d'agrupar
funcionalitats molt específiques i d'una manera coherent. No es pot
instanciar directament un `Trait`. És per tant un afegit a l'herència
tradicional, i habilita la composició horitzontal de comportaments; és a
dir, permet combinar membres de classes sense haver d'usar herència.

<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">trait</span> <span class="nx">Saludar</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>    <span class="k">function</span> <span class="nf">decirHola</span><span class="p">(){</span>
<span class="linenos" data-linenos=" 3 "></span>        <span class="k">return</span> <span class="s2">"hola"</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 5 "></span><span class="p">}</span>
<span class="linenos" data-linenos=" 6 "></span><span class="k">trait</span> <span class="nx">Despedir</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">function</span> <span class="nf">decirAdios</span><span class="p">(){</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="k">return</span> <span class="s2">"adiós"</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="10 "></span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span><span class="k">class</span> <span class="nc">Comunicacion</span> <span class="p">{</span>
<span class="linenos" data-linenos="12 "></span>    <span class="k">use</span> <span class="nx">Saludar</span><span class="p">,</span> <span class="nx">Despedir</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span><span class="nv">$comunicacion</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Comunicacion</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="k">echo</span> <span class="nv">$comunicacion</span><span class="o">-&gt;</span><span class="na">decirHola</span><span class="p">()</span> <span class="o">.</span> <span class="s2">", que tal. "</span> <span class="o">.</span> <span class="nv">$comunicacion</span><span class="o">-&gt;</span><span class="na">decirAdios</span><span class="p">();</span>
</code></pre></div>

En l'exemple anterior la classe `Comunicacion` necessita reutilitzar els mètodes `Saludar::decirHola()` i 
`Despedir::decirAdios()` com que en PHP no hi ha herència múltiple mitjançant els `trait` es pot aconseguir 
reutilitzar-les.

## Gestió d'errors i excepcions


### Introducció
De ben segur que a mesura que has anat resolent exercicis o simplement
provant codi, t'has trobat amb errors de programació. Alguns són
reconeguts per l'entorn de desenvolupament i pots corregir-los abans
d'executar. Altres apareixen al navegador en forma de missatge d'error a
l'executar l'*script*.

A diferència d'altres llenguatges de programació que tenen una gestió d'excepcions
més completa PHP manté una gestió d'excepcions lleugera ja que distingeix entre errors i excepcions. 
Així mentre no es produisca una excepció o un error fatal l'execució del programa continua.

No obstant, en PHP 7 canvia la majoria dels errors notificats per PHP. En lloc de notificar errors a través 
de l'mecanisme de notificació d'errors tradicional de PHP 5, la majoria dels errors ara són
 notificats llançant excepcions `Error`.

A l'igual que les excepcions normals, les excepcions `Error` es propagaran fins a arribar al
primer bloc `catch` coincident. Si no hi ha blocs coincidents, serà invocat qualsevol 
gestor d'excepcions predeterminat instal·lat amb `set_exception_handler ()`, i si no hi hagués 
cap gestor d'excepcions predeterminat, l'excepció serà convertida en un error fatal i serà manejada 
com un error tradicional.

A causa de que la jerarquia d'`Error` no hereta de `Exception`, el codi que empre blocs catch 
(Exception $ e) {...} per gestionar excepcions no capturades en PHP 5 trobareu que 
aquests `Errors` no són capturats per aquests blocs. Es requereix, per tant, un bloc 
`catch (Error $i)` {...} o un gestor `set_exception_handler()`.

## Errors
PHP defineix una classificació dels errors que es poden produir en
l'execució d'un programa i ofereix mètodes per ajustar el tractament
dels mateixos. Per fer referència a cada un dels nivells d'error, PHP
defineix una sèrie de constants. Cada nivell s'identifica per una
constant. Per exemple, la constant `E_NOTICE` fa referència a avisos que
poden indicar un error en executar el programa, i la constant `E_ERROR`
engloba errors fatals que provoquen que s'interrompa forçosament l'execució.

La llista completa de constants la pots consultar al manual de PHP, on
també es descriu el tipus d'errors que representa :
[http://es.php.net/manual/es/errorfunc.constants.php](http://es.php.net/manual/es/errorfunc.constants.php)

### Canviar el comportament de PHP 
La configuració inicial de com va a tractar-se cada error segons el seu
nivell es realitza en `php.ini` el fitxer de configuració de PHP. Entre
els principals paràmetres que pots ajustar estan:

  - `error_reporting`. Indica quins tipus d'errors es notificaran. El
    seu valor es forma utilitzant els operadors a nivell de bit per
    combinar les constants anteriors. El seu valor per defecte és `E_ALL
    &amp; ~ E_NOTICE` que indica que es notifiquin tots els errors (`E_ALL`)
    excepte els avisos a temps d'execució (`E_NOTICE`).
  - `display_errors`. En el seu valor per defecte (`On`), fa que els
    missatges s'envien a la sortida estàndard (i per tant es mostrin al
    navegador). S'ha de desactivar (`Off`) en els servidors que s'usen per 
    a producció.

Hi ha altres paràmetres que podem utilitzar en `php.ini` per ajustar el
comportament de PHP quan es produeix un error.
<http: errorfunc.configuration.php="" es="" es.php.net="" manual="">

Des codi, pots fer servir la funció `error_reporting` amb les constants
anteriors per establir el nivell de notificació en un moment determinat.
Per exemple, si en algun lloc del teu codi figura una divisió en la qual
hi haja la possibilitat que el divisor siga zero, quan això passe
obtindràs un missatge d'error al navegador. Per evitar-ho, pots
desactivar la notificació de errors de nivell `E_WARNING` abans de la
divisió i restaurar al seu valor normal a continuació:

<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span> <span class="o">&amp;</span> <span class="o">~</span> <span class="nx">E_NOTICE</span> <span class="o">&amp;</span> <span class="o">~</span> <span class="k">E_WARNING</span><span class="p">);</span>
<span class="linenos" data-linenos="2 "></span><span class="nv">$resultat</span> <span class="o">=</span> <span class="nv">$dividend</span><span class="o">/</span><span class="nv">$divisor</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="nb">error_reporting</span> <span class="p">(</span><span class="k">E_ALL</span> <span class="o">&amp;</span> <span class="o">~</span> <span class="nx">E_NOTICE</span><span class="p">);</span>
</code></pre></div>

### Notificació d'error en entorns de producció
{:.no_toc .nocount }

<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">; PHP comes packaged with two INI files. One that is recommended to be used</span>
<span class="linenos" data-linenos="2 "></span><span class="c1">; in production environments and one that is recommended to be used in</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">; development environments.</span>
<span class="linenos" data-linenos="4 "></span>
<span class="linenos" data-linenos="5 "></span><span class="c1">; php.ini-production contains settings which hold security, performance and</span>
<span class="linenos" data-linenos="6 "></span><span class="c1">; best practices at its core. But please be aware, these settings may break</span>
<span class="linenos" data-linenos="7 "></span><span class="c1">; compatibility with older or less security conscience applications. We</span>
<span class="linenos" data-linenos="8 "></span><span class="c1">; recommending using the production ini in production and testing environments.</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="c1">; display_errors</span>
<span class="linenos" data-linenos=" 2 "></span><span class="c1">;   Default Value: On</span>
<span class="linenos" data-linenos=" 3 "></span><span class="c1">;   Development Value: On</span>
<span class="linenos" data-linenos=" 4 "></span><span class="c1">;   Production Value: Off</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="c1">; display_startup_errors</span>
<span class="linenos" data-linenos=" 7 "></span><span class="c1">;   Default Value: Off</span>
<span class="linenos" data-linenos=" 8 "></span><span class="c1">;   Development Value: On</span>
<span class="linenos" data-linenos=" 9 "></span><span class="c1">;   Production Value: Off</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="c1">; error_reporting</span>
<span class="linenos" data-linenos="12 "></span><span class="c1">;   Default Value: E_ALL &amp; ~E_NOTICE &amp; ~E_STRICT &amp; ~E_DEPRECATED</span>
<span class="linenos" data-linenos="13 "></span><span class="c1">;   Development Value: E_ALL</span>
<span class="linenos" data-linenos="14 "></span><span class="c1">;   Production Value: E_ALL &amp; ~E_DEPRECATED &amp; ~E_STRICT</span>
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span><span class="c1">; html_errors</span>
<span class="linenos" data-linenos="17 "></span><span class="c1">;   Default Value: On</span>
<span class="linenos" data-linenos="18 "></span><span class="c1">;   Development Value: On</span>
<span class="linenos" data-linenos="19 "></span><span class="c1">;   Production value: On</span>
<span class="linenos" data-linenos="20 "></span>
<span class="linenos" data-linenos="21 "></span><span class="c1">; log_errors</span>
<span class="linenos" data-linenos="22 "></span><span class="c1">;   Default Value: Off</span>
<span class="linenos" data-linenos="23 "></span><span class="c1">;   Development Value: On</span>
<span class="linenos" data-linenos="24 "></span><span class="c1">;   Production Value: On</span>
</code></pre></div>
</http:></div>
<h3 id="gestio-global-dels-errors">Gestió global dels errors</h3>
<p>En utilitzar la funció <code>error_reporting</code> només controles quin tipus
d'errors va a notificar PHP. A vegades pot ser suficient, però per
obtenir més control sobre el procés existeix també la possibilitat de
gestionar de forma personalitzada els errors. És a dir, pots programar
una funció perquè siga la que executa PHP cada vegada que es produeix un
error. El nom d'aquesta funció s'indica utilitzant <code>set_error_handler</code> i
ha de tenir com a mínim dos paràmetres obligatoris (el nivell de l'error
i el missatge descriptiu) i fins tres opcionals amb informació addicional 
sobre el error (el nom del fitxer en què es produeix, el
nombre de línia, i un bolcat de l'estat de les<br/>
variables en aquest moment).</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="nb">set_error_handler</span> <span class="p">(</span><span class="s2">"miGestorDeErrores"</span><span class="p">);</span>
<span class="linenos" data-linenos=" 2 "></span><span class="nv">$resultat</span> <span class="o">=</span> <span class="nv">$dividend</span> <span class="o">/</span> <span class="nv">$divisor</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="nb">restore_error_handler</span> <span class="p">();</span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">function</span> <span class="nf">miGestorDeErrores</span> <span class="p">(</span><span class="nv">$nivell</span><span class="p">,</span> <span class="nv">$missatge</span><span class="p">)</span>
<span class="linenos" data-linenos=" 5 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">switch</span> <span class="p">(</span><span class="nv">$nivell</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>        <span class="k">case</span> <span class="k">E_WARNING</span><span class="o">:</span>
<span class="linenos" data-linenos=" 8 "></span>          <span class="k">echo</span> <span class="s2">"Error de tipus WARNING: </span><span class="si">$missatge</span><span class="s2">. &lt;br /&gt;"</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span>          <span class="k">break</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span>        <span class="k">default</span><span class="o">:</span>
<span class="linenos" data-linenos="11 "></span>          <span class="k">echo</span> <span class="s2">"Error de tipus no especificat: $ missatge. &lt;br /&gt;"</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span><span class="p">}</span>
</code></pre></div>
<p>La funció <code>restore_error_handler</code> restaura el gestor d'errors original
de PHP (més concretament, el que s'estava fent servir abans de la crida
a <code>set_error_handler</code>).</p>
<h3 id="errorexception">ErrorException</h3>
<p>Gràcies a la combinació de la classe <code>ErrorException</code> i el mètode <code>set_error_handler</code> 
podem convertir fàcilment els errors en excepcions de tipus <code>ErrorException</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="o">&lt;?</span><span class="nx">php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">function</span> <span class="nf">exception_error_handler</span><span class="p">(</span><span class="nv">$severidad</span><span class="p">,</span> <span class="nv">$mensaje</span><span class="p">,</span> <span class="nv">$fichero</span><span class="p">,</span> <span class="nv">$línea</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nb">error_reporting</span><span class="p">()</span> <span class="o">&amp;</span> <span class="nv">$severidad</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>        <span class="c1">// Este código de error no está incluido en error_reporting</span>
<span class="linenos" data-linenos=" 5 "></span>        <span class="k">return</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">throw</span> <span class="k">new</span> <span class="nx">ErrorException</span><span class="p">(</span><span class="nv">$mensaje</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$severidad</span><span class="p">,</span> <span class="nv">$fichero</span><span class="p">,</span> <span class="nv">$línea</span><span class="p">);</span>
<span class="linenos" data-linenos=" 8 "></span><span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span><span class="nb">set_error_handler</span><span class="p">(</span><span class="s2">"exception_error_handler"</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="cm">/* Desencadenar la excepción */</span>
<span class="linenos" data-linenos="12 "></span><span class="nb">strpos</span><span class="p">();</span>
<span class="linenos" data-linenos="13 "></span><span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
<h2 id="excepcions">Excepcions</h2>
<p>A partir de la versió 5 es va introduir en PHP un model d'excepcions
similar a l'existent en altres llenguatges de programació:</p>
<ul>
<li>El codi susceptible de produir algun error s'introdueix en un bloc
    <code>try</code>.</li>
<li>Quan es produeix algun error, es llança una excepció utilitzant la
    instrucció <code>throw</code>.</li>
<li>Després del bloc <code>try</code> ha d'haver com a mínim un bloc <code>catch</code>
    encarregat de processar el error.</li>
<li>Si un cop acabat el bloc <code>try</code> no s'ha llançat cap excepció, es
    continua amb la execució en la línia següent al bloc o blocs
    <code>catch</code>.</li>
</ul>
<p>Per exemple, per llançar una excepció quan es produeix una divisió per
zero podries fer:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$divisor</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="linenos" data-linenos="3 "></span>      <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span> <span class="p">(</span> <span class="s2">"Divisió per zero."</span><span class="p">);</span>
<span class="linenos" data-linenos="4 "></span>   <span class="nv">$resultat</span> <span class="o">=</span> <span class="nv">$dividend</span><span class="o">/</span><span class="nv">$divisor</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span><span class="p">}</span>
<span class="linenos" data-linenos="6 "></span><span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="7 "></span>   <span class="k">echo</span> <span class="s2">"S'ha produït el següent error:"</span><span class="o">.</span> <span class="err">$</span> <span class="nx">e</span><span class="o">-&gt;</span> <span class="na">getMessage</span> <span class="p">();</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
<p>PHP ofereix una classe base <code>Exception</code> per utilitzar com a gestor
d'excepcions. Per llançar una excepció no cal indicar cap paràmetre,
encara que de forma opcional es pot passar un missatge d'error (com en
l'exemple anterior) i també un codi d'error.</p>
<p>Entre els mètodes que podeu utilitzar amb els objectes de la classe
<code>Exception</code> estan:</p>
<ul>
<li><code>getMessage</code>. Retorna el missatge, en cas que s'hagi posat algun.</li>
<li><code>getCode</code>. Retorna el codi d'error si existeix.</li>
</ul>
<p>Les funcions internes de PHP i moltes extensions com MySQLi usen el
sistema d'errors vist anteriorment. Només les extensions més modernes
orientades a objectes, com és el cas de PDO, utilitzen aquest model
d'excepcions. En aquest cas, el més comú és que l'extensió definisca els
seues propis controladors d'errors heretant de la classe <code>Exception</code>.</p>
<div class="admonition information">
<p class="admonition-title">Classe ErrorException</p>
<p>Com hem dit abans, utilitzant la classe <code>ErrorException</code> és possible traduir els errors a
excepcions.<a href="http://es.php.net/manual/es/class.errorexception.php">http://es.php.net/manual/es/class.errorexception.php</a></p>
</div>
<p>Concretament, la classe PDO permet definir la fórmula que farà servir
quan es produeixi un error, utilitzant l'atribut <code>PDO::ATTR_ERRMODE</code>.
Les possibilitats són:</p>
<ul>
<li><code>PDO::ERRMODE\_SILENT</code>. No es fa res quan ocorre un error. És el
    comportament per defecte.</li>
<li><code>PDO::ERRMODE\_WARNING</code>. Genera un error de tipus E_WARNING quan es
    produeix un error.</li>
<li><code>PDO::ERRMODE\_EXCEPTION</code>. Quan es produeix un error llança una
    excepció utilitzant el gestor propi PDOException.</li>
</ul>
<p>És a dir, que si vols utilitzar excepcions amb l'extensió PDO, has de
configurar la connexió fent:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nv">$dwes</span><span class="o">-&gt;</span> <span class="na">setAttribute</span> <span class="p">(</span><span class="nx">PDO</span><span class="o">::</span><span class="na">ATTR_ERRMODE</span><span class="p">,</span> <span class="nx">PDO</span><span class="o">::</span><span class="na">ERRMODE_EXCEPTION</span><span class="p">);</span>
</code></pre></div>
<p>Per exemple, el següent codi:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>    <span class="nv">$dwes</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PDO</span> <span class="p">(</span> <span class="s2">"mysql: host = localhost; dbname = dwes"</span><span class="p">,</span> <span class="s2">"dwes"</span><span class="p">,</span> <span class="s2">"abc123."</span><span class="p">);</span>
<span class="linenos" data-linenos=" 2 "></span>    <span class="nv">$dwes</span><span class="o">-&gt;</span> <span class="na">setAttribute</span> <span class="p">(</span><span class="nx">PDO</span> <span class="o">::</span> <span class="na">ATTR_ERRMODE</span><span class="p">,</span> <span class="nx">PDO</span> <span class="o">::</span> <span class="na">ERRMODE_EXCEPTION</span><span class="p">);</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>        <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">"SELECT * FROM stox"</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>        <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$dwes</span><span class="o">-&gt;</span><span class="na">query</span> <span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="o">...</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">catch</span> <span class="p">(</span><span class="nx">PDOException</span> <span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="k">echo</span> <span class="s2">"Error"</span><span class="o">.</span> <span class="nv">$p</span><span class="o">-&gt;</span> <span class="na">getMessage</span> <span class="p">()</span><span class="o">.</span> <span class="s2">"&lt;br /&gt;"</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span>    <span class="p">}</span>
</code></pre></div></p>
<p>Captura l'excepció que llança PDO a causa de que la taula no existeix.
El bloc <code>catch</code> mostra el següent missatge:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nx">Error</span> <span class="nx">SQLSTATE</span> <span class="p">[</span><span class="mi">42</span><span class="nx">S02</span><span class="p">]</span><span class="o">:</span> <span class="nx">Base</span> <span class="nx">table</span> <span class="k">or</span> <span class="nx">view</span> <span class="k">not</span> <span class="nx">found</span><span class="o">:</span> <span class="mi">1146</span> <span class="nx">Table</span> <span class="s1">'dwes.stox'</span> <span class="nx">does</span> <span class="k">not</span> <span class="nx">exist</span>
</code></pre></div>
<h3 id="el-bloc-finally">El bloc <code>finally</code></h3>
<p>En PHP 5.5 i posterior, es pot utilitzar un bloc <code>finally</code> després o en
lloc dels blocs <code>catch</code>. El codi de dins el bloc <code>finally</code> sempre
s'executarà després dels blocs <code>try</code> i <code>catch</code>, independentment que
s'haja llançat una excepció o no, i abans que l'execució normal
continue.</p>
<p>Com que el contingut del bloc <code>finally</code> sempre s'executa és ideal per a
alliberar recursos en cas d'error, com una connexió a base de dades o a
la connexió a un servei proporcionats per tercers.<code></code></p>
<h3 id="multiples-catch">Múltiples catch</h3>
<p>És possible afegir més d'un <code>cath</code> de la següent manera:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>   <span class="o">...</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">FooException</span> <span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="4 "></span>   <span class="o">...</span>
<span class="linenos" data-linenos="5 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">BarException</span> <span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="6 "></span>   <span class="o">...</span>
<span class="linenos" data-linenos="7 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="8 "></span>   <span class="o">...</span>   
<span class="linenos" data-linenos="9 "></span><span class="p">}</span>
</code></pre></div>
<p>A partir de PHP 7.1 també és possible fer-ho així:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>   <span class="o">...</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">FooException</span> <span class="o">|</span> <span class="nx">BarException</span> <span class="o">|</span> <span class="nx">Exception</span> <span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="4 "></span>   <span class="o">...</span>
<span class="linenos" data-linenos="5 "></span><span class="p">}</span>
</code></pre></div>
<h2 id="ampliant-les-excepcions">Ampliant les excepcions</h2>
<p>És possible crear excepcions personalitzades heretant de la classe
<code>Exception</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">class</span> <span class="nc">NegativeIdException</span> <span class="k">extends</span> <span class="nx">Exception</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>  <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$message</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">message</span> <span class="o">=</span> <span class="nv">$message</span> <span class="o">?:</span> <span class="s1">'ID Negatiu.'</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>    <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span><span class="nv">$message</span><span class="p">);</span>
<span class="linenos" data-linenos="5 "></span>  <span class="p">}</span>
<span class="linenos" data-linenos="6 "></span><span class="p">}</span>
</code></pre></div>
<p>Després l'utilitzarem així:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>  <span class="nv">$post</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Post</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"Hola món"</span><span class="p">,</span> <span class="s2">"Aquest és el primer post del blog"</span><span class="p">,</span> <span class="k">new</span> <span class="nx">DateTime</span><span class="p">(),</span> <span class="s2">"Vicent"</span><span class="p">);</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">NegativeIdException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="4 "></span>    <span class="k">echo</span> <span class="s2">"No es pot posar un ID negatiu</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="6 "></span>  <span class="k">echo</span> <span class="s2">"Excepció desconeguda"</span><span class="o">.</span>  <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="linenos" data-linenos="7 "></span><span class="p">}</span>
</code></pre></div>
<h2 id="interficie-throwable">Interfície Throwable</h2>
<p><em>Throwable</em> és la interfície base per a qualsevol objecte que puga ser llançat 
mitjançant una sentència <code>throw</code> en PHP 7, incloent <code>Error</code> i <code>Exception</code>.</p>
<p>Les classes de PHP no poden implementar la interfície <code>Throwable</code> directament, 
de manera que han d'estendre en el seu lloc <code>Exception</code>.</p>
<p>Aquesta nova interfície té per objectiu unificar les dos tipologies d'exceptions. Tant <code>Exception</code> com 
<code>Error</code> implementen la interfície <code>Throwable</code>. </p>
<h3 id="gestio-derrors-i-excepcions">Gestió d'errors i excepcions</h3>
<ol>
<li>Modifica les classes Input creades anteriorment perquè en cas que
    el atribut <code>$name</code> no tinga valor llance una excepció amb el missatge
    "L'atribut name no pot estar buit".</li>
<li>Captura l'excepció.</li>
<li>Crea una excepció personalitzada <code>ValuesNotFoundException</code> en cas
    que el paràmetre <code>$values</code> del control <code>InputRadio</code> estiga buit.</li>
<li>Captura l'excepció.</li>
<li>Crea una excepció personalitzada <code>MovieNotFound</code> que es llance
    en cas que l'identificador <code>$id</code> sol·licitat no trobe cap pel·licula en <code>single-page.php</code> </li>
<li>Captura l'excepció.</li>
</ol>
<h2 id="exercicis-practics">Exercicis pràctics</h2>
<h3 id="activitat-pellicules">Activitat: Pel·lícules</h3>
<h4 id="objectius">Objectius</h4>
<p>Els objectius de l'activitat són els següents:
* Aprendre a crear classes
* Instanciar objectes
* Accedir a les seues propietats.</p>
<h4 id="enunciat">Enunciat</h4>
<ol>
<li>Crea la classe Movie en la carpeta src del projecte (<strong>cal usar tipat esctricte</strong>).</li>
<li>Els atributs seran:<ul>
<li>id (enter)</li>
<li>title (string)</li>
<li>tagline (string)</li>
<li>releaseDate (DateTime)</li>
<li>starsRating (float)</li>
<li>poster (string)</li>
</ul>
</li>
<li>Crea els <em>setters</em> i els <em>getters</em>.</li>
<li>La constant de classe <code>POSTER_PATH</code> contindrà la ruta al directori dels posters.</li>
<li>Modifica el projecte de forma que <code>$movies</code> siga un array d’objectes <code>Movie</code>.</li>
<li>Modifica'l també perquè les pàgines index.php i movies.php funcionen correctament</li>
</ol>
<h3 id="activitat-pellicules-ii">Activitat: Pel·licules II</h3>
<h4 id="objectius_1">Objectius</h4>
<p>Els objectius de l'activitat són els següents:
* Repassar el concepte de paràmetres per referència.
* Clonar objectes.</p>
<h4 id="enunciat_1">Enunciat</h4>
<ol>
<li>Crea una pel·lícula copiant-la (=) de la darrera pel·lícula de l'array.  </li>
<li>Comprova en movies.php que s'ha insertat i que tenen les mateixes dades.</li>
<li>Ara canvia el títol de la còpia afegint-li "(Còpia)" al títol que tenía. Per exemple si el títol era "Ava" ara serà 
"Ava (còpia)".</li>
<li>Comprova en <code>movies.php</code> que s'ha insertat i que és diferent a l'original. Tenen les mateixes dades? Per què?</li>
<li>Repassa els apunts i soluciona-ho. </li>
</ol>
<h3 id="activitat-pellicules-iii">Activitat: Pel·lícules III</h3>
<h4 id="objectius_2">Objectius</h4>
<p>Els objectius de l'activitat són els següents:
* Seguir construint el projecte.
* Treballar amb objectes.</p>
<h4 id="enunciat_2">Enunciat</h4>
<ol>
<li>El títol de la pel·licula  serà un enllaç a <code>single-page.php?id=[atribut id de la pel·lícula]</code>.</li>
<li>La pàgina <code>single-page.php</code> mostrarà les dades de la pel·licula que tinga l'<code>id</code> que s'ha passat pel 
querystring.</li>
<li>Post usar <code>array_filter</code> per trobar l'objecte que té l'id indicat.</li>
</ol>
<h3 id="activitat-42-herencia">Activitat 4.2: Herència</h3>
<h4 id="objectius_3">Objectius</h4>
<p>Els objectius de l'activitat són els següents:
* Treballar l'herència.
* Treballar amb classes abstractes</p>
<h4 id="enunciat_3">Enunciat</h4>
<p>Anem a crear una sèrie de classes per mostrar camps de formulari.</p>
<p>Pots incloure'ls al projecte en <code>src/utils</code> o crear-les a banda en la carpeta <code>activitat4</code> en 
l'arrel del projecte.</p>
<p>Crea la classe abstracta <code>Input</code> que tindrà les propietats:
* <strong>title</strong>, serà el text que apareix com a etiqueta de camp.
* <strong>name</strong>, serà el atribut name del camp.
* <strong>value</strong>, serà el valor a mostrar si hi ha.
* <strong>type</strong> , serà el tipus de camp, el valor per defecte serà 'text' i es modificarà
internament en les subclasses (<code>$this-&gt;type=??</code>).</p>
<p>El constructor serà 
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$title</span><span class="p">,</span> <span class="nx">string</span> <span class="nv">$name</span><span class="p">,</span> <span class="nx">string</span> <span class="nv">$value</span><span class="p">);</span>
</code></pre></div></p>
<p>Tindrà un mètode <code>generateHTML()</code> que no tindrà paràmetres i tornarà un string amb
l'HTML que representa el camp.</p>
<p>Per exemple:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>Nom<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="2 "></span><span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">"text"</span> <span class="na">value</span><span class="o">=</span><span class="s">""</span>  <span class="na">name</span><span class="o">=</span><span class="s">"nom"</span> <span class="p">/&gt;</span>
</code></pre></div></p>
<p>A continuació crea les classes <code>InputText</code>, <code>InputEmail</code> (<em>type=email</em>), <code>InputTel</code>(<em>type=tel</em>), 
 que hereten de la classe abstracta i usa-les per a crear un formulari en els camps
 * Nom
 * Cogonms
 * Correu electrònic
 * Telèfon fixe
 * Telèfon mòbil.
 * Enviar (pots implementar la classe <code>InputSubmit</code> o escriure'l directament en HTML.</p>
<p>La pàgina de resposta mostrarà els valors enviats pel formulari. </p>
<h3 id="activitat-43-herencia-i-2">Activitat 4.3: Herència (i 2)</h3>
<p>{:.no_toc .nocount}</p>
<h4 id="objectius_4">Objectius</h4>
<p>{:.no_toc .nocount}
Els objectius de l'activitat són els següents:
* Treballar l'herència.
* Treballar amb classes abstractes
* Treballar el polimorfisme</p>
<h4 id="enunciat_4">Enunciat</h4>
<p>{:.no_toc .nocount}</p>
<p>Anem a crear una sèrie de classes per mostrar camps de formulari.</p>
<p>Pots incloure'ls al projecte en <code>src/utils</code> o crear-les a banda en la carpeta <code>activitat4</code> en 
l'arrel del projecte.</p>
<p>Crea les classes <code>InputRange</code> i <code>InputRadio</code> que heretaran de la classe abstracta però que
tindran el constructor i els atributs diferents. Afig als camps ja existents els camps:</p>
<ul>
<li>Edat (de tipus range, 40 serà el valor per defecte)</li>
<li>Sexe (de tipus radio amb el sexe)</li>
</ul>
<p>Crea la classe <code>Form</code> que representarà un formulari HTML.  </p>
<p>El constructor serà 
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$action</span><span class="p">,</span> <span class="nx">string</span> <span class="nv">$method</span> <span class="o">=</span><span class="s1">'POST'</span><span class="p">);</span>
</code></pre></div></p>
<p>Tindrà una propietat pública <code>$elements</code> que serà un array d'objectes <code>Input</code>. Un mètode <code>Form::add(Input $input)</code>
que afegirà elements a l'array.</p>
<p>Tindrà també altres dos mètodes <code>Form::generateStartHTML()</code> que generarà l'etiqueta <code>&lt;form...&gt;</code> i 
<code>Form::generaEndHTML()</code> que generarà l'etiqueta de tancament <code>&lt;/form&gt;</code></p>
<p>Crea un objecte <code>Form</code> i afig mitjançant el mètode <code>add</code> els elements ja existents i mostra el formulari.</p>
<p>La pàgina de resposta mostrarà els valors enviats pel formulari.</p>
<h3 id="activitat-44-interficie-icontrol">Activitat 4.4: Interfície IControl</h3>
<h4 id="objectius_5">Objectius</h4>
<p>Els objectius de l'activitat són els següents:
* Crear interfícies.
* Treballar amb classes abstractes
* Treballar el polimorfisme</p>
<h4 id="enunciat_5">Enunciat</h4>
<p>{:.no_toc .nocount}</p>
<p>Crea una nova classe <code>Textarea</code> semblant a la classe <code>Input</code> que generarà 
un camp textarea de formulari. </p>
<p>Podrem afegir objectes <code>Textarea</code> mitjançant el mètode <code>Form::add()</code>?;</p>
<p>Crea la interfície <code>IControl</code>:</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">interface</span> <span class="nx">IControl</span> <span class="p">{</span>
<span class="linenos" data-linenos="2 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
Totes les classes creades implementaran eixa interfície.</p>
<p>Modifica <code>Form::add()</code> perquè admeta paràmetres de tipus <code>IControl</code>.</p>
<p>Implementa en la classe <code>Form</code> la interfície <code>Countable</code>. </p>
<p>Després mitjançant la funció <code>count()</code> mostra el número total d'elements del formulari.</p>
<h2 id="bibliografia">Bibliografia</h2>
<p>{: .no_toc }</p>
<ul>
<li>José Luis Comesaña.  <em>Apuntes de formación a distancia del módulo
    «Desarrollo web en entorno servidor» del CFGS DAW, elaborados y
    licenciados por el Ministerio de Educación, Cultura y Deporte.</em> [en
    línia]. 2012 [data de consulta: 13 de setembre de 2019].
    Disponible en
    \&lt;<a href="https://github.com/statickidz/TemarioDAW/tree/master/DWES">https://github.com/statickidz/TemarioDAW/tree/master/DWES</a>&gt;</li>
<li>Antonio López. <em>Learning PHP 7.</em> Packt Publishing (29 de marzo de
    2016) .</li>
</ul>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            2021-2022 Vicent Jordà - Licencia CC BY-NC-SA
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate"], "translations": {"clipboard.copy": "C\u00f2pia al porta-retalls", "clipboard.copied": "Copiat al porta-retalls", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Cerca", "search.result.placeholder": "Escriu per a comen\u00e7ar a cercar", "search.result.none": "Cap document coincideix", "search.result.one": "1 document coincident", "search.result.other": "# documents coincidents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.409db549.min.js", "version": null}</script>
<script src="../../assets/javascripts/bundle.756773cc.min.js"></script>
<script src="../../js/print-site.js"></script>
<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</body>
</html>