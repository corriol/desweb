
<!DOCTYPE html>

<html class="no-js" lang="ca">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.2.2, mkdocs-material-7.2.6" name="generator"/>
<title>Controlador frontal - DWES</title>
<link href="../../assets/stylesheets/main.802231af.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.3f5d1f46.min.css" rel="stylesheet"/>
<meta content="#ff6e42" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
<link href="../../stylesheets/extra.css" rel="stylesheet"/>
</head>
<body data-md-color-accent="" data-md-color-primary="deep-orange" data-md-color-scheme="" dir="ltr">
<script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#el-controlador-frontal">
          Salta el contingut
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="DWES" class="md-header__button md-logo" data-md-component="logo" href="../.." title="DWES">
<img alt="logo" src="../../assets/logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            DWES
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Controlador frontal
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Cerca" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Cerca" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="DWES" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="DWES">
<img alt="logo" src="../../assets/logo.png"/>
</a>
    DWES
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
        Inici
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../01-intro/">
        1.- Introducció a la programació Web
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-phpbasics/">
        2.- El llenguatge PHP
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4">
        3.- PHP Orientat a Objectes
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="3.- PHP Orientat a Objectes" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          3.- PHP Orientat a Objectes
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../03-phpoo/0301-phpoo-basic/">
        PHP OO Bàsic
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../03-phpoo/0302-phpoo-advanced/">
        PHP OO Avançat
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../03-phpoo/0303-errorhandling/">
        Erros i excepcions
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../03-phpoo/0399-activities/">
        Activitats
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5">
        4.- Accés a dades amb PHP
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="4.- Accés a dades amb PHP" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          4.- Accés a dades amb PHP
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../04-data-access/04-data-access-php/">
        Accés a dades amb PHP
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6">
        5.- Manteniment de l'estat
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="5.- Manteniment de l'estat" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          5.- Manteniment de l'estat
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../05-maintain-state/05-01-intro/">
        Introducció
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../05-maintain-state/05-02-cookies/">
        Galletes (cookies)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../05-maintain-state/05-03-sessions/">
        Sessions
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../05-maintain-state/05-04-best-practices/">
        Bones pràctiques
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../05-maintain-state/05-99-activities/">
        Activitats
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7">
        6.- Composer. Introducció al testing
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="6.- Composer. Introducció al testing" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
          6.- Composer. Introducció al testing
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../06-composer/06-01-intro/">
        Introducció
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../06-composer/06-02-composer/">
        Composer
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../06-composer/06-04-namespaces/">
        Namespaces
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../06-composer/06-05-tdd-intro/">
        Introducció al testing
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../06-composer/06-99-activities/">
        Activitats
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" id="__nav_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_8">
        7.- Miniframework MVC
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="7.- Miniframework MVC" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
          7.- Miniframework MVC
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../07-00-intro/">
        Introducció
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Controlador frontal
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Controlador frontal
      </a>
<nav aria-label="Taula de continguts" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Taula de continguts
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#que-posa-ahi-url-amigables">
    Què posa ahí? URL amigables
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#reescriptura-de-rutes">
    Reescriptura de rutes
  </a>
<nav aria-label="Reescriptura de rutes" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#objectius-de-les-regles-de-reescriptura">
    Objectius de les regles de reescriptura
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#directives">
    Directives
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#directiva-rewriteengine">
    Directiva RewriteEngine
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#directiva-rewritecond">
    Directiva RewriteCond
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#directiva-rewriterule">
    Directiva RewriteRule
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#el-nostre-cas">
    El nostre cas
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#proteccio-del-nostre-codi">
    Protecció del nostre codi
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../07-02-classe-router/">
        Rutes i controladors
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../07-03-classe-request-response/">
        Sol·licitud i resposta
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" id="__nav_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_9">
        8.- Symfony
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="8.- Symfony" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_9">
<span class="md-nav__icon md-icon"></span>
          8.- Symfony
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../08-symfony/01-introducci%C3%B3-va/">
        Introducció a Symfony
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../08-symfony/02-mvc/">
        El patró MVC en Symfony
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../08-symfony/03-twig/">
        El motor de plantilles Twig
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../08-symfony/04-injeccio-dependencies/">
        Injecció de dependències
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../08-symfony/05-doctrine/">
        Doctrine
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../08-symfony/11-relacions-molts-a-molts/">
        Doctrine. Relacions molts a molts
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../08-symfony/06-formularis-i-validaci%C3%B3/">
        Formularis i validació
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../08-symfony/99-activitats/">
        Activitats
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="el-controlador-frontal">El controlador frontal</h1>
<p>El controlador frontal és un patró de disseny que apareix en diversos catàlegs de patrons 
i està relacionat amb el disseny d’aplicacions web. És "un controlador que gestiona totes les 
sol·licituds d'un lloc web", que és una estructura útil per als desenvolupadors d'aplicacions web per 
a aconseguir la flexibilitat i la reutilització sense redundància de codi.</p>
<p>Normalment el controlador frontal s'implementa en la pàgina principal del lloc web: <code>index.php</code>.</p>
<p>Perquè el controlador frontal siga funcional és important que qualsevol petició al lloc web siga
redirigida al controlador frontal. En eixe sentit les URL amigables tenen un paper esencial.</p>
<h2 id="que-posa-ahi-url-amigables">Què posa ahí? URL amigables</h2>
<p>Les URL semàntiques o URL amigables són aquelles URL que, dins del que cap, poden ser enteses 
pels usuaris.</p>
<p>Lluny de les clàssiques URL de les pàgines dinàmiques plenes de variables en el <em>querystring</em> i nombres difícils de recordar, les URL semàntiques estan formades amb paraules relacionades amb el contingut de la pàgina i fàcils de recordar. </p>
<p>Aquestes s'utilitzen en els llocs web dinàmics (no estàtics). Per això s'estan utilitzant molt més que les URL extenses.</p>
<p>Suposem que vols comprar una càmera fotos. Has trobat dues botigues amb el model que busques.</p>
<p>La direcció de l'producte a la primera botiga és:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>http://www.example.com/B001G5ZTLS/ref=sr_1_5?s=foto&amp;ie=UTF8&amp;qid=1365525726&amp;sr=1-5
</code></pre></div>
<p>I la direcció de la segona:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>http://www.example.com/camaras/reflex/canon-eos-5d-mark-2/
</code></pre></div>
<p>Quan desenvolupem una aplicació web hem de tractar que les url tinguen càrrega semàntica.</p>
<p>Els seus principals avantatges són:</p>
<ul>
<li>Fàcils de recordar i de deduir.</li>
<li>Oculta de la tecnologia usada.</li>
<li>És conforme a l’estil REST el que li dona consistència.</li>
<li>Crear URL netes i llegibles que són més fàcils de recordar i més 
adequades per al Search Engine Optimization (SEO).</li>
</ul>
<p>En el nostre projecte quina url tindrà més càrrega semàtica?</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>http://movies.local/movies/title/ava
</code></pre></div>
<p>o </p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>http://movies.local/show-movie.php?id=1488
</code></pre></div>
<h2 id="reescriptura-de-rutes">Reescriptura de rutes</h2>
<p>Com hem dit abans, per a disposar d'un lloc web en url amigables necessitem que totes 
les peticions a la la nostra aplicació es redirigisquen al nostre controlador frontal 
(<code>index.php</code>)</p>
<p>En <code>index.php</code> obtindrem el <em>path</em> (ruta) i cridarem al controlador adient.</p>
<p>Per redirigir totes les cridades al controlador frontal haurem de configurar el mòdul de
reescriptura d'Apache (<strong>mod_rewrite</strong>).</p>
<h3 id="objectius-de-les-regles-de-reescriptura">Objectius de les regles de reescriptura</h3>
<p>Els objectius són diversos:</p>
<ul>
<li>Amagar la funcionalitat de PHP i, per tant, exposa menys les parts internes de el lloc.</li>
<li>Restringir l'accés.</li>
<li>Crear URL netes i llegibles que són més fàcils de recordar i més adequades per al Search Engine Optimization.</li>
</ul>
<p>La reescriptura d'URL és la tècnica utilitzada per "traduir" un URL amigable a una altra 
  que el servidor puga entendre.</p>
<h3 id="directives">Directives</h3>
<p>Perquè la reescriptura d'URL funcione tenim dues opcions:</p>
<ul>
<li>Introduir una sèrie de directives <code>&lt;Directory&gt;</code> en els fitxers de configuració d'Apache</li>
<li>Introduir aquestes directives en un fitxer <code>.htaccess</code> dins del directori en el que vulgues que es realitze la reescriptura.</li>
</ul>
<p>Nosaltres utilitzarem la segona opció.</p>
<p>D'aquesta manera, en producció n'hi haurà prou amb pujar el <code>.htaccess</code> al servidor i no 
necessitarem tocar la configuració.</p>
<div class="admonition alert">
<p class="admonition-title">Alert</p>
<p>Perquè funcione <code>.htaccess</code> cal tindre activida la directiva <code>AllowOverride</code> d'Apache.</p>
</div>
<p>Els passos a realitzar són:</p>
<ul>
<li>Comprovar si existeix el <code>mod_rewrite</code></li>
<li>Totes les directives de <code>mod_rewrite</code> les introduirem dins d’una directiva IfModule:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nt">&lt;IfModule</span> <span class="s">mod_rewrite.c</span><span class="nt">&gt;</span>
<span class="linenos" data-linenos="2 "></span>    <span class="nb">Directives</span> de reescriptura
<span class="linenos" data-linenos="3 "></span><span class="nt">&lt;/IfModule&gt;</span>
</code></pre></div>
<p><strong>Deshabilitar l’opció Multiviews</strong></p>
<p>És convenient desactivar aquesta opció per evitar problemes amb fitxers que tenen noms semblants, teniu 
més informació en <a href="thhttps://stackoverflow.com/questions/25423141/what-exactly-does-the-the-multiviews-options-in-htaccess">What exactly does the multiviews option in htacces</a></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nt">&lt;IfModule</span> <span class="s">mod_rewrite.c</span><span class="nt">&gt;</span>
<span class="linenos" data-linenos="2 "></span>    <span class="nb">options</span> -MultiViews
<span class="linenos" data-linenos="3 "></span>    <span class="nb">Directives</span> de reescriptura
<span class="linenos" data-linenos="4 "></span><span class="err">&lt;/</span> <span class="nb">IfModule</span>&gt;
</code></pre></div>
<h3 id="directiva-rewriteengine">Directiva RewriteEngine</h3>
<p>Per indicar a Apache que fem servir el <code>mod_rewrite</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>RewriteEngine on
</code></pre></div>
<p>Si vols desactivar-lo i que el servidor ignore la resta de la configuració:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>RewriteEngine off
</code></pre></div>
<h3 id="directiva-rewritecond">Directiva RewriteCond</h3>
<p>La directiva <code>RewriteCond</code>  ens permet especificar una condició. Si es compleix, s'executa la directiva <code>RewriteRule</code>
 posterior.</p>
<p>Es poden posar diverses condicions. Quan es compleixen totes les condicions (llevat que s'indique una altra cosa) 
s'executa la directiva <code>RewriteRule</code> posterior</p>
<p>La seua sintaxi és: </p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>RewriteCond variable_apache expresión_regular flags
</code></pre></div>
<p>Hi ha diverses variables per a condicions com es pot observar en la imatge:</p>
<p><img alt="Server variables" src="../assets/server-variables.png">.</img></p>
<p>Nosaltres usarem <code>REQUEST_FILENAME</code> que emmagatzema la URL sol·licitada per l'usuari.</p>
<p>Després de la variable indicarem una expressió regular per seleccionar les adreces que es corresponen amb un 
determinat patró. Existeixen també una sèrie de variables predefinides que es poden utilitzar en comptes 
d'introduir una expressió regular:</p>
<ul>
<li><code>-d</code>: es tracta la URL com si fos una ruta d'el sistema d'arxius i es comprova si existeix i si és un directori.</li>
<li><code>-f</code>: igual que l'anterior, però comprovant si és un fitxer.</li>
<li><code>-l</code>: Igual que els anteriors, però comprovant si és un enllaç simbòlic.
Etc.</li>
</ul>
<p>Si indiquem el símbol <code>!</code> Davant de l'expressió regular o la variable, l'estem negant, és a dir, 
que s'avaluarà la condició a cert quan no coincideixi amb l'expressió indicada.</p>
<p><strong>Flags (banderes)</strong> </p>
<p>Podem indicar una llista de flags per especificar un comportament determinat:</p>
<p>nocase | NC: El testeig és insensible a majúscules i minúscules(no <em>case-sensitive</em>).
ornext | OR: S'utilitza l'operació OR (en lloc de AND que és l'opció per defecte) per combinar el resta de
 condicions en les regles</p>
<p>Per exemple:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>RewriteCond %{HTTP_USER_AGENT} ^exemple [OR, NC]
<span class="linenos" data-linenos="2 "></span>RewriteCond %{HTTP_USER_AGENT} ^google [NC]
</code></pre></div>
<p>La variable %{HTTP_USER_AGENT} representa el nom del navegador que utilitza l'usuari.</p>
<p>L'expressió regular s'utilitza per determinar quin és el valor de la variable que estem analitzant. En aquest exemple
<code>^exemple</code> indica que el nom del navegador comença per <code>exemple</code>.</p>
<p>En els flags s'indica que les dues condicions s'agrupen com operacions OR, és a dir, el nom de el navegador 
ha de començar per <code>exemple</code> o per <code>google</code>.</p>
<p>El valor NC indica que no ha de distingir entre majúscules i minúscules.</p>
<h3 id="directiva-rewriterule">Directiva RewriteRule</h3>
<p>Aquesta directiva serà l'encarregada de realitzar la redirecció (reescriptura) corresponent.</p>
<p>Sintaxi:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>RewriteRule expresión_regular redirecció flags
</code></pre></div>
<p>Mitjançant el caràcter "-" indicarem que no volem cap pàgina de redirecció</p>
<h3 id="el-nostre-cas">El nostre cas</h3>
<p>En el nostre crearem aquest fitxer <code>.htacces</code> en la carpeta on tingam el fitxer 
que implemente el controlador frontal.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c"># .htaccess</span>
<span class="linenos" data-linenos="2 "></span><span class="nt">&lt;IfModule</span> <span class="s">mod_rewrite.c</span><span class="nt">&gt;</span>
<span class="linenos" data-linenos="3 "></span>    <span class="nb">Options</span> -MultiViews
<span class="linenos" data-linenos="4 "></span>    <span class="nb">RewriteEngine</span> <span class="k">On</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span>    <span class="nb">RewriteCond</span> %{REQUEST_FILENAME} !-f
<span class="linenos" data-linenos="7 "></span>    <span class="nb">RewriteRule</span> ^(.*)$ <span class="sx">/index.php</span> [QSA,L]
<span class="linenos" data-linenos="8 "></span>
<span class="linenos" data-linenos="9 "></span><span class="nt">&lt;/IfModule&gt;</span>
</code></pre></div>
<p><code>RewriteCond</code> indica qualsevol sol·licitud que no siga un fitxer.</p>
<p>I en <code>RewriteRule</code> l'expressió regular selecciona qualsevol URI. </p>
<p>Tenint en compte les següents que:</p>
<ul>
<li><code>^</code> indica que l'inici </li>
<li><code>$</code> indica el final.</li>
<li><code>()</code> representa una agrupació</li>
<li><code>.</code> representa qualsevol caràcter excepte espai.</li>
<li><code>*</code> representa que el caràcter anterir es pot repetir.</li>
</ul>
<p>L'expressió regular <code>^(.*)$</code> indica que es seleccionarà qualsevol cadena de text que entre l'inici i el final continga
qualsevol caràcter que no siga espai, és a dir, qualsevol URL. </p>
<p>Els flags indiquen:</p>
<ul>
<li><code>QSA</code>, les <em>query strings</em>, d'existir, es combinen en la reescritura.</li>
<li><code>L</code>, indica que aplicada la regla, s'ature l'execució. </li>
</ul>
<p>Més informació:</p>
<ul>
<li><a href="https://httpd.apache.org/docs/2.4/rewrite/">Apache mod_rewrite</a></li>
</ul>
<h2 id="proteccio-del-nostre-codi">Protecció del nostre codi</h2>
<p>Per a protegir el nostre codi d'accessos mitjançant el navegador moure'm
el <code>DocumentRoot</code> al directori <code>public</code>. Aquest directori sols contindrà
aquelles recursos que volem que siguen accessibles directament des del navegador:</p>
<ul>
<li><code>index.php</code> que implementarà el controlador frontal</li>
<li>fitxers d'estils, imatges, etc.</li>
</ul>
<p>Per a aconseguir-ho caldrà canviar la configuració del <code>DocumentRoot</code> nostre servidor virtual
 perquè apunte al directori <code>public</code>.</p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Anterior: Introducció" class="md-footer__link md-footer__link--prev" href="../07-00-intro/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Anterior
              </span>
              Introducció
            </div>
</div>
</a>
<a aria-label="Següent: Rutes i controladors" class="md-footer__link md-footer__link--next" href="../07-02-classe-router/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Següent
              </span>
              Rutes i controladors
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            2021-2022 Vicent Jordà - Licencia CC BY-NC-SA
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate"], "translations": {"clipboard.copy": "C\u00f2pia al porta-retalls", "clipboard.copied": "Copiat al porta-retalls", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Cerca", "search.result.placeholder": "Escriu per a comen\u00e7ar a cercar", "search.result.none": "Cap document coincideix", "search.result.one": "1 document coincident", "search.result.other": "# documents coincidents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.409db549.min.js", "version": null}</script>
<script src="../../assets/javascripts/bundle.756773cc.min.js"></script>
<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</body>
</html>